[["index.html", "Phân tích d liu cho nghiên cu h tr sinh sn bng ngôn ng R Chng 1 Li gii thiu 1.1 Gii thiu v nghiên cu h tr sinh sn 1.2 Gii thiu v giáo trình", " Phân tích d liu cho nghiên cu h tr sinh sn bng ngôn ng R Lê Ngc Kh Nhi và cng s 2023-04-20 Chng 1 Li gii thiu Biên son: Thân Trng Thch, Lê Ngc Kh Nhi 1.1 Gii thiu v nghiên cu h tr sinh sn 1.1.1 t vn  Vô sinh là mt vn  sc khe quan trng vi c tính t l gp phi trên khong 17,5% dân s trên toàn th gii (WHO 2023). Vn  này không ch ph bin ti các quc gia phát trin cao do dân s già hóa và  nhng vùng ô th - ni tui ngi ph n sinh con u ngày càng cao, mà còn c ghi nhn phn ln  các nc ang phát trin, trong ó có Vit Nam (WHO 2013). Cùng vi s gia tng t l vô sinh, s phát trin nhanh ca Y hc sinh sn và nghiên cu khoa hc v h tr sinh sn (HTSS) ã óng góp rt ln cho s phát trin ca các k thut trong iu tr và chm sóc các cp ôi vô sinh trên toàn th gii. Em bé IVF u tiên trên th gii ra i nm 1978, n nay c tính ã có hn 8 triu tr ra i t th tinh ng nghim (IVF) (Steptoe and Edwards 1978). IVF ã làm thay i quan im ca nhân loi v sinh sn. i cùng vi s công nhn trên toàn th gii và s ph bin v dch v HTSS là nhu cu cn có nhng nghiên cu cht lng  phát trin nhng k thut trong HTSS ti các nc ang phát trin. Mc dù s lng tp chí và bài báo v lnh vc y hc sinh sn tng mnh trong nhng nm gn ây, ti mt s nc và khu vc, vic nghiên cu khoa hc (NCKH) vn cha tht tng xng vi nhng thành tu t c trong HTSS. Vi tim nng th trng và ngun nhân lc, Vit Nam có c hi rt ln  phát trin IVF thành ngành mi nhn v công ngh Y-sinh hc. Lnh vc HTSS ti nc ta có nhiu thun li  thc hin nghiên cu khoa hc nh ngun d liu ln, s lng bnh nhân iu tr ông, tuy nhiên s lng công trình khoa hc hin ti ca nc ta cha nhiu. Vic thc hin nghiên cu khoa hc v HTSS ti Vit Nam ang gp phi nhng khó khn gì? Trong phn này, tác gi s trình bày tng quan v lch s nghiên cu khoa hc trong HTSS và tm quan trng ca khoa hc thc nghim trong quá trình phát trin ca HTSS. 1.1.2 Lch s nghiên cu v IVF Nhng ngày u ca IVF T nhng nm 1930, vic nghiên cu hin tng th tinh gia noãn và ng vt bc cao trong môi trng bên ngoài c th nhn c s chú ý (Pincus and E 1935). Nhng ý tng v trng thành trng ca Edward bt u t nhng nm 1950 vi mc tiêu tìm hiu ngun gc ca vic trng thành trng  có th tránh c các bt thng nhim sc th bao gm hi chng Turner, Klinefelter hay Down. Nm 1959, Chang ln u tiên thc hin thành công th tinh gia tinh trùng và noãn ng vt có vú (th) trong môi trng phòng thí nghim (Chang 1959). ây c xem là thành tu quan trng nht trong lch s phát trin IVF vì nó chng mình noãn và tinh trùng ca ng vt có th th tinh c bên ngoài c th. T sau thí nghim này, IVF c nghiên cu trên nhiu loài ng vt khác nhau, k c  ngi. Nm 1962, Edward nhn thy rng có th kích thích s trng thành ca trng bng cách s dng hormone cho chut cái trng thành, iu này to tin  cho vic kích thích rng trng  ngi sau này (RG 1965). Nm 1966, Edward cùng mt nhóm các nhà khoa hc M công b trng hp u tiên ly c noãn ngi nh phu thut ni soi (Steptoe and Edwards 1970). Sau ó, Edward dành 6 nm  thc hin trng thành trong ng nghim trng ca nhiu loài khác nhau, bao gm c  ngi.  bc này, ông mt khá nhiu thi gian vì  thi im by gi, không ai bit sau bao lâu sau nh LH thì trng rng và tip tc chu kì gim phân. Trên thc t, khong thi gian này  ngi (36 gi) dài hn nhiu so vi khong thi gian 12 gi c nghiên cu trên chut trc ó. Sau ó, trong vòng 2-3 nm, Edward tp trung thc hin xét nghim di truyn tin làm t (PGT) trên phôi chut, to tin  cho k thut PGT trên phôi ngi 20 nm sau ó. Nm 1971, Steptoe và Edwards  ln u tiên báo cáo nuôi cy c phôi nang ngi (blastocyst) trong ng nghim và chuyn phôi vào bung t cung (Edwards, PC, and Purdy 1970). Tuy nhiên thi gian này, các phác   chun b ni mc cha c nghiên cu mt cách k lng và các nhà khoa hc ã mc nhiu sai lm trong vic s dng ni tit t  chun b ni mc t cung. n nm 1976, sau nhiu trng hp tht bi, Steptoe và Edwards công b trng hp thai IVF u tiên trên th gii ti bnh vin Oldham, Anh, nhng áng tic ây là mt trng hp thai ngoài t cung (Edwards 2001). Nm 1978, Louise Brown, em bé IVF u tiên ra i, to nên thành công u tiên cho s phát trin IVF trên ngi(Steptoe and Edwards 1978). Em bé Louise Brown c sinh ra t ngi m c chn oán vô sinh do tn thng hai vòi trng ã c iu tr bng phu thut nhng không thành công. Trong thc t, bác s Steptoe và tin s Edwards ã tht bi hàng trm ln  có c thành công vang di này. Tuy nhiên, trong giai on này, các nhà khoa hc tiên phong nh bác s Steptoe và tin s Edwards ã hng phi ch trích và phn ng kch lit không ch t d lun, tôn giáo mà còn t nhiu nhà khoa hc ng thi. Trong thi gian dài nhiu nm, các nhà khoa hc làm trong lnh vc IVF ã âm thm lng l làm vic và nghiên cu. Sau 32 nm k t khi IVF  ngi thành công và em bé t IVF u tiên chào i, nm 2010 s óng góp ca tin s R.G. Edwards ã c các nhà khoa hc trên th gii công nhn là mt ct mc ln trong s phát trin ca nn y hc hin i và ông c trao gii thng Nobel Y hc cho thành tu này(Fauser and Edwards 2005). Trong nhng nm 80, k thut IVF ã c phát trin rt mnh và ln lt c báo cáo thành công ti nhiu nc  nhiu khu vc trên th gii. Nm 1981, em bé IVF u tiên  M ra i, ây cng là trng hp IVF u tiên s dng gonadotropin  kích thích bung trng. Các nc châu Âu cng ng lot trin khai IVF trong nhng nm u thp niên 80 (Johnson 2019). Ti châu Á, Singapore là ni u tiên thc hin thành công IVF vào nm 1983. Sau ó, IVF cng c thc hin thành công ti Nht Bn, Trung Quc, Thái Lan, Malaysia, Indonesia và Philippines trong sut nhng nm ca thp niên 80. Ti Vit Nam, IVF ã mt hn 10 nm  chun b do hn ch v c s vt cht, k thut, nhân lc chuyên môn. Ngày 19/8/1997, b trng B Y T ã ký quyt nh cho phép bnh vin T D là n v u tiên ti Vit Nam c thc hin nhng ca IVF u tiên, ng u nhóm nghiên cu là bác s Nguyn Th Ngc Phng. Nhn c s h tr và hp tác ca các chuyên gia ngi Pháp, vào tháng 8/1997 các trng hp IVF u tiên ti Vit Nam ã c thc hin. Ngày 30/4/1998, ánh du mc quan trng cho IVF Vit Nam, khi 3 em bé IVF u tiên ca Vit Nam c chào i. T nm 1997-2007, trong vòng 10 nm, IVF  Vit Nam phát trin rt nhanh, thc hin c nhiu k thut chuyên sâu v IVF. n nm 2007, Vit Nam ã thc hin c hu ht các k thut liên quan n IVF. T nm 2007 tr i, IVF Vit Nam có nhng chuyn bin mnh m v cht lng, nâng lên mt tm cao mi. T l thành công c ci thin mt cách áng k và xng ngang tm vi các trung tâm trên th gii. Quá trình phát trin và hoàn thin v k thut n nay, IVF ã có nhng s phát trin vt bc. T k thut chc hút trng c thc hin di gây tê ti ch, di s hng dn ca siêu âm qua ngã âm o, n phng pháp nuôi cy phôi, nuôi cy thành công phôi nang, cng nh tiêu chun la chn trng và k thut thy tinh hóa giúp tr ông phôi, gim s lng phôi mi ln chuyn và tránh c nhng vn  liên quan khi mang a thai.  nhng chu k IVF u tiên c thc hin, ngi ta ch thc hin chc hút ly noãn qua ni soi trên nhng bung trng phát trin t nhiên, nên thng ch ly c mt noãn t mt ph n và do ó, t l thành công thng rt thp. Khi vic s dng ni tit t  kích thích bung trng ngày càng ph bin, ngi ta có th ly c trung bình khong 10 noãn  thc hin IVF. iu này giúp tng s lng phôi có c và có th la chn c phôi có cht lng tt  chuyn vào bung t cung, làm gia tng áng k t l thành công ca IVF. T nm 1983, siêu âm u dò âm o c a vào ng dng trong ph khoa. K thut chc hút noãn qua ngã âm o di hng dn ca siêu âm u dò âm o c áp dng ln u tiên và sau ó thay th hoàn toàn vic chc hút noãn qua ni soi tn kém, xâm ln và kém hiu qu. Thành tu này làm thay i áng k b mt ca k thut IVF, bin IVF thành mt k thut n gin, ít xâm ln, có th thc hin  các c s y t nh (Gleicher 1983). Cng vào nm 1983, nhóm nghiên cu ca Alan Trouson ti Úc công b trng hp em bé u tiên sinh ra t phôi tr ông (Trounson and Mohr 1983). Sau ó, vào nm 1986, Chen cùng cng s báo cáo trng hp có thai t noãn ngi ông lnh và rã ông ti Úc (C. Chen 1986). Tuy nhiên, trong mt thi gian dài sau ó, các phác  tr lnh noãn cho hiu qu kém và t l thành công c báo cáo rt thp. Trong thi gian gn ây, nh s phát trin ca k thut thy tinh hóa, ông lnh noãn bt u c ánh giá là mt k thut hiu qu. Hin nay, kt qu ông lnh noãn ã t kt qu t l sng tng ng vi ông lnh phôi và cht lng noãn sau rã ông tng ng vi noãn ti. Nm 1984, k thut chuyn giao t vào vòi trng (GIFT  Gamete intrafallopian tube transfer) do bác s Asch khi xng c báo cáo thành công ti M. Khi thc hin GIFT, noãn và tinh trùng c ly ra ngoài c th, x lí và sau ó tinh trùng và noãn ch c tip xúc vi nhau khi c bm vào vòi trng bng ni soi  bng. ây là mt k thut xâm ln và òi hi ngi bnh phi có ít nht mt vòi trng bình thng. K thut này phát trin mnh m trong nhng nm sau ó ti M vì các thi im by gi các phác  nuôi cy phôi trong iu kin nhân to cha hoàn thin và mt s quan im tôn giáo không chp nhn IVF (Asch et al. 1986). Mt k thut khác tng t là chuyn hp t vào vòi trng (ZIFT - Zygote intrafallopian tube transfer) cng c phát trin sau ó. Trong k thut này hp t c hình thành  môi trng bên ngoài c th, sau ó c bm vào vòi trng qua ni soi  bng. n cui thp k 90, GIFT và ZIFT ngày càng b thu hp ch nh do s phát trin ca k thut nuôi cy phôi trong phòng thí nghim c ci thin áng k, ng thi IVF ngày càng tr nên ph bin và chp nhn rng rãi. Em bé u tiên ra i t mt ngi ph n không còn bung trng và thc hin xin noãn vào nm 1984 (Trounson et al. 1983). ây là ln u tiên trong lch s mt ngi ph n có th có con vi noãn ca mt ngi ph n khác. Trong mt bc t phá ca IVF, nm 1997, mt trng hp ngi ph n 63 tui có thai vi k thut xin noãn  IVF c báo cáo. iu này chng t rng chc nng mang thai ca t cung nu c b sung  ni tit thì có th duy trì khá lâu sau mãn kinh. Tuy nhiên, a s các nc u gii hn  tui xin noãn thng dao ng t 45  55 tui. Trong thi gian u, IVF c ch nh ch yu cho vô sinh n. Sau ó, IVF c áp dng cho các trng hp vô sinh nam, trong ó k thut vi thao tác (micromanipulation) c nghiên cu  h tr cho vic th tinh gia noãn và tinh trùng trong trng hp thiu nng tinh trùng. Trong k thut vi thao tác, kim cc nh bng thy tinh c dùng  thao tác trên noãn và tinh trùng di kính hin vi o ngc. Nm 1988, trng hp tiêm trùng vào di màng trong sut (SUZI - Subzonal insemination) c báo cáo thành công ln u tiên ti Singapore (Ng 1988). Trong k thut này, mt vài tinh trùng c tiêm trc tip qua màng trong sut (zona pellucida) vào khoang quanh noãn (perivitelline space)  h tr cho tinh trùng th tinh vi noãn. Cng vào nm 1988, k thut c thng màng trong sut (PZD) c gii thiu ln u bi Cohen. Trong k thut này, tác gi ã s dng vi thao tác c thng màng trong sut, sau ó cy tinh trùng vào noãn. Tuy nhiên, c SUZI và PZD u không t c hiu qu cao do t l th tinh ca noãn và tinh trùng không tng áng k nhng t l th tinh a tinh trùng (polyspermia) li tng cao (Cohen 1988). Thai k u tiên thc hin PGT c báo cáo vào nm 1990, và ch sau 10-15 nm sau ó, PGT c thc hin thng quy trong IVF, c bit là ti M. Hin ti, có 3 k thut tip cn sinh thit phôi thc hin PGT c áp dng: sau th tinh, sinh thit phôi ngày 5 hoc ít ph bin hn là sinh thit phôi ngày 2,3 ang phân chia; trc th tinh, sinh thit th cc  xác nh bt thng di truyn  trng, nhng hin ti ít c s dng. Mi cách ly mu sinh thit có u và nhc im riêng v  nhy và tính tin cy. K thut ly mu ph thuc vào mc ích ca s dng test chn oán bao gm: (1) chn oán gii tính phôi thai  tránh các bnh lý di truyn theo nhim sc th gii tính; (2) phát hin khim khuyt n gene  phôi thai; (3) bt thng nhim sc th nh lch bi, a bi và chuyn on phc tp có th phát hin qua xét nghim di truyn tin làm t dành cho lch bi (PGT-A). Hin nay, ti mt s trung tâm, vic thc hin PGT-A  tt c ph n, ph n ln tui, hoc ph n có sy thai lp li nhiu ln trc ó dn tr thành thng quy. Tuy nhiên, các th nghim lâm sàng ngu nhiên có i chng không cung cp c bng chng rõ ràng v giá tr ca vic s dng rng rãi hay có chn lc PGT-A, c bit khi tình trng th khm c phát hin ngày càng nhiu trong sinh thit phôi nang. K thut c s dng cho chn oán di truyn là ly mu sinh thit nên k thut khác nhau tùy vào mc ích ca xét nghim c thc hin. Trc ây, có 2 k thut c thc hin: (i) nhum hunh quang ti ch phát hin bt thng karyotypes, bt thng cu trúc nhim sc th hay gii tính phôi thai và (ii) phn ng chui polyme hóa (PCR) giúp phát hin bnh lý n gene. Gn ây, ã có nhiu s phát trin vt bc trong công ngh khuch i toàn b gene (WGA), array CGH và a hình nucleotide n da trên array (SNP). Hin nay, công ngh gii trình t gene th h mi (NGS) cho phép gii trình t t ng vì vy chi phí php hn so vi k thut array CGH14. Nm 1992, k thut tiêm tinh trùng vào bào tng noãn (ICSI) c gii thiu và to nên cuc cách mng v iu tr vô sinh  nam. Trong k này, mt tinh trùng c tiêm trc tip vào bào tng noãn  h tr s th tinh. Các th nghim u tiên u cho thy rng sau khi tiêm tinh trùng vào noãn, t bào noãn vn có th t hi phc, s th tinh din ra và phôi sau ó phát trin khá tt (Palermo et al. 1992). T l có thai lâm sàng ca k thut ICSI cao hn so vi IVF c in, mc dù cht lng và s lng tinh trùng kém. Nu nh trong iu kin sinh lý t nhiên, ngi nam cn sn xut hàng triu tinh trùng  có th th tinh c mt noãn trong vòi trng, thì vi k thut ICSI, s th tinh có th din ra gia duy nht mt tinh trùng và mt noãn. Hin nay, ti mt s trung tâm ln, ICSI còn c áp dng thay th hoàn toàn k thut IVF c in ngay c i vi trng hp không liên quan n vô sinh nam (ONeill. et al. 2018). Trc khi ICSI ra i, nhng trng hp nam gii không có tinh trùng do b tc (Obstructive Azoospermia) c iu tr bng cách hút tinh trùng  trc v trí tc  bm tinh trùng vào bung t cung (IUI) hoc thc hin IVF. Nm 1994, các trng hp hút tinh trùng t mào tinh qua vi phu và tiêm tinh trùng vào bào tng noãn (MESA  ICSI) u tiên c thc hin. Sau ó, nm 1995, k thut chc hút tinh trùng t mào tinh xuyên da và tiêm tinh trùng vào bào tng noãn (PESA  ICSI) c gii thiu giúp n gin hóa vic iu tr không có tinh trùng do b tc. Trong k thut PESA, không cn phi m bao tinh hoàn mà ch cn chc kim sinh thit vào mào tinh và hút tinh trùng, và k thut này có th thc hin ti phòng khám (Silber 1995). Tip ni nhng thành công trên, k thut phân lp tinh trùng t tinh hoàn  nhng trng hp gim sinh tinh ti tinh hoàn và tiêm tinh trùng vào bào tng noãn (TESE  ICSI) ln u gii thiu vào nm 1995.  nhng trng hp này, tinh hoàn gim sn xut tinh trùng nghiêm trng, n mc có th không tìm thy tinh trùng trong tinh dch; kích thc tinh hoàn nh hoc ch còn mt bên tinh hoàn hot ng; chc nng sn xut ni tit t ca tinh hoàn gim. T l thành công ca TESE  ICSI cng t gn tng ng vi t l thành công chung ca IVF (Devroey 1995). Nm 1991, Cha cùng cng s ã báo cáo trng hp có thai u tiên vi noãn trng thành trong ng nghim (IVM). Trong k thut này, noãn non c chc hút t nhng nang nh ca bung trng vào giai on sm ca pha nang noãn. Nhng nang noãn này sau ó c nuôi cy trng thành trong môi trng bên ngoài c th. Mt t l ln noãn có th trng thành và th tinh bng phng pháp ICSI. IVM ã m ra mt hng i mi cho TTTO, trong ó không cn thc hin kích thích bung trng bng ni tit t, t ó có th gim ch phí iu tr và các bin chng có th gp ca kích thích bung trng. K thut IVM thích hp vi các bnh nhân có hi chng bung trng a nang. Và gn ây, IVM c nghiên cu và áp dng cho hu ht các ch nh thng quy ca IVF (Cha 1991). 1.1.3 Xu hng nghiên cu IVF Bên cnh s thành công ca HTSS hin i là nhng hn ch nh t l chu k tht bi cao, vic s dng IVF rng rãi nh iu tr theo kinh nghim, thiu nhng la chn qun lý trong nhng trng hp gim tr lng bung trng liên quan n tui, nhng nguy c y khoa liên quan n vic kích thích bung trng và chc hút noãn, gánh nng tâm lý liên quan n vic iu tr him mun, gánh nng v tài chính i vi ngi bnh, t l a thai cao, và thiu nhng hiu bit úng v iu tr IVF. Ngày càng có nhiu k thut IVF ra i nhm ci thin kt cc iu tr. Mt iu áng lu ý, ó là s lng phát minh mi trong iu tr IVF cha hn áp ng tc thì nhng mong c thc tin nh giúp các cp ôi d dàng có con hn, ít gánh nng chi phí hn và ít nguy c cho b m và em bé hn. Thc t gn ây cho thy rt ít phát hin mi trong lnh vc y hc sinh sn c ng dng vào thc hành lâm sàng sau khi tri qua kim nh nghiêm ngt (Harper 2017). Câu hi t ra rng các th nghim lâm sàng ngu nhiên có kim soát (RCT) ã giúp ích cho s phát trin ca YHSS nh th nào ? RCT c xem nh thit k nghiên cu ti u  ánh giá chính xác hiu qu ca mt can thip mi. Khi kt cc là bin nh phân (ví d trong YHSS thng là có hoc không có mang thai), cn có kích thc c mu ln  tìm ra nhng nh hng n kt cc lâm sàng vi   tin cy. Trong nhng tng quan h thng (systematic review) và phân tích tng hp (meta analysis) da trên RCT trong thi gian gn ây v lnh vc YHSS, ngi ta nhn thy rng nhiu nghiên cu RCT không t c mc tiêu này (Stocking et al. 2019). Trong th vin Cochrane, không mt nghiên cu RCT n c nào  mnh và ch có 2% phân tích tng hp  ln  phát hin s khác bit 5% v t l sinh sng khi thc hin mt can thip nht nh (Stocking et al. 2019). Hn na, các tác gi s dng nhiu phng thc  ánh giá và nh ngha kt cc, ây là mt iu góp phn cho vic khó khn trong so sánh gia các RCT. Mc dù ã có nhiu li kêu gi thc hin các nghiên cu RCT trong lnh vc HTSS, tuy nhiên s lng nghiên cu RCT n hin ti vn khá hn ch (Duffy 2018). Ti sao vic thc hin nghiên cu trong lnh vc HTSS li tin trin chm nh vy? Tuy RCT là thit k hiu qu, nhng cn có s n lc trong hp tác gia các trung tâm  có c nhng th nghim  ln. Mc dù s cnh tranh là iu cn thit cho tin b khoa hc, nhng th gii IVF dng nh ang bn rn vi s cnh tranh v khía cnh kinh t trong vic cung cp các dch v HTSS hn là khoa hc v sinh sn. HTSS ang chng kin quá trình công nghip hóa các dch v y t vi tc  nhanh chóng và quy mô ln. Vì vy mà hot ng nghiên cu khoa hc mang tính cc b cha xng tm vi ngun d liu ln ca lnh vc này. S thành công ca YHSS hin nay là nh s khám phá nhiu k thut mi nh s dng xét nghim min dch phóng x  nh lng nng  hormone, phác  kích thích bung trng vào nhng nm 60 ca th k trc, và k sau ó là th tinh trong ng nghim và cho ra i em bé u tiên sinh ra t TTON vào nm 1978.  t c s phát trin vt tri nh vy, y hc lâm sàng cn nhng nghiên cu có cht lng cao và nhng bài báo c trích dn rng rãi bi nhng nhà khoa hc khác. Nhng tp chí v YHSS có yu t nh hng (impact factor) ngày càng tng (Buster 1991). Nm 2015, Aleixandre-Benavent cùng cng s ã thc hin nghiên cu nhm mc ích kho sát xu hng trong nghiên cu lâm sàng lnh vc h tr sinh sn. Nhng bài báo c chn la là nhng bài thuc v lnh vc sinh hc sinh sn c báo cáo trong Journal Citation Report trong giai on 2003  2012. Kt qu ghi nhn có 90 tác gi vi hn 1000 lt trích dn vi 4.010 bài báo (3.583 tp chí và 427 bài ánh giá). S lng bài báo v YHSS c ng trên nhng tp chí có ch s nh hng (impact factor) cao nht là 3.662 bài báo, trong ó Human Reproduction là tp chí có s lng bài nhiu nht (n=980), k n là Fertility &amp; Sterility (n=891). Tp chí u tiên không v YHSS ng bài v lnh vc YHSS là Journal of Clinical Endocrinology and Metabolism (n=288), và k tip là British Journal of Obstetrics and Gynaecology (n=77). S lng bài báo v lnh vc sinh lý sinh sn còn khá hn ch. Tuy nhiên, yu t nh hng ca nhng tp chí v YHSS tng khá nhanh, và hin ti yu t nh hng ã tng ng vi các tp chí lnh vc khoa hc khác nh nhi khoa, hô hp, nhãn khoa, sn ph khoa và lão khoa. Hn na, s lng bài báo công b v YHSS tng nhanh hn so vi các lnh vc khoa hc khác. Trong ó, Fauser là tác gi có s lng trích dn cao nht, vi s lng trích dn trong lnh vc YHSS là 7451, tip theo là Azziz (n=6.347), và Devroey (n=6104). Ni nghiên cu có s lng trích dn cao nht là Trung tâm Y khoa i hc Erasmus (Rotterdam, Hà Lan) (n=9006 trích dn), theo sau là Trung tâm Y khoa i hc Utrecht (Hà Lan) (n=7.108) và i hc Vrije Brussels (B) (n=6.846). Nhóm tác gi nhn thy rng có n 22% nhng tp chí có lng trích dn cao nht c ng trong nhng tp chí có lnh vc nghiên cu chính không phi là sinh hc sinh sn. Nhng quc gia có s lng trích dn cao nht là Hà Lan, B, Tây Ban Nha, Hoa K và Anh, và s lng nghiên cu ang tng lên tng ngày. Nhng t khóa quan trng xut hin ngày càng nhiu trong nhng nghiên cu v YHSS là k thut HTSS, IVF, kt cc thai k và sc khe trong tng lai ca m và bé sau thc hin IVF. Nh vy, thông qua phân tích trên ã cung cp bng chng thuyt phc v s trng thành ca các nghiên cu khoa hc trong lnh vc HTSS, s lng các nghiên cu có cht lng cao c ng trong các tp chí không thuc lnh vc HTSS và có yu t nh hng cao ngày càng nhiu. S phát trin nhanh v các k thut iu tr và ra mt nhiu mô hình iu tr mi òi hi s giám sát cht ch ca quc gia và quc t v tính hiu qu và an toàn cho c b m và em bé c iu tr (Aleixandre-Benavent, Simon, and Fauser 2015). ng trc s phát trin mnh m ca trí tu nhân to, lnh vc HTSS cng không nm ngoài xu hng ó. Machine learning là mt nhánh ca công ngh trí tu nhân to nhm cung cp nhng công c có th ci thin kh nng phân tích da trên nhng s kin xy ra trc ó. Trong mng phân tích d liu, Machine learning c s dng  to ra các mô hình và thut toán  có  d oán kt qu. Kh nng thành công ca HTSS có th tng bng cách iu chnh các bin s có th nh hng n quá trình iu tr. Tuy nhiên, vic xác nh mi liên quan gia các bin s là mt nhim v phc tp dành cho ngi bác s lâm sàng và chuyên viên phôi hc. Vì vy, nhng mô hình và thut toán có kh nng d oán kt cc ca vic iu tr là rt cn thit giúp bác s và bnh nhân có th t c t l thành công cao hn. Ngày nay, Machine learning trong lnh vc HTSS c phát trin và nghiên cu ngày càng nhiu nhm cung cp cho các bác s lâm sàng nhng thông tin hu ích hn  có c nhng quyt nh tt hn, t ó giúp ci thin t l thành công ca iu tr (Okhovati et al. 2015). 1.1.4 So sánh kt qu IVF trc và sau khi có nghiên cu Trc khi áp dng các can thip trong lnh vc YHSS trên ngi bnh, các can thip nên c ánh giá v tính hiu qu và an toàn. Tính hiu qu ca mt can thip trong lnh vc YHSS c th hin bi s ci thin v t l tr sinh sng (LBR) khi so sánh vi các can thip khác thông qua th nghim RCT. Nm 2019, Stocking K cùng cng s (2019) thc hin nghiên cu nhm mc ích phân tích  mnh v mt thng kê ca các th nghim lâm sàng ngu nhiên có i chng và phân tích tng hp  ánh giá hiu qu ca th nghim trong YHSS. Nh trc ó ã  cp, hiu qu ca mt can thip c ánh giá tt nht khi s dng thit k RCTs.  có th cung cp c nhiu thông tin hu ích, nhng th nghim này nên  mnh  có th phát hin c nhng nh hng lâm sàng nh nht. Nhóm nghiên cu thc hin ánh giá  mnh và s chính xác ca 199 nghiên cu RCT và phân tích tng hp t 109 bài phân tích ca Cochrane. Nhng nghiên cu c la chn là các bài phân tích h thng c ng bi Cochrane vi kt cc chính là t l tr sinh sng. i vi mi phân tích h thng cho kt qu là LBR (hoc t l thai din tin), RCT có c mu ln nht trong phân tích h thng ó c nhóm nghiên cu tính toán  mnh  phát hin s ci thin v LBR. Hn na, khong tin cy 95% (95% CI) c s dng  c tính hiu qu ca iu tr trong phân tích h thng hoc RCT, nhm ánh giá s chính xác ca kt qu ca nghiên cu c phân tích. i vi mi kt cc trong các RCT và phân tích tng hp, nhóm nghiên cu tính toán  mnh  có th phát hin s ci thin LBR t 1 im phn trm (percentage point - pp) n 25 pp, vi tc  tng là 0.5 pp, và s dng phân tích tiêu chun dành cho bin nh phân (kim nh chi-squared hoc Z test of proportions). Ví d s ci thin 5 pp ngha là s tng LBR t 20%  nhóm chng lên 25%  nhóm iu tr. Sau ó, nhóm nghiên cu thc hin tng kt  mnh ca các RCT/phân tích h thng bng cách s dng thng kê mô t, bao gm t l các RCT/phân tích h thng có th t c  mnh 80% và 90%  phát hin c s ci thin trong LBR. Kt qu ghi nhn trung bình  mnh ca các RCT cho kt qu ci thin LBR 5% tr lên sau can thip (ví d t 25% lên 30%) là 13% (821%) và 16% (933%) i vi các phân tích h thng. Không có RCT nào và ch có 2% các phân tích h thng t c 80%  mnh  có th phát hin s ci thin 5 pp v LBR. Nhóm tác gi ghi nhn có 28% các bài phân tích trên Cochrane không có d liu v tr sinh sng (hoc thai din tin). iu này có th do hiu qu ca nhng th nghim này ã b loi tr trong giai on sm hoc nghiên cu thí im (pilot study) vì can thip không làm thay i nhng yu t có th nh hng n LBR (ví d s noãn chc hút c hay cht lng phôi). Nh vy, Stocking K. cùng cng s ã chng minh rng lnh vc YHSS hin ang thiu nhng nghiên cu có kh nng phát hin s ci thin thc t v LBR. Tuy nhiên, các nghiên cu RCT và phân tích tng hp là nhng thành phn không th thiu  ánh giá tính hiu qu ca nhng can thip trong lnh vc vô sinh him mun. Trong tng lai cn nhiu chin lc  ci thin bng chng và kêu gi s cng tác  tp trung vào nhng câu hi nghiên cu ct lõi nht(Stocking et al. 2019). 1.1.5 Kt lun Nh vy, nghiên cu khoa hc là ng lc phát trin cho y khoa nói chung và lnh vc HTSS nói riêng. Trên th gii, s lng các nghiên cu có cht lng cao c ng trong các tp chí không thuc lnh vc HTSS và có yu t nh hng cao ngày càng nhiu. Cùng vi s công nhn rng rãi ca th gii dành cho HTSS, Vit Nam cn có nhiu hn nhng nghiên cu có cht lng cao, c bit là các RCT. Lnh vc HTSS ti nc ta có nhiu thun li  thc hin NCKH nh ngun d liu nhiu và s lng bnh nhân iu tr nhiu. Vì vy trong tng lai, Vit Nam có c hi rt ln  phát trin NCKH trong lnh vc HTSS. 1.2 Gii thiu v giáo trình 1.2.1 Ý tng v mt giáo trình thng kê chuyên dng cho nghiên cu HTSS Cho n nay trong trng i hc Y khoa, Thng kê vn luôn c ging dy nh mt môn hc tng quát và tách bit vi các chuyên khoa lâm sàng. Ngay c trong giai on ào to sau i hc bao gm ni trú, chuyên khoa cp 2, nghiên cu sinh Thc s và Tin s, khi các bn bác s ã nh hng rt rõ v chuyên môn lâm sàng và ang theo ui các  tài nghiên cu chuyên bit, thì h vn phi hc v Thng kê mt cách chung chung. H qu là khi bt tay vào thc hành nghiên cu lâm sàng, các bn bác s gp nhiu tr ngi khi xác nh công c thng kê phù hp  gii quyt mt s vn  c thù trong chuyên khoa ca mình. Trong bi cnh này, chúng tôi mun th nghim mt cách thc tip cn mi  ó là xây dng mt giáo trình thng kê chuyên dng cho nghiên cu H tr sinh sn, dành riêng cho bác s Sn Ph khoa. Không phi ngu nhiên và tùy hng khi chúng tôi chn chuyên ngành Sn Ph khoa  làm thí im cho cách hc và thc hành thng kê mi này, mà iu này ch là s k tha truyn thng v mi quan h tng tr tt p gia ngành Sn Ph khoa và ngành Thng kê (Bland 1997). Tht vy, khi tham kho y vn ngành Sn Ph khoa t thp niên 1930 n giai on hin i ta s nhìn thy rõ tin trình ng hành phát trin và cng hng tích cc ca c hai chuyên ngành khoa hc này. Mt mt, ngành thng kê cung cp phng tin cho bác s Sn Ph khoa gii quyt hiu qu hn các câu hi lâm sàng: T ch nhng nghiên cu mô t n gin và thô s, không áp dng bt c phép kim thng kê nào vào nhng nm 1930-1945, phân tích thng kê tr thành mt ni dung quan trng chim t l cao dn trong phn Phng pháp nghiên cu. Theo mt kho sát ca tác gi Khan và cs nm 1999, t l bài báo khoa hc ngành Sn Ph khoa ng dng mô hình hi quy logistic ã không ngng gia tng theo thi gian (Khan, Chien, and Dwarakanath 1999); t 1,7% nm 1985 lên 2.8% nm 1990 và 6.5% nm 1995 (hin nay t l này cao hn 23%, theo tác gi ghi nhn vào nm 2021). Mt khác, Sn Ph khoa là chuyên ngành có mt truyn thng v quan im ci m trong vic dung np nhng k thut thng kê tiên tin và phi chính thng. Thí d, n tân cui thp niên 1990 khi chuyên ngành Ni khoa hô hp vn còn dùng nhng mô hình hi quy tuyn tính rt thô s  c lng giá tr tham chiu cho dung tích phi hay lu lng thông khí, thì ngay t thp niên 1970 Sn Ph khoa ã vn dng nhng k thut thng kê rt tin b  kho sát din bin ca các hormone sinh sn và nhiu biomarker huyt ng hc nhau thai, quy lut tng trng ca thai nhi, bao gm quy lut phân phi logarit normal, Gamma, mô hình hi quy phi tuyn tính vi hàm a thc Trong mt s hoàn cnh, chính Sn Ph khoa ã t ra nhng bài toán thng kê c áo, dn n s phát trin nhng phng pháp thng kê chuyên bit, thí d các mô hình hi quy phân v mô t quy lut tng trng ca thai nhi và tr s sinh, cng nh bài toán phân tích thi gian s kin là mt du n c áo ca ngành Sn Ph khoa, mô hình hi quy negative binomial  c lng s lng noãn trong chu k th tinh nhân to (ART calculator), vv. Mt ng lc khác thúc y chúng tôi thc hin giáo trình này, ó là tip cn kin thc, k nng thng kê là mt nhu cu thit yu ca các anh ch em bác s lâm sàng. Hin nay vn còn tn ti nhiu hn ch v mt bng trình  thng kê trong gii bác s Sn Ph khoa và hin trng này là ph bin ngay c  các nc có nn giáo dc i hc và y hc phát trin. Theo mt cuc kho sát vào nm 2011 ca nhóm tác gi Anderson và cs trên 4713 bác s ni trú Sn Ph khoa ti Hoa k (Anderson, Williams, and Schulkin 2013), ch có 26% có kh nng nh ngha úng khái nim « positive predictive value » và ch có 42% hiu úng ý ngha ca giá tr p. Có n 37% bác s ni trú Sn Ph khoa cho bit không c hun luyn bài bn v k nng c hiu thng kê, s còn li phn ln ch t hc hoc thông qua các bui bình lun y vn. Trong mt nghiên cu khác ca Welch và cs vào nm 1994 (Gerald Welch 1996) cho riêng t báo American Journal of Obstetrics and Gynecology (AJOG), ch có 30.3% s bài báo trình bày mt k hoch phân tích có phm cht tt, trong khi vn còn 31.7% công b ã áp dng k thut phân tích thng kê không phù hp và nhiu bài trong s này phm nhng sai lm nghiêm trng v suy lun thng kê. Khi kho sát li mt ln na sau thi gian 5 nm (Welch and Gabbe 2002), các tác gi nhn thy ã có s ci thin áng k v t l phân tích thng kê có phm cht tt (56.4% so vi 30.3%). Kt qu này cho thy quy trình bình duyt ngày càng kht khe và mc  cnh tranh cao ã loi b bt nhng bài báo khoa hc có phm cht kém. iu này gi ý rng k nng thng kê có vai trò rt quan trng quyt nh kh nng công b c nghiên cu trên các t báo danh ting. Cui cùng, chuyên  h tr sinh sn c tác gi la chn làm l trình vì tính c áo và thú v ca nó. Ngay c vi mt ngi có kinh nghim thc hành thng kê y hc hn 12 nm, tác gi cng b choáng ngp trc mc  phc tp ca bài toán thng kê trong nghiên cu HTSS. Tính cht phc tp này bao gm hai vn : Quy trình th tinh nhân to din ra qua nhiu công on và t ra nhiu loi kt cc cn c kho sát hn bt c chuyên khoa nào khác. Theo quy c, mt th nghim lâm sàng có th cn c lng t 5 n 10 loi kt cc. Nhng kt cc này có bn cht a dng : s m (noãn, phôi), t l (kh nng trng thành, th tinh, phôi c chuyn), nh giá (kh nng t thai sinh hóa, thai lâm sàng, thai din tin, sinh n thành công). Bài toán thng kê trong nghiên cu HTSS din ra trong mt h thng tng tác phc tp gia nhiu yu t gây nhiu, hip bin, và sinh ra mt chui kt qu có tính cht k tha và ph thuc ln nhau. D liu li thng là hi cu nên cn nhng phng pháp can thip thích hp  vô hiu hóa hiu ng nhiu ca các hip bin và yu t nn. Mt khác, ngay c thit k RCT cng không th loi b hoàn toàn nhng hip bin phát sinh ra sau giai on phân nhóm ngu nhiên. Do ó, mt phân tích thng kê chính xác cho d liu nghiên cu HTSS òi hi kin thc sâu rng v lý thuyt xác sut, nhiu loi mô hình thng kê chuyên bit nh GLM, GLMM, GEE, c nh hng bng kin thc y hc chuyên ngành. Nhng kin thc và k nng này u vt ra khi gii hn ca thng kê y hc thng quy. Nhóm tác gi hy vng giáo trình này s tr thành mt cu ni gia hai th gii: Thng kê và Sn Ph khoa lâm sàng, giúp cho c bác s/nghiên cu sinh chuyên ngành H tr sinh sn và chuyên viên thng kê nhn ra tính cht tng hp và liên h kì thú gia các hin tng, quá trình trong thí nghim th tinh nhân to và các quy lut phân phi xác sut, mô hình hi quy chuyên bit. T ó, h tìm c ngôn ng chung, có th phiên dch các câu hi nghiên cu thc tin thành bài toán thng kê, và vn dng c công c thng kê phù hp cho vn  lâm sàng. 1.2.2 Mc tiêu hc tp Qua tác phm này, các tác gi mong mun hng dn ngi c t c nhng thành qu nh sau: V mt lý lun và t tng, các bn bác s và chuyên viên thng kê s nhn ra c nhng im c áo, thú v ca d liu và các bài toán thng kê trong nghiên cu h tr sinh sn mà ta không th gp trong bt c chuyên khoa lâm sàng nào khác. Các bn cng s nhn ra bn cht ca các loi kt cc khác nhau trong nghiên cu th tinh nhân to, phiên dch c chúng sang ngôn ng xác sut và áp dng úng loi phân phi, mô hình phù hp. Qua vic thc hành các thí nghim trong sách, kh nng phân tích thng kê bng ngôn ng R ca ngi hc s t trình  nâng cao, tng ng vi mt nhân viên phân tích d liu chuyên nghip. Nhng k nng này bao gm phong cách vit R codes hin i, vic nm vng quy trình suy din thng kê da vào mô hình tuyn tính tng quát (generalized linear model), tn dng u th v  ha thng kê ca R  to ra biu  n tng và làm quen vi phng pháp machie learning kh din   thay th cho các công c thng kê c in và kim nh ri rc. c bit, chúng tôi  xut nhiu ý tng và k hoch phân tích cha tng c áp dng trong y vn ca chuyên ngành h tr sinh sn, vi hy vng và nim tin v tng lai phát trin ca y hc hàn lâm ca nc ta. 1.2.3 Ni dung và quy c trình bày Cu trúc ca giáo trình c thit k theo dng module gm 9 chng hoàn toàn c lp vi nhau. Các bn có th khi hành  bt c chng nào, cng nh c theo trình t ngu nhiên tùy ý thích. Mi chng s gii thiu v mt phng pháp thng kê khác nhau, tng ng vi mt mc tiêu nghiên cu chuyên bit. Sau khi c xong và tng hp li, các bn s nhn ra mình ã i qua tt c các chng trên hành trình tng ng vi mt chu kì th tinh nhân to và nm vng các gii pháp thng kê thích hp cho tt c các loi kt cc lâm sàng  mi công on. Ni dung ca mi chng s c trình bày nh mt nghiên cu lâm sàng thu nh và da trên d liu thc nghim có thc, bao gm bi cnh ca thí nghim, mc tiêu ca nghiên cu, ni dung ca k hoch phân tích, lc ging lý thuyt v phng pháp thng kê, bn hng dn thi hành tng bc, dn n kt qu, din gii kt qu, bàn lun và cui cùng là mt bn tóm tt ngn gn nhng thông ip dùng làm hành trang. Giáo trình này c biên son theo tiêu chí thc dng, nên chúng tôi c gng cân bng gia ni dung lý thuyt v thng kê và k nng thc hành. Trong mi chng sách, hàm lng lý thuyt c gin lc ti thiu  các bn bác s lâm sàng hiu c khái nim thng kê, không b phân tâm bi các thut toán, công thc phc tp nhng vn nm va  thông tin v k thut  có th trình bày li trong lun vn hoc bài báo khoa hc ca mình. Ni dung thc hành c biên son nh công thc nu n hay s tay phòng thí nghim,  mc  chi tit  cho ngi hc cm thy d chu và thoi mái nh c mt ngi bn cm tay hng dn trc máy tính. Kt qu s hin th ngay cho mi bc và c din gii mt cách rõ ràng nhng chun mc v thut ng và vn phong khoa hc. Nhm thích ng vi hai nhóm i tng ngi c khác nhau vi nhng nhu cu hc tp khác nhau, bao gm (1) nhóm bác s lâm sàng ch cn mt tài liu chuyên kho, nhm tìm hiu v thut ng, khái nim thng kê, cách thc din gii kt qu và din t trong vn bn khoa hc, nhng không có nhu cu i sâu vào thc hành phân tích d liu; và (2) nhóm chuyên viên thng kê hoc bác s nghiên cu sinh có nhu cu hc lp trình thng kê trong ngôn ng R  có th t phân tích d liu cho bn thân, chúng tôi quyt nh không trình bày ni dung mã lp trình trong sách in, nhng s cung cp d liu và mã lp trình kèm theo sách. 1.2.4 Ngun gc ca d liu Mi thí nghim trong giáo trình này c tác gi tin hành trên mt phiên bn d liu ã qua biên tp và làm sch t d liu gc. Vic biên tp bao gm gin lc cu trúc, trích xut tp hp bin s hoc phân nhóm thích hp vi bài toán thng kê chuyên bit t mt hay nhiu b d liu gc. Tt c d liu gc u c tác gi ca chúng chia s công khai cho cng ng (public data), và u là d liu có thc t nhng nghiên cu lâm sàng chuyên ngành h tr sinh sn trong giai on 2018-2022 ti Trung Quc và mt s quc gia Châu Âu khác. Thông tin chi tit v ngun gc ca nhng b d liu này c trình bày di ây: B d liu t nghiên cu Blastocyst age, expansion, trophectoderm morphology, and number cryopreserved are variables predicting clinical implantation in single blastocyst frozen embryo transfers in freeze-only-IVF ca nhóm tác gi Kevin Coetzee, Kemal Ozgur và cng s, vi mc tiêu nhm xác nh vai trò nhng thông s phm cht và hình thái phôi cho phép d oán kh nng th thai lâm sàng trong các trng hp chuyn phôi bng k thut frozen embryo transfers (FET) trong chu k IVF. Nghiên cu c công b ngày 16/2/2021 ti: Journal of Assisted Reproduction and Genetics (2021) 38:10771087. D liu có th truy cp ti: https://data.mendeley.com/datasets/5925df99w9/1 (DOI: 10.17632/5925df99w9.1) B d liu ca nhóm tác gi Sandro C. Esteves và cng s, dùng trong nghiên cu Validation of ART Calculator for Predicting the Number of Metaphase II Oocytes Required for Obtaining at Least One Euploid Blastocyst for Transfer in Couples Undergoing in vitro Fertilization/Intracytoplasmic Sperm Injection, c công b ngày 24/1/2020 ti: Front Endocrinol (Lausanne). 2019; 10: 917. doi: 10.3389/fendo.2019.00917. ây là nghiên cu a trung tâm vi mc tiêu kim nghim mô hình tiên lng ART calculator ca nhóm tác gi có kh nng d oán s lng noãn MII ti thiu cn thu thp  t c ít nht mt phôi kh dng trên bnh nhân tin hành phng pháp th tinh trong ng nghim. D liu c công khai và có th truy cp t trang web ca bài báo: https://www.frontiersin.org/articles/10.3389/fendo.2019.00917/full D liu ca nhóm tác gi Lu Guan và cng s dùng trong nghiên cu The effect of mildly stimulated cycle versus artificial cycle on pregnancy outcomes in overweight/obese women with PCOS prior to frozen embryo transfer: a retrospective cohort study. ây là mt nghiên cu hi cu nhm so sánh kt cc thai kì gia phng pháp kích thích nh s dng Letrozole và chu k nhân to trc khi tin hành chuyn phôi FET  ph n mc hi chng bung trng a nang (PCOS). Bài báo c công b nm 2022 trên t báo: BMC Pregnancy and Childbirth (2022) 22:394: (https://doi.org/10.1186/s12884-022-04728-6), d liu c công khai và có th truy cp t trang web ca bài báo hoc t kho d liu fishare: https://figshare.com/articles/dataset/Additional_file_1_of_The_effect_of_mildly_stimulated_cycle_versus_artificial_cycle_on_pregnancy_outcomes_in_overweight_obese_women_with_PCOS_prior_to_frozen_embryo_transfer_a_retrospective_cohort_study/19728623 B d liu m t nghiên cu Prediction of live birth and cumulative live birth rate in a general infertile population treated with freeze-all-IVF ca nhóm tác gi Kevin Coetzee, Kemal Ozgur và cng s, vi mc tiêu kho sát mi liên h gia các thông s can thip vi t l to phôi và t l inh sng tích ly (cumulative live birth) trong chu kì IVF trên qun th ph n vô sinh tng quát. Nghiên cu c công b ngày 21/2/2019 ti: J Assist Reprod Genet. 2019 Apr; 36(4): 685696.doi: 10.1007/s10815-019-01422-z. D liu có th truy cp ti: https://data.mendeley.com/datasets/xy2t2cxm8g (DOI: 10.17632/xy2t2cxm8g.1) D liu ca nhóm tác gi Qianwen Xi và cng s dùng trong nghiên cu Comparison Between PPOS and GnRHa-Long Protocol in Clinical Outcome with the First IVF/ICSI Cycle: A Randomized Clinical Trial. Mt nghiên cu hi cu nhm kho sát hiu qu ca phác  progestin-primed ovarian stimulation (PPOS) so vi phác  i vn GnRH kéo dài. Bài báo c công b vào tháng 3/2020 ti Clin Epidemiol. 2020; 12: 261272. (https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7060798/). D liu công khai và có th truy cp ti: https://figshare.com/articles/dataset/dataset/10253063/3 D liu ca nhóm tác gi Lu Li và cng s dùng trong nghiên cu Which Factors Are Associated With Reproductive Outcomes of DOR Patients in ART Cycles: An Eight-Year Retrospective Study, nhm mc tiêu kho sát các yu t liên quan n kt cc sinh sn  nhóm i tng ph n him mun gim d tr bung trng và vai trò ca AMH i vi d kt qu chu k IVF  nhóm bnh nhân này. Bài báo c công b ngày 23/6/2022 ti : Front Endocrinol (Lausanne) 2022;13:796199 (doi: 10.3389/fendo.2022.796199). D liu công khai và có th truy cp t trang web ca bài báo: https://www.frontiersin.org/articles/10.3389/fendo.2022.796199/full D liu ca nhóm tác gi Yanjun Zheng và cng s dùng trong nghiên cu Ovarian Sensitivity Decreased Significantly in Patients With Insulin Resistance Undergoing in vitro Fertilization and Embryo Transfer. Mc tiêu nhm khám phá mi liên h gia ch s nhy cm bung trng (OSI) và các thông s truyn thng v áp ng bung trng và kho sát mi quan h gia OSI và ri lon kháng-insulin  ph n vi hi chng PCOS. bài báo c công b trên t Front Physiol. 2022 Mar 11;12:809419 (doi: 10.3389/fphys.2021.809419).D liu công khai và có th truy cp t trang web ca bài báo: https://www.frontiersin.org/articles/10.3389/fphys.2021.809419/full B d liu ca nhóm tác gi Mathilde Bourdon và cng s, dùng trong nghiên cu The deferred embryo transfer strategy improves cumulative pregnancy rates in endometriosis-related infertility: A retrospective matched cohort study. Mc tiêu nhm so sánh kt cc h tr sinh sn gia 2 k thut chuyn phôi ông (Def-ET) và phôi ti (ET)  i tng ph n him mun kèm theo bnh lý ni mc t cung. Bài báo công b trên t PLOSOne ngày 19/4/2019: https://doi.org/10.1371/journal.pone.0194800. D liu công khai và có th truy cp ti: https://figshare.com/articles/dataset/The_deferred_embryo_transfer_strategy_improves_cumulative_pregnancy_rates_in_endometriosis-related_infertility_A_retrospective_matched_cohort_study/6116915?file=11029871 1.2.5 V mt s th vin R quan trng Trong giáo trình này các tác gi ã s dng mt s th vin/gói công c (packages) nh sau: Tidyverse ây là mt h sinh thái c phát trin bi RStudio (Wickham et al. 2019), tp hp các gói vi công dng x lý và phân tích d liu trong R. Mi gói trong tidyverse u có mc ích riêng bit, nhng chúng li c thit k  tng tác tt vi nhau, giúp ngi dùng x lý và phân tích d liu mt cách d dàng và hiu qu hn, bao gm: X lý và chuyn i d liu (tidyr, dplyr),  ha thng kê (ggplot2 (Wickham 2016)), c và ghi d liu (readr, readxl, writexl), lp trình hàm và x lý d liu song song (purrr). Ngoài ra, tidyverse cng nh hình phong cách vit R codes hin i da trên h thng nguyên tc v tidy data c lp ra bi Hadley Wickham, tác gi chính ca tidyverse. Theo khái nim này, d liu s c t chc theo các ct (variables) và các hàng (observations), mi hàng là mt quan sát và mi ct là mt thuc tính ca quan sát ó. Vic s dng tidy data giúp cho vic x lý và phân tích d liu tr nên d dàng và rõ ràng hn. GAMLSS GAMLSS (Generalized Additive Models for Location, Scale and Shape) (Stasinopoulos 2017) (Robert A. Rigby 2020) là mt th vin trong ngôn ng lp trình R c phát trin bi các nhà thng kê Robert Rigby và Mikis Stasinopoulos và c gii thiu vào nm 2005, vi công dng xây dng các loi mô hình tuyn tính tng quát và phi tuyn tính cho rt nhiu quy lut phân b xác sut và cho phép c lng riêng bit tng tham s ca mt quy lut phân phi. Nh s dng gamlss mà ta có th thc hin các ý tng v mô hình GLM cho các phân phi Negative binomial, Binomial, Gamma, vv cho các loi kt cc lâm sàng khác nhau trong nghiên cu IVF. Marginaleffects ây là mt th vin quan trng khác s c s dng thng xuyên trong nhiu thí nghim. Th vin marginaleffects (Vincent Arel-Bundock 2023) h tr c lng và kim nh các hiu ng biên (marginal effects) trong quá trình suy din thng kê da trên ni dung các mô hình hi quy. Th vin này tng thích vi hn 70 gói công c v mô hình hi quy trong R, cho phép suy lun thng kê cho tt c các mô hình thng kê ph bin, bao gm GLM, survival, GLMM và GEE. Tidymodels Tidymodels là mt h sinh thái các gói công c c phát trin bi Max Kuhn, vi ng dng thc hin các thí nghim Machine learning trong R (Kuhn and Wickham 2020) (Kuhn and Silge 2022). Ý tng ca tidymodels là cung cp mt khung công c ph quát, n gin và d s dng  thc hin mt quy trình xây dng các mô hình machine learning da trên d liu. Quy trình này bao gm các bc tin x lý d liu, la chn bin, xây dng và ánh giá mô hình. Tidymodels cng cung cp các hàm d s dng  tinh chnh và ti u hóa các tham s ca mô hình. Nó có tính nht quán và ph quát, khi t ra mt quy trình, quy lut cú pháp R codes ng nht, gim thiu s ph thuc vào cú pháp chuyên bit, phân tán ca các gói phn mm khác. 1.2.6 Yêu cu v kin thc và k nng c bn Hu ht nhng phng pháp thng kê c gii thiu trong tài liu này vt ra ngoài gii hn ca kin thc thng kê y hc thng quy, tuy nhiên nhóm tác gi s c gng trình bày v chúng mt cách n gin và d hiu nht có th, da trên gi nh rng ngi c ã nm vng kin thc v xác sut và thng kê  trình  i hc y khoa (mt s khái nim c bn nh hàm m, hàm logarit, phân phi xác sut, bin ngu nhiên, nguyên lý kim nh gi thuyt vô hiu, các tr s thng kê mô t và c lng nguy c nh OR, RR, khong tin cy, mt s dng biu  thng kê c bn và mô hình hi quy tuyn tính). V k nng lp trình thng kê, chúng tôi gi nh rng ngi c ã tng tip cn và s dng qua ngôn ng R (R Core Team 2022)  mc  khái nim và c bn. Yêu cu duy nht là các bn ã bit cách s dng R console hoc giao din R-Studio, vi mt s thao tác c bn nh cài t và gi R package, ti d liu .csv. Trong quá trình thc hành các bn s c hng dn chi tit mi công on, hu ht trng hp ta ch n gin làm vic  mc  ng dng th vin (package) có sn. Ch mt s ít trng hp yêu cu vit hàm hoc vòng lp nhng các bn hoàn toàn có kh nng c hiu và tái s dng mã lp trình do tác gi cung cp. 1.2.7 Kh nng tng thích vi chuyên khoa lâm sàng khác Tài liu này c biên son dành riêng cho các bác s Sn Ph khoa và chuyên ngành H tr sinh sn, vì vy hiu qu thc hành và ng dng s t ti u cho các ng nghip này. Tuy nhiên vì thng kê là mt môn khoa hc ph quát, nên bng t duy tru tng và sáng to, ngi c t mt chuyên khoa khác, thm chí không công tác trong ngành Y khoa vn có th tip thu c mt s ý tng và k nng t các thí nghim trong sách và vn dng cho nhng vn  ca bn thân. Thí d: mô hình hi quy Negative binomial có th áp dng kho sát kt cc là s t kch phát ca bnh phi tc nghn mn tính hay hen ph qun cho chuyên khoa hô hp, mô hình hi quy Gamma có th dùng kho sát mt biomarker trong chuyên khoa Tim mch, ý tng v Machine learning kh din và phân tích thành phn chính PCA có th áp dng cho nghiên cu sinh hc phân t, vv. References "],["kho-sát-bin-s-liên-tc-mô-hình-hi-quy-gamma.html", "Chng 2 Kho sát bin s liên tc: Mô hình hi quy Gamma 2.1 Gii thiu 2.2 Bi cnh ca thí nghim 2.3 Công c cn thit 2.4 Chun b d liu 2.5 K hoch phân tích 2.6 Phân tích mô t 2.7 Bin lun v tính phù hp ca phân phi Gamma 2.8 Dng mô hình hi quy vi phân phi Gamma 2.9 Suy din thng kê t mô hình GLM-Gamma 2.10 Kt lun 2.11 Thông ip rút gn làm hành trang", " Chng 2 Kho sát bin s liên tc: Mô hình hi quy Gamma Biên son: Lê Ngc Kh Nhi, Dng Th Ngc Châu 2.1 Gii thiu Ta s khi hành bng mt vn  thng gp trong nghiên cu y hc lâm sàng, ó là bài toán so sánh giá tr mt i lng gia nhiu phân nhóm c lp. Trong nghiên cu h tr sinh sn, bài toàn này c t ra khi i tng kho sát là các loi hormone nh AMH, LH, FSH, E2 c nh lng  iu kin c bn hoc ti mt thi im trong quá trình can thip, và thit k nghiên cu nhm so sánh gia nhiu loi phác  can thip hoc các phân nhóm lâm sàng khác nhau. Gii pháp thng quy chúng ta hay dùng là phân tích phng sai mt yu t (n bin) (One-way ANOVA). Tuy nhiên, ANOVA c in li da trên iu kin gi nh v tính cht phân phi chun ca d liu và gi nh này him khi nào phù hp vi thc tin, vì hu ht nhng i lng y sinh hc trong t nhiên u có phân phi lch dng. Trong chng này, các bn s c gii thiu v mt gii pháp linh hot và ph quát hn cho bài toán so sánh giá tr trung bình ca bin nh lng gia nhiu phân nhóm c lp, ó là mô hình tuyn tính tng quát (Generalized linear model, GLM) vi phân phi Gamma. 2.2 Bi cnh ca thí nghim Thí d minh ha s dng dataset Five_protocols.csv t mt nghiên cu có thc trên 1005 ph n c thc hin th tinh nhân to. Mc tiêu t ra là kho sát giá tr hormone LH  ngày trigger (bin LH) gia 5 loi phác  kích thích bung trng (bin Protocol), gm: Mild = mild stimulation s dng Letrozole, GnRH_ant = Phác  i vn GnRH, Fol_long = Follicular long acting, PPOS: Progestin-Primed Ovarian Stimulation, Lut_short = Lutean phase short acting. 2.3 Công c cn thit Quy trình phân tích cn nhng công c sau ây: H sinh thái tidyverse (Wickham et al. 2019): vi th vin ggplot2 cho  ha thng kê và dplyr  thao tác d liu Th vin ggridges (Wilke 2022):  v biu  mt  phân phi riêng cho tng phân nhóm (ggplot2 c bn không h tr loi biu  này). Th vin fitdistrplus (Delignette-Muller and Dutang 2015) cho phép kim tra tính phù hp gia d liu thc nghim và mt quy lut phân phi xác sut lý thuyt, nh Gaussian hoc Gamma. Th vin gamlss (R. A. Rigby and Stasinopoulos 2005): cho phép khp các mô hình hi quy cho nhiu h phân phi khác nhau, bao gm Gamma. Th vin broom (D. R. et al. 2023): cho phép thao tác trên kt qu mô hình hi quy gamlss. Th vin marginaleffects (Vincent Arel-Bundock 2023): dùng cho phân tích hu kim (post-hoc analysis) trên kt qu mô hình hi quy gamlss 2.4 Chun b d liu D liu c lu  nh dng .csv vi du ngn cách là ; và du thp phân là . Ta dùng hàm read.csv  ti d liu vào R và lu trong dataframe df. Dùng hàm na.omit()  loi b nhng n v quan sát b thiu sót d liu (missing value) Chuyn Protocol t 1 bin kiu kí t (character) thành factor,  tng thích vi quy trình phân tích. D liu u vào có cu trúc gm 1 bin kt qu (LH) thuc loi nh lng liên tc (kiu d liu double, numeric, int) và 1 bin phân nhóm (Protocol) thuc loi nh tính ri rc (nh dng character hoc factor). Lu ý, phân phi Gamma có min xác nh là tp s thc dng R+, nên trong d liu, giá tr bin kt qu (LH) không c có giá tr &lt; 0 hoc = 0. Mt cách mc nh, bin ri rc loi factor s c phân cp theo th t alphabet, mi bc giá tr s tng ng vi s th t. Trong trng hp này, th t các loi protocol là: 1 = Fol_long (s c xem là nhóm tham chiu khi phân tích hi quy) 2 = GnRH_ant 3 = Lut_short 4 = Mild 5 = PPOS ## [1] &quot;Fol_long&quot; &quot;GnRH_ant&quot; &quot;Lut_short&quot; &quot;Mild&quot; &quot;PPOS&quot; 2.5 K hoch phân tích Mt quy trình phân tích gm 4 bc s c tin hành nhm gii áp câu hi nghiên cu ã t ra: c tính phân b ca giá tr LH  5 nhóm phác  s c mô t bng trung bình,  lch chun, trung v và bách phân v 5-95, ng thi trình bày trc quan bng biu  mt  phân b (Kernel density plot) hoc Boxplot, violin plot. D liu LH s c khp ln lt vi 2 quy lut phân phi Gamma và Gaussian, sau ó i chiu  th hàm PDF và CDF  xác nhn tính phù hp tt hn ca phân phi Gamma so vi Gaussian. Mô hình hi quy tuyn tính tng quát vi phân phi Gamma s c áp dng  kho sát giá tr trung bình LH gia 5 phác . Hu kim so sánh bt cp tun t nhm kim tra mt lot gi nh v s khác bit ca giá tr LH gia các nhóm phác . Suy din thng kê da trên kim nh gi thuyt vô hiu vi ngng ý ngha thng kê p = 0.05. Hiu chnh Bonferroni c áp dng khi kim tra hàng lot gi nh. 2.6 Phân tích mô t Mc tiêu ca công on này nhm thm dò và mô t s khi v c tính phân phi ca LH gia các nhóm phác  khác nhau. Nhn nh rút ra t phân tích mô t này cho phép t ra nhng gi thuyt cn chng minh và  xut hng phân tích phù hp. 1) Dng bng thng kê mô t Ta s dng hàm group_by ca th vin dplyr  phân chia d liu thành 5 phn, tng ng 5 bc giá tr ca bin Protocol Áp dng hàm summarize ca th vin dplyr  tính mean, sd, median, p5, p95, min và max ca LH cho mi nhóm nh Dùng hàm arrange ca dplyr  xp th t theo giá tr trung bình LH tng dn Kt qu nh sau: Theo kt qu này, có s khác bit v giá tr LH trung bình gia 5 phác . Mt cách c th, LH trung bình có khuynh hng tng dn theo th t: Fol_long &lt; Short &lt; PPOS &lt; GnRH_ant &lt; Mild 2) So sánh trc quan bng biu  Ta s s dng 2 loi biu  cho phép so sánh c im phân b ca LH gia 5 phác , ó là biu  mt  phân phi 1 chiu (density plot) hoc biu  hp (boxplot). u tiên, ta to dataframe med_df trình bày giá tr trung bình ca LH gia 5 phân nhóm, s dng kt hp 2 hàm group_by và summarize_at. Dataframe này s c dùng  v biu  tuyn kí và nh v trung bình LH cho mi nhóm. Tip theo, ta ln lt dùng các hàm: geom_density_ridges (data = df)  v 5 biu  density plot cho LH  5 nhóm, màu nn theo nhóm phác . Lu ý rng hàm geom_density_ridges mc nh trc x = bin nh lng, y = phân nhóm. geom_path cho med_df  v biu  tuyn kí ni các im giá tr LH trung bình; geom_point cho med_df  chm 5 im giá tr LH trung bình Lu ý rng trc X luôn là LH, y luôn là Protocol cho 3 hàm trên Sau ó, dùng hàm coord_flip()  xoay trc 90°, nh vy trc x và y s hoán chuyn cho nhau, hình nh s biu din theo chiu dc thay vì chiu ngang. Hàm scale_x_continuous cho phép tùy chnh thang o trc X,  ây gii hn limits t -0.5 n 40, mc thang o 5 on v Kt qu thu c là 5 biu  mt  phân b nh trong hình. Các biu  này có bn cht là  th hàm probability desity (PDF) ca bin LH, trc Y tng ng vi thang o ca LH). Chúng mô t c tính phân phi ca LH trong 5 nhóm phác  (trc X). Các chm màu en tng ng vi giá tr trung bình LH  mi nhóm, c ni vi nhau bng các on thng th hin khuynh hng tng/gim ca giá tr này. Lu ý rng th t phân nhóm c xp theo chiu tng dn ca LH trung bình. Da vào hình nh này, ta có th rút ra c hai thông tin: th nht, có s khác bit rõ nét, không ch v giá tr trung bình nhng còn v c tính phân phi ca LH, thí d  phân tán,  lch gia 5 nhóm. Th hai là  mi phân nhóm, LH chc chn không th phù hp vi quy lut phân phi chun (Gaussian). Phân phi ca LH không i xng, thm chí có  lch rt cao  các nhóm GnRh_ant, Mild và PPOS. Ta có th làm tng t  to ra biu  boxplot, ch cn thay hàm geom_density_ridges bng hàm geom_boxplot. Lu ý rng vi dng biu  boxplot mc nh thì trc x ch Protocol, còn trc y cho LH, ta vn dùng hàm coord_flip()  xoay trc, trình bày theo phng ngang, vì kh nng so sánh bng th giác s tt hn theo chiu ngang so vi chiu dc. Biu  boxplot trình bày các tr s thng kê mô t i din gm trung v, t phân v (phân v th 25, 50, 75), các chm tròn nh là nhng giá tr vt ra khi khong t phân v. Chm màu en ln nht là v trí ca trung bình. Tuy không mô t hình nh ca toàn th mt  phân phi, biu  Boxplot va   cho ta thy cùng nhng thông tin v s tng phn rõ nét gia 5 phân nhóm, ta cng cm nhn c LH không có phân phi chun (trung v không trùng vi trung bình, 2 u boxplot không cân xng, nhng giá tr cao lch hn v chiu dng ca thang o LH). 2.7 Bin lun v tính phù hp ca phân phi Gamma Mc tiêu ca công on này nhm chng minh rng  c lng giá tr LH thì phân phi Gamma phù hp hn so vi phân phi Gaussian. iu này có th cn thit khi bn phi thuyt phc nhng ng nghip khác trong nhóm nghiên cu v la chn phng pháp ca mình. Ni dung này cng có th c a vào phn ph lc (Supplemental data) trong bài báo khoa hc. V mt lý thuyt, ta hoàn toàn có th chn quy lut phân phi Gamma cho bin LH vì nhng lý do sau: Thang o LH có giá tr &gt;0, phân phi ca LH có hình nh bt i xng và lch dng. Tuy nhiên, ta có th da vào chng c xác thc hn bng quy trình sau: u tiên, ta dùng hàm fitfist  ln lt khp d liu LH vi 2 quy lut phân phi Gaussian và Gamma, Sau ó i chiu hình nh  th hàm PDF và CDF so vi d liu thc nghim, bng 2 hàm denscomp và cdfcomp: Chú thích: Biu  trên cho phép i chiu  th hàm PDF (mt  xác sut) ca 2 phân phi Gaussian (màu xanh), Gamma (màu ) vi hình nh biu  tn sut trên thc nghim (màu xám). Chú thích: Biu  trên cho phép i chiu  th hàm CDF (mt  xác sut tích ly) ca 2 phân phi Gaussian (màu xanh), Gamma (màu ) vi hàm CDF trên thc nghim (màu xám). C 2 kt qu này u cho thy phân phi Gamma thích hp hn so vi phân phi Gaussian  c lng giá tr LH, vì hàm PDF và CDF ca phân phi Gamma phù hp hn vi d liu thc nghim. Li ích ca vic chn quy lut phân phi úng cho bin kt qu mô hình hi quy, ó là nó cho phép c lng và suy lun thng kê chính xác hn, phù hp thc t hn. Vì suy lun thng kê ca chúng ta da vào mô hình hi quy, mà mô hình này nhm c lng giá tr trung bình ca LH ti mi phân nhóm, v trí trung bình ca phân phi Gamma và Gaussian có th khác nhau dn n kt qu hiu ng tìm c cao hn hay thp hn so vi thc t. Ngoài ra, phân phi Gaussian không có gii hn v giá tr bin kt qu (nó dao ng t do trong tp R), nên mô hình hoàn toàn có th cho ra kt qu &lt;0 là trái vi hin thc. 2.8 Dng mô hình hi quy vi phân phi Gamma Nh ã trình bày trong k hoch phân tích, công c thng kê chính mà ta s dng là mt mô hình hi quy tuyn tính tng quát (GLM) (Nelder and Wedderburn 1972). H thng mô hình GLM do 2 nhà thng kê John Nelder và Robert Wedderburn thit lp vào nm 1972 cho phép c lng giá tr ca bin kt qu theo nhiu quy lut phân phi a dng. Mt cách tng quát, mô hình GLM c lng giá tr trung bình (tham s \\(\\mu\\)) ca bin ngu nhiên Y, iu kin hóa theo mt tp bin X thông qua mt hàm liên kt \\(g\\) và mt mô hình hi tuyn tính \\(X\\beta\\). \\[E(Y|X) = \\mu_{Y} \\sim g^{-1}(X\\beta)\\] Trong bài toán hin thi, bin kt qu Y là giá tr ca LH ngày trigger, c gi nh là mt bin ngu nhiên theo quy lut phân phi Gamma (Robert A. Rigby 2020) vi 2 tham s \\(\\mu\\) và \\(\\sigma\\) Hàm mt  phân phi (PDF) ca phân phi Gamma c xác nh nh sau: \\[f(y|\\mu ,\\sigma)=\\frac{1}{\\left ( \\sigma ^{2} \\mu \\right )^{1/\\sigma^{2}}}\\frac{y^{\\frac{1}{\\sigma ^{2}}-1}e^{-y/(\\sigma ^{2}\\mu )}}{\\Gamma \\left ( 1/\\sigma^{2} \\right )}\\] \\(\\mu\\) có ý ngha nh trng tâm (central tendency) hay giá tr trung bình ca bin kt qu cn c lng, còn giá tr ca \\(\\sigma\\) tng ng vi mc  phân tán và xác nh hình nh ca hàm mt  phân phi. Mt khi có mu và sigma, có th c tính  lch chun (và phng sai) ca LH theo công thc: \\[SD = \\sigma * \\mu\\] Phân tích hi quy Gamma dùng th vin gamlss (Stasinopoulos 2017). u tiên, ta khp mt mô hình hi quy Gamma ch cha Intercept. Mô hình này tng ng vi vic c lng giá tr trung bình ca LH cho toàn b mu kho sát, không phân bit nhóm phác  nào. Ta dùng hàm gamlss, vi công thc formula = LH ~ 1, và family = GA Ta s dùng mô hình c bn này  làm tham chiu và so sánh vi mô hình chính trong phân tích, nhm chng minh rng yu t chia nhóm theo phác  thc s có nh hng n giá tr trung bình LH. Ni dung mô hình c bn (ch cha Intercept, c lng LH trung bình cho toàn qun th) có ni dung nh sau: ## ****************************************************************** ## Family: c(&quot;GA&quot;, &quot;Gamma&quot;) ## ## Call: gamlss(formula = LH ~ 1, family = GA, data = df, trace = F, ## parallel = &quot;multicore&quot;, ncpus = nC) ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: log ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 1.49042 0.03189 46.73 &lt;2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## Sigma link function: log ## Sigma Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.01101 0.01960 0.561 0.575 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 1005 ## Degrees of Freedom for the fit: 2 ## Residual Deg. of Freedom: 1003 ## at cycle: 2 ## ## Global Deviance: 5005.425 ## AIC: 5009.425 ## SBC: 5019.251 ## ****************************************************************** gamlss dng 2 mô hình hi quy riêng cho \\(\\mu\\) và \\(\\sigma\\), c 2 mô hình u s dng hàm liên kt là logarit, vì vy thang o ca các h s hi quy hin thi là log(LH),  a v thang o nguyên thy (mUI/mL) ta phi dùng hàm exponential. Mô hình th nht cho bit giá tr trung bình ca LH cho toàn qun th \\(\\mu = exp(1.49042) = 4.438959\\) Ta có th i chiu vi kt qu c lng t d liu thc nghim, và thy rng Intercept ca mô hình m0 c bn rt phù hp vi giá tr trung bình ca LH ## [1] 4.438955 Tip theo, ta dng mt mô hình khác vi 1 bin c lp là phân nhóm Protocol. Mô hình này cho phép c lng giá tr trung bình LH  5 phân nhóm Protocol khác nhau, hay nói cách khác, kho sát liên h gia bin protocol và giá tr trung bình LH (hay hiu ng ca Protocol i vi giá tr trung bình ca LH). \\[\\mu_{LH} \\sim \\beta_0*Long + \\beta_1*GnRHant + \\beta_2*Short + \\beta_3*Mild + \\beta_4*PPOS\\] Mô hình này có công thc cho tham s chính (trung bình ca phân phi Gamma) là LH ~ Protocol; và cho tham s sigma: sigma.formula = ~ Protocol.  ây ta c lng ng thi c 2 tham s ca phân phi Gamma là mu (trung bình) và sigma (tham s kiu hình) theo bin Protocol. Vì ta không ch quan tâm n vic Protocol s làm thay i giá tr trung bình LH (trng tâm ca phân phi Gamma, tham s \\(\\mu\\)), mà còn mun bit liu phân loi Protocol có tác ng gây thay i hình nh ( phân tán,  lch) ca phân phi Gamma (tham s \\(\\sigma\\)) hay không ? Ni dung ca mô hình chính (c lng LH theo phác ) có ni dung nh sau ## ****************************************************************** ## Family: c(&quot;GA&quot;, &quot;Gamma&quot;) ## ## Call: gamlss(formula = LH ~ Protocol, sigma.formula = ~Protocol, ## family = GA, data = df, trace = F, parallel = &quot;multicore&quot;, ncpus = nC) ## ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: log ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.31235 0.05756 5.426 7.23e-08 *** ## ProtocolGnRH_ant 1.73978 0.07409 23.481 &lt; 2e-16 *** ## ProtocolLut_short 0.60523 0.06878 8.800 &lt; 2e-16 *** ## ProtocolMild 2.17429 0.09639 22.556 &lt; 2e-16 *** ## ProtocolPPOS 0.98292 0.08235 11.935 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## Sigma link function: log ## Sigma Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.07264 0.03903 -1.861 0.063003 . ## ProtocolGnRH_ant -0.24182 0.05717 -4.230 2.56e-05 *** ## ProtocolLut_short -0.51025 0.05988 -8.521 &lt; 2e-16 *** ## ProtocolMild -0.32842 0.08573 -3.831 0.000136 *** ## ProtocolPPOS -0.10027 0.05946 -1.686 0.092072 . ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 1005 ## Degrees of Freedom for the fit: 10 ## Residual Deg. of Freedom: 995 ## at cycle: 2 ## ## Global Deviance: 4275.111 ## AIC: 4295.111 ## SBC: 4344.238 ## ****************************************************************** Mô hình m1 này cho phép c lng giá tr trung bình ca LH  mi phân nhóm Protocol. Lu ý rng phác  Fol_long c chn làm tham chiu, vì vy Intercept trong mô hình tng ng vi trung bình ca log(LH) trong phân nhóm Protocol = Fol_long. Ta có th i chiu vi kt qu thng kê mô t ban u: exp(Intercept) tng ng vi trung bình ca LH trong phác  Follicular long acting, n v mUI/mL: \\(exp(0.31235) = 1.366633\\), ta thy giá tr này tng ng vi kt qu mean LH  nhóm Fol_Long Giá tr trung bình LH nhóm GnRH_ant c tính bng : exp(Intercept + ProtocolGnRH_ant): \\(exp(0.31235 + 1.73978) = 7.784464\\)  C th, ta có th c lng c trung bình ca log(LH) hoc LH  c 5 phân nhóm. 2.9 Suy din thng kê t mô hình GLM-Gamma Da vào 2 mô hình tuyn tính tng quát này, ta có th thc hin mt s suy din thng kê nh sau: u tiên, khi so sánh mô hình ch cha intercept và mô hình có thêm bin Protocol bng mt kim nh Likelihood ratio, ta có th bit liu phân nhóm phác  thc s có hiu ng ý ngha i vi LH hay không ? (câu hi này tng t vi kim nh F theo Fisher trong phân tích phng sai c in) ## Likelihood Ratio Test for nested GAMLSS models. ## (No check whether the models are nested is performed). ## ## Null model: deviance= 5005.425 with 2 deg. of freedom ## Altenative model: deviance= 4275.111 with 10 deg. of freedom ## ## LRT = 730.3143 with 8 deg. of freedom and p-value= 0 Kt qu cho ra mt giá tr p cc kì thp, nh vy ta có th khng nh rng phân nhóm phác  thc s có tác ng làm thay i LH. Nói cách khác, có s khác bit ý ngha v giá tr LH gia các nhóm phác  khác nhau. Tuy nhiên ta cha th bit rõ s khác bit này là  nhóm nào so vi nhóm nào. Ni dung h s hi quy trong mô hình cho phép ta kim nh v s khác bit ca LH trung bình  phác  PPOS, GnRH, Luteal short acting và Mild (Letrozole) so vi nhóm tham chiu là Follicular long acting. Da vào kt qu thô ca mô hình, có th thy tt c h s hi quy u &gt;0 và có ý ngha thng kê, cho thy giá tr trung bình LH  4 phác  còn li u cao hn so vi phác  tham chiu (Longacting). Tuy nhiên, ta s không suy din trc tip da vào h s hi quy, mà tin hành mt phân tích hu kim vi ni dung so sánh bt cp tun t gia 5 loi phác . Trong khi làm thng kê mô t, ta có cm nhn v khuynh hng tng dn ca giá tr LH trung bình theo th t: Fol_long &lt; Short &lt; PPOS &lt; GnRH_ant &lt; Mild  ây ta s kim tra li kt qu này.  tin hành phân tích hu kim, ta dùng hàm avg_comparisons ca th vin marginalseffect vi tùy chnh variables = list(Protocol = pairwise), sau ó hiu chnh giá tr p bng hàm p.adjust trong R, vi phng pháp hiu chnh Bonferroni. Kt qu ca hàm này là mt bng nh sau: Ct contrast trình bày các cp so sánh mà ta cn kim nghim, thí d GnRH_ant - Fol_long; Ct estimate trình bày giá tr khác bit trung bình v LH gia 2 nhóm phác , thí d GnRHant cao hn Long acting 6.4178 mUI/mL. 2 ct conf.low conf.high trình bày ngng di và trên khong tin cy 95% ca khác bit, KTC95% có ý ngha thng kê khi không cha giá tr 0. Ct adj_p trình bày giá tr p sau hiu chnh Bonferroni, Kt qu cho thy toàn b 10 gi thuyt u có ý ngha thng kê. Mt cách tng quát, giá tr LH trung bình tng dn theo th t 5 phác : Fol_long &lt; Short &lt; PPOS &lt; GnRH_ant &lt; Mild Nh vy phác  Mild stimulation vi Letrozole có LH trung bình ngày trigger cao nht, phác  Follicular long acting có LH trung bình thp nht, phác  PPOS  v trí trung gian, vi LH cao hn so vi 2 phác  Long và Short. Cui cùng, kt qu ca mô hình hi quy có th trình bày trc quan nh sau: Chú thích: Trên nn phân phi ca d liu thc t (biu  mt  và các im d liu), ta trình bày kt qu LH trung bình cho mi phân nhóm theo mô hình (chm tròn màu en là giá tr trung bình c lng, error bar tng ng vi KTC95% ca giá tr này). 2.10 Kt lun Qua thí nghim này, ta có th nhn ra rng mô hình GLM vi phân phi Gamma là mt gii pháp ph quát và thích hp cho mi tình hung so sánh bin nh lng gia nhiu phân nhóm trong nghiên cu y hc lâm sàng. 2.11 Thông ip rút gn làm hành trang Các i lng y sinh hc thng có giá tr dng và có phân phi lch, nên quy lut phân phi Gamma s phù hp hn so vi phân phi Gaussian. Mô hình GLM hiu qu hn nhiu và có th thay th hoàn toàn các công c c in nh kim nh t, phân tích phng sai (ANOVA) và c mô hình hi quy tuyn tính thông thng. References "],["mô-t-d-liu-a-bin-phân-tích-nhân-t-chính-pca.html", "Chng 3 Mô t d liu a bin: Phân tích nhân t chính (PCA) 3.1 Gii thiu 3.2 Bi cnh ca thí nghim 3.3 Công c cn thit 3.4 Xác nh s thành phn chính ti u 3.5 Phân tích PCA 3.6 Trình bày kt qu PCA bng biu  Biplot 3.7 Phân tích vai trò ca mi bin trong 2 thành phn chính 3.8 Kho sát c tính phân phi ca mi thành phn chính 3.9 Kt lun 3.10 Thông ip rút gn làm hành trang", " Chng 3 Mô t d liu a bin: Phân tích nhân t chính (PCA) Biên son: Lê Ngc Kh Nhi, Dng Th Ngc Châu 3.1 Gii thiu Vi chuyên  h tr sinh sn, ngoài mc tiêu ánh giá hiu qu ca can thip iu tr nh ã làm trong nhng chng trc, ta còn quan tâm n tình trng bt thng v gii phu, sinh lý ni tit, chc nng sinh sn góp phn gây ra tình trng him mun, nh hng n kh nng thành công ca can thip hoc kt cc ca thai kì sau can thip, nh hi chng bung trng a nang (PCOS), ri lon chuyn hóa glucose, suy gim d tr bung trng, nguy c tai bin sn khoa Các thc th bnh lý này có th biu hin qua s thay i giá tr ca nhiu thông s xét nghim sinh lý, sinh hóa, gii phu bnh, hình nh hc   iu kin c bn, trong chu k h tr sinh sn hoc trong thai kì. Nh mi chuyên khoa khác, Sn Ph khoa và lnh vc h tr sinh sn cng có nhng nghiên cu vi mc tiêu mô t, vi i tng nghiên cu là các c im sinh lý bnh hc ca qun th bnh nhân, hoc  mc  sinh hc phân t, c kho sát bng tp hp nhiu bin s nh lng. Thông thng, khi thc hin thng kê mô t cho bin nh lng, ta ch xét tng bin riêng l (phân tích n bin), thí d nh trong chng 1, ta ã c lng trung bình, trung v,  phân tán cho riêng bin LH. Bây gi ta hãy hình dung v mt bng s liu mà mi hàng tng ng vi 1 cá th bnh nhân, và mi ct tng ng vi mt thông s (bin). Nu ta có 1 d liu gm N bnh nhân và K bin, vi kích thc N và K lên n hàng trm, thm chí hàng ngàn, ó là mt không gian d liu nhiu chiu vt ra khi kh nng phân tích bình thng. Trong chng này, chúng ta cùng tìm hiu v phân tích nhân t chính (PCA) (Husson, Le, and Pagès 2017) là mt phng pháp cho phép xác nh mt góc  quan sát ti u ni dung d liu a chiu. PCA còn có công dng rút gn và gin lc d liu: T d liu u vào gm rt nhiu bin s và n v quan sát, k thut PCA s gin lc cu trúc này xung ch còn mt vài nhân t chính (gi là chiu thông tin). 3.2 Bi cnh ca thí nghim Ta có tình hung nh sau: mt nhóm nghiên cu mun kho sát v c tính và cu trúc tng quan gia 15 thông s lâm sàng trong 3 phân nhóm lâm sàng khác nhau: nhóm ph n bình thng (Normal), nhóm ph n có hi chng bung trng a nang (PCOS), và nhóm va có hi chng bung trng a nang va kèm ri lon kháng insulin (Insuline resistance - IR). 3.3 Công c cn thit Quy trình cn nhng th vin sau ây: H sinh thái tidyverse  thc hin thao tác d liu và  ha (dplyr và ggplot2) Th vin FactoMineR(Lê, Josse, and Husson 2008) và factoextra(Kassambara 2020) cho phân tích PCA Th vin GGally(B. S. et al. 2021)  v mt ma trn biu  tán x, mt  phân phi và 2D density plot cho d liu a bin patchwork (Pedersen 2022):  thit k b cc khi ghép ni nhiu biu  ggplot D liu u vào cho phân tích PCA, có cu trúc a bin. Trong thí d này, ta có dataset PCOS_IR.csv vi 15 bin nh lng và 1 bin phân nhóm (PCOS, Normal và Insuline resistance - IR). Lu ý là PCA ch áp dng cho bin s nh lng. Tp hp 15 thông s cn phân tích bao gm: tui ca bnh nhân (Age), ch s BMI, kt qu nh lng các loi hormones: AMH: (Anti-Müllerian Hormone), E2 (Estrogen), FSH (Follicle-Stimulating Hormone), LH (Luteinizing hormone), P (Progesterone hormone), PRL (prolactin hormone), T (Testosterone hormone), TSH (thyroid stimulating hormone), các ch s: AFC (antral follicle count), OSI (ovarian sensitivity index), kt qu insulin fasting blood test (F_INS), ng huyt (Gluc) và HOMA-IR (Homeostatic Model Assessment for Insulin Resistance). Vi mt không gian d liu a chiu (có quá nhiu bin s) nh hin thi, rt khó  kho sát toàn din v c im phân phi và mi liên h gia các bin. Thí d nu ta mun kho sát trc quan bng biu  thng kê, ta cng ch có ít la chn: hoc kho sát riêng l tng bin (không gian 1 chiu) bng biu  Density plot (ng chéo trong hình bên di), hoc kho sát kt hp tng cp 2 bin bng biu  2D density plot hoc biu  tán x trong không gian 2 chiu (na di và na trên trong hình). Theo cách này, ta cng ch có th mô t n mc cao nht là không gian d liu 3 chiu, ây cng là gii hn cao nht ca kh nng tng tng ca con ngi. Làm cách nào  có th quan sát toàn b không gian d liu to ra bi 15 bin x 524 cá th bnh nhân ? K thut PCA là gii pháp cho câu hi này. Phân tích PCA có công dng gin lc cu trúc d liu a chiu thành mt tp hp bin nhân to có ý ngha i din, gi là thành phn chính hay chiu thông tin. 3.4 Xác nh s thành phn chính ti u u tiên, ta càn xác nh s lng thành phn chính thp nht mà vn cho phép trình bày c nhiu thông tin nht t không gian d liu ban u. Ta làm iu này da vào biu  Screeplot, biu  này trình bày quan h gia t l phng sai có th gii thích c và s thành phn chính.  dng biu  scree plot, ta làm tng bc nh sau: u tiên, to ma trn hip phng sai (covariance matrix) bng hàm cov Tính eigen values t covariance matrix Tính PVE = proportion of variance explained, là t l gia vector eigen values và tng ca vector eigen values Dùng hàm qplot  v 2 biu  screeplot, trc x ch s thành phn chính t 1 n cao nht (toàn b bin s trong dataframe ban u), trc Y là giá tr PVE, hoc PVE tích ly (bng hàm cumsum) Din gii biu  screeplot: Ta thy ch cn 6 thành phn chính là có th ti c n 98% phng sai (gn nh toàn b thông tin) trong d liu gc. 3.5 Phân tích PCA Phân tích PCA c thc hin n gin bng hàm PCA, d liu u vào là 1 dataframe cha toàn bin kiu s (numeric, double hoc int), các tham s tùy chnh bao gm: ncp = s thành phn chính (ta chn giá tr = 6) scale.unit = T: d liu c chun hóa (standardize) trc, công on này m bo các bin có cùng thang o, n v o. graph = F: ta không mun xut ra ngay biu  kt qu Kt qu ca hàm PCA là mt i tng cha nhiu thông tin bên trong, có th tóm tt bng hàm summary 3.6 Trình bày kt qu PCA bng biu  Biplot Kt qu ca phân tích PCA có th tóm tt bng biu  Biplot, còn gi là biu  ti lng thông tin (loading plot). Biu  ti lng thông tin trình bày hình chiu ca các eigen vectors (15 bin) lên mt phng 2 chiu to ra bi 2 vector thành phn chính u tiên (Components 1 và 2). Trên biu  này, ta có th kt hp thêm 1 lp biu  tán x (scatter plot)  hin th ta  các n v d liu (524 bnh nhân) hoc 1 lp biu  mt  phân phi 2 chiu (2D density plot)  so sánh tng phn v phân phi gia 3 phân nhóm lâm sàng IR, Normal và PCOS Ta thc hin ln lt các bc nh sau: Chun b ph màu pal_fill cho 3 nhóm Chun b mt hàm h tr, cho phép dùng du -  chèn 1 lp biu  ggplot nm phía sau/bên di biu  hin hành (mc nh dùng du +  chèn lên phía trên) Dng biu  biplot c bn bng hàm fviz_pca_biplot Ln lt chèn thêm 1 lp biu  tán x bng hàm geom_jitter và 1 lp biu  density 2 chiu bng hàm stat_density2d; sau ó dùng ph màu ã xác nh. Cách din gii biu  biplot: Trc X và Y ln lt trình bày thang o ca 2 thành phn chính/chiu thông tin u tiên (Dim 1 và Dim 2) Các mi tên i din cho nhng bin s trong d liu, gi là eigen vectors Hng ca vector cho bit 1 bin tng quan thun hay nghch vi chiu thông tin  trc X hoc Y,  dài vector cho bit bin này óng góp thông tin nhiu hay ít vào Dim 1 và Dim 2 (khi chiu lên Dim 1 và Dim 2). Góc to ra gia 2 vector cho bit chiu tng quan thun hay nghch gia 2 bin, gia 2 bin tng quan thun nu cùng hng và to ra góc nhn, tng quan nghch nu ngc hng, và không tng quan nu góc = 90°. Nhng bin tng quan mnh vi nhau s gom li thành cm, cùng ch v mt hng, thm chí trùng nhau. Thí d: HOMA_IR và Fasting Insuline tng quan vi nhau, LH, AMH, AFC, E2 tng quan thun vi nhau và tng quan nghch vi Age, FSH, Fasting glucose, BMI và TSH tng quan thun vi nhau. V trí tng i gia ta  các vector và ta  các mng màu ca biu  mt  phân phi 2 chiu cho bit vai trò óng góp ca các bin cho phép phân lp gia các nhóm lâm sàng này. 3.7 Phân tích vai trò ca mi bin trong 2 thành phn chính Cui cùng, ta có th kho sát trc quan mc  óng góp (vai trò) ca nhng bin quan trng nht vào 2 thành phn chính (PC1 và PC2), bng các bc sau: Áp dng hàm fviz_contrib cho object res.pca  dng biu  ct phân tích t l variance gii thích bi tng bin: Các tùy chnh bao gm: axes = th t thành phn cn kho sát ( ây ta kho sát PC1 và PC2) Lu mi biu  thành object riêng bit d1, d2 ri kt hp chúng li d1/d2 (theo chiu dc) hoc d1 + d2 (theo chiu ngang). 3.8 Kho sát c tính phân phi ca mi thành phn chính Ngoài công dng thm dò cu trúc d liu mt cách trc quan nh trên, các thành phn chính sinh ra t phân tích PCA có ý ngha nh bin nhân to, truyn ti nhng thông tin quan trng nht t tp hp nhiu bin ban u. Chúng có th c s dng nh bin tiên lng (predictor) trong nhng mô hình phân loi nhm phân lp các nhóm lâm sàng. Thông tin v giá tr các PC c lu trong ma trn coord ca kt qu PCA (res.pca), ta có th chuyn nó thành dataframe ri mô t, so sánh c tính phân phi ca 4 PC u tiên quan trng nht gia 3 phân nhóm lâm sàng IR, Norm và PCOS. ây là bng thng kê mô t cho phép so sánh giá tr 4 thành phn chính gia 3 phân nhóm: Kt qu này có th trình bày trc quan bng biu  sau Có th thy rng ch cn 2 thành phn chính (chiu thông tin) Dim1 và Dim2 là   phân bit gia 3 nhóm Norm, IR và PCOS mt cách hiu qu. 3.9 Kt lun PCA là mt k thut rt hiu qu cho mc tiêu thm dò d liu a bin, khi dùng PCA ta ch ra cách quan sát không gian d liu theo mt góc nhìn ti u nht, cho phép thu c nhiu thông tin có ích nht cho mc tiêu phân bit, kho sát tng quan, vai trò óng góp ca tng i lng lâm sàng. Dù mc tiêu nghiên cu ca chúng ta ch n gin là mô t c tính lâm sàng ca mt bnh lý, hay kho sát v mi liên h gia các thông s hin có, kho sát chuyên bit v vai trò mt k thut xét nghim mi, hay thit lp mt mô hình chn oán,  trong mi hoàn cnh, ta u có th khai thác nhiu thông tin t kt qu PCA. Li ích này càng tr nên rõ ràng hn khi d liu ca bn phc tp, có rt nhiu bin s, và ta cn nhanh chóng xác nh phng hng  bit s phi làm gì vi chúng. Biu  PCA truyn ti thông tin phong phú, cô ng và li rt p v tính m thut, có th dùng  trang trí cho Poster hi ngh, bài báo khoa hc. Khi thuyt trình, ch cn 1 slide vi biu  PCA, có th trình bày rt nhiu ý tng và thông tin. 3.10 Thông ip rút gn làm hành trang PCA là mt k thut phân tích d liu hiu qu vi 2 công dng chính: mô t cu trúc d liu a chiu và gin lc cu trúc d liu. References "],["kho-sát-kt-cc-s-m-hi-quy-negative-binomial.html", "Chng 4 Kho sát kt cc s m: Hi quy Negative Binomial 4.1 Gii thiu 4.2 Bi cnh ca thí nghim 4.3 K hoch phân tích 4.4 Công c cn thit 4.5 Thng kê mô t 4.6 Bin lun v tính phù hp ca quy lut phân phi NBI 4.7 Phân tích hi quy bng mô hình GLM NBI 4.8 Din t kt qu phân tích 4.9 Thông ip rút gn làm hành trang", " Chng 4 Kho sát kt cc s m: Hi quy Negative Binomial Biên son: Lê Ngc Kh Nhi, Dng Th Ngc Châu, Thân Trng Thch 4.1 Gii thiu Mt trong nhng im c áo ca nghiên cu v h tr sinh sn so vi nhng chuyên khoa y hc khác, ó là s xut hin ca kt cc có bn cht là s m. Thm chí, ây là loi kt cc chính trong quy trình th tinh nhân to hoc các chu kì kích thích bung trng, thí d: s lng noãn thu c, s noãn trng thành, s phôi Tuy nhiên chng trình thng kê  i hc và sau i hc cha bao gi  cp n phng pháp thng kê cho kt qu s m, vì vy trong các lun vn và báo cáo khoa hc, các ng nghip buc phi tn dng tt c nhng công c thô s khác mà h có trong tay nh kim nh t Student hay nhng kim nh phi tham s, ngay c khi chúng hoàn toàn không thich hp cho loi d liu này. Gii pháp hp lý nht cho phân tích kt cc s m là áp dng mô hình tuyn tính tng quát vi quy lut phân phi xác sut phù hp cho bin kt qu (Hilbe 2014), bao gm phân phi Binomial, Poisson, Negative binomial và nhiu bin th khác. Trong s này, phân phi Negative binomial thng là gii pháp ti u vì tính linh hot ca nó so vi phân phi Poisson. 4.2 Bi cnh ca thí nghim Trong chng này, ta s thc hin mt phân tích hi quy bng mô hình GLM vi phân phi Negative binomial cho 2 bài toán: (1) so sánh s lng noãn trung bình gia 4 phân nhóm c lp, và (2) Kho sát mi liên h gia s lng noãn và 3 bin s liên tc (Tui, AFC và AMH). Tình hung minh ha da trên b d liu thc nghim ca nhóm tác gi Sandro C. Esteves và cng s vào nm 2019, vi ni dung kim nghim mi liên h gia 3 i lng: Tui, AMH, AFC (n=1181), hoc khái quát hn là 4 nhóm áp ng kém bung trng theo h thng phân loi POSEIDON (n=881) và kt cc ca chu kì kích thích bung trng (s noãn thu c, s noãn MII). iu thú v, ó là bn thân công c ART calculator ca tác gi Sandro C. Esteves và nhóm POSEIDON (Patient-Oriented Strategies Encompassing IndividualizeD Oocyte Number) có bn cht là s kt hp ca 2 mô hình hi quy Negative Binomial và logistic. ây cng là trng hp him hoi trong y vn ngành h tr sinh sn mà phân phi xác sut Negative Binomial c vn dng  gii quyt câu hi nghiên cu lâm sàng. 4.3 K hoch phân tích Mô hình hi quy tuyn tính tng quát (GLM) vi phân phi Negative Binomial type I (NBI) Robert A. Rigby (2020) s c áp dng nhm kho sát mi liên h gia phân loi POSEIDON và s lng noãn thu c trong chu kì COS. Suy din thng kê da vào mean marginal effect và kim nh gi thuyt vô hiu vi ngng ý ngha p&lt;0.05 4.4 Công c cn thit Quy trình phân tích s s dng các th vin sau trong R: Th vin dplyr trong h sinh thái tidyverse(Wickham et al. 2019)  thao tác d liu và thng kê mô t Th vin fitdistrplus(Delignette-Muller and Dutang 2015)  i chiu 3 quy lut phân phi Gaussian, Poisson và NBI, nhm chng minh tính phù hp hn ca phân phi NBI. Th vin ggplot2, ggrides(Wilke 2022), tidybayes(Kay 2023b) và ggdist(Kay 2023a)  v mt s biu  thng kê; th vin patchwork  ghép các biu  vi nhau. Th vin gamlss(R. A. Rigby and Stasinopoulos 2005)  dng mô hình GLM vi phân phi NBI Th vin marginaleffects(Vincent Arel-Bundock 2023)  c tính avegrage marginal effect (AME) và suy din thng kê t kt qu mô hình. Th vin broom(D. R. et al. 2023) nhm trích xut d liu kt qu c lng t mô hình. u tiên, ta ti d liu t file POSEIDON_ART.csv vào R và lu trong dataframe df. Cho bài toán th nht (so sánh gia 4 loi POSEIDON), ta s loi tr nhng trng hp không th c xp vào bt c nhóm nào trong h thng phân loi POSEIDON (bin POSEIDON có giá tr = 0). Bin kt qu trong bài toán là s noãn thu c (Collected), kiu s nguyên (int). Bin c lp là POSEIDON là mt bin ri rc vi 4 bc giá tr 1,2,3,4. 4.5 Thng kê mô t Trc khi tin hành phân tích, ta s thm dò d liu. Cho bài toán th 1, ta s mô t c tính phân phi ca s noãn gia 4 phân nhóm POSEIDON nh sau: Kt qu này gi ý có s khác bit rõ v s noãn trung bình gia 3 nhóm 1,2 và 3 theo th t: 3 &lt; 1 &lt; 2; tuy nhiên gia nhóm 3 và 4 thì khác bit không rõ nét. Ta có th so sánh trc quan phân phi ca s noãn thu c gia 4 nhóm bng biu  tn sut (histogram) nh sau: Chú thích: Hình trên trình bày 4 biu  tn sut nhm so sánh phân phi ca s lng noãn (Trc Y) gia 4 nhóm POSEIDON (trc X). Cho bài toán th hai, ta to dataframe df2 cha toàn b 1181 trng hp, sau ó kho sát trc quan v mi liên h gia 3 bin Age, AFC và AMH và s noãn thu c bng biu  tán x kt hp vi  th mô hình hi quy tuyn tính n bin. Chú thích: Hình trên gm 3 biu  hi quy và tán x, kho sát mi liên h gia s noãn thu c (Trc Y) và 3 bin Age, AFC và AMH (Trc X). Mi im tròn biu th cho 1 n v quan sát, ng thng và bng màu trình bày giá tr trung bình và khong tin cy 95% ca mô hình hi quy tuyn tính n bin. D liu c phân chia thành 5 nhóm tng ng vi kt qu xp loi POSEIDON (0,1,2,3,4). Hình nh này gi ý v mt mi tng quan thun gia s noãn thu c và AFC cng nh AMH, ng nht  c 5 phân nhóm. tuy nhiên, tng quan gia s noãn và tui li không rõ nét và có s khác bit gia các nhóm POSEIDOn khác nhau. 4.6 Bin lun v tính phù hp ca quy lut phân phi NBI S lng noãn thu c là kt qu ca phép m. Thông thng, ta thng dùng phân phi Poisson cho s m, và mô hình hi quy c in thng da trên phân phi Gaussian. Ta s chng minh rng Negative Binomial là phân phi phù hp hn c so vi phân phi Gaussian và Poisson  c lng kt qu trong bài toán hin thi. Ta thc hin quy trình sau: u tiên, ta dùng hàm fitfist  ln lt khp d liu s noãn vi 3 quy lut phân phi Gaussian, Poisson và NBI, sau ó i chiu hình nh  th hàm PDF và CDF so vi d liu thc nghim, bng 2 hàm denscomp và cdfcomp: Chú thích: Hai biu  trên cho phép i chiu  th hàm CDF (mt  xác sut tích ly, hình trên) và hàm PDF (mt  xác sut, hình di) ca 2 phân phi Gaussian (màu xanh lc), NBI (màu ) và Poisson (màu xanh dng) vi hình nh  th hàm CDF và biu  tn sut trên thc nghim (màu xám). Kt qu này cho thy NBI là quy lut phân phi phù hp nht cho d liu hin thi. 4.7 Phân tích hi quy bng mô hình GLM NBI Tip theo, ta ln lt gii quyt 2 bài toán thng kê thông qua mô hình tuyn tính tng quát vi phân phi NBI (Hilbe 2011). Cho c 2 bài toán, ta cn mt mô hình cho phép c lng s noãn thu c nh 1 bin ngu nhiên Y theo phân phi Negative Binomial tùy thuc vào 4 nhóm POSEIDON (Bài toán 1) hoc các hip bin AFC, AMH, Age (Bài toán 2). Hàm mt  xác sut ca Y c xác nh bng 2 tham s \\(\\mu\\) và \\(\\sigma\\) \\[Pr(Y = y|\\mu,\\sigma) = \\frac{(+ \\frac{1}{\\sigma})}{(y + 1) (\\frac{1}{\\sigma})}(\\frac{\\mu\\sigma }{1 + \\mu\\sigma})^{y}(\\frac{1}{1 + \\mu\\sigma})^{1/\\sigma}\\] Vi tp xác nh \\(Y \\in \\left\\{0,1,2,3...\\right\\}\\), tham s \\(\\mu\\) tng ng vi giá tr trung bình ca Y: \\(0 &lt; \\mu &lt; \\infty\\) và tham s \\(\\sigma\\) ch mc  phân tán: \\(0 &lt; \\sigma &lt; \\infty\\) Phng sai (variance) ca Y có th tính t \\(\\mu\\) và \\(\\sigma\\) theo công thc: \\[var(Y) = \\mu + \\sigma\\mu^{2}\\] Th vin gamlss cho phép chúng ta dng mô hình tuyn tính cho c 2 tham s vi hàm liên kt logarit, tuy nhiên suy din thng kê ch tp trung vào giá tr trung bình (tham s \\(\\mu\\)) Mô hình GLM cho tham s \\(\\mu\\) có công thc tng quát nh sau: \\[log( ) = _0+_1 _1+_2 _2+  +_ _\\] Vi bài toán th nht, mô hình hi quy mod_1 trong gamlss có công thc : Collected ~ POSEIDON, family = NBI(). ## GAMLSS-RS iteration 1: Global Deviance = 5042.705 ## GAMLSS-RS iteration 2: Global Deviance = 5042.705 Kt qu ca mô hình mod_1 nh sau: ## ****************************************************************** ## Family: c(&quot;NBI&quot;, &quot;Negative Binomial type I&quot;) ## ## Call: gamlss(formula = Collected ~ POSEIDON, sigma.formula = ~POSEIDON, ## family = NBI(), data = df) ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: log ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 2.06132 0.07281 28.309 &lt; 2e-16 *** ## POSEIDON2 0.47583 0.07722 6.162 1.09e-09 *** ## POSEIDON3 -0.70893 0.10837 -6.542 1.03e-10 *** ## POSEIDON4 -0.90001 0.08458 -10.640 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## Sigma link function: log ## Sigma Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -0.2291 0.1175 -1.950 0.0515 . ## POSEIDON2 -1.3495 0.1486 -9.081 &lt;2e-16 *** ## POSEIDON3 -0.6438 0.2580 -2.495 0.0128 * ## POSEIDON4 -6.0544 17.3878 -0.348 0.7278 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 881 ## Degrees of Freedom for the fit: 8 ## Residual Deg. of Freedom: 873 ## at cycle: 2 ## ## Global Deviance: 5042.705 ## AIC: 5058.705 ## SBC: 5096.954 ## ****************************************************************** Din gii kt qu mô hình (Intercept) = 2.06132 là giá tr trung bình ca s noãn thu c  nhóm tham chiu (POSEIDON = 1)  thang o logarit, ta có th chuyn v thang o s m bng hàm exponential: \\(exp(2.06132) = 7.856333\\), giá tr này rt phù hp vi kt qu thng kê mô t trên d liu thc nghim. Các h s hi quy POSEIDON2, POSEIDON3 và POSEIDON4 tng ng vi s thay i ca log(s noãn)  3 nhóm POSEIDON 2,3,4 so vi nhóm tham chiu (1); Ta có th c tính s noãn trung bình  nhóm POSEIDON = 3 nh sau: \\(exp(2.06132 + -0.70893) = 3.866656\\), ta thy giá tr này cng tng ng vi kt qu mean ca nhóm POSEIDON 3. Mt giá tr h s hi quy &gt; 0 cho bit s noãn thu c trung bình (thang o logarit)  nhóm ó gia tng so vi nhóm tham chiu, thí d trong trng hp này Nhóm POSEIDON 2 có h s hi quy = 0.47583, cho thy nhóm POSEIDON 2 thu c nhiu noãn hn so vi nhóm POSEIDON 1. Ngc li, h s hi quy &lt; 0 cho thy s sút gim v s noãn thu c so vi nhóm tham chiu. Trong trng hp này, nhóm POSEIDON 4 có h s hi quy = -0.90001, gi ý rng s noãn thu c trung bình  nhóm POSEIDON 4 thp hn so vi nhóm 1. Pr(&gt;|t|) trình bày giá tr p ca kim nh gi thuyt vô hiu là h s hi quy = 0 (không có khác bit so vi nhóm tham chiu, hiu ng ca nhóm POSEIDON ó = 0). Trong thí d này, c 3 s khác bit  nhóm 2,3,4 so vi nhóm 1 u có ý ngha thng kê (p&lt;0.001). Da vào mô hình này, ta có th tin hành mt phân tích hu kim (post-hoc) nhm so sánh bt cp tun t s noãn trung bình gia 4 nhóm POSEIDON. Quy trình này c thc hin vi hàm avg_comparisons ca package marginaleffects, vi tùy chnh variables = list(POSEIDON = pairwise) Kt qu phân tích nh sau: Trong bng này, ct estimate trình bày khác bit v s noãn trung bình gia 2 nhóm POSEIDON bt kì (ct contrast), 2 ct conf.low và conf.high trình bày KTC95% ca khác bit này. Ct adj_p trình bày giá tr p hiu chnh bng phng pháp Bonferroni. Theo kt qu này, s khác bit gia các nhóm v s noãn trung bình to ra th t sau: nhóm 3 và 4 là thp nht, nhóm 2 là cao nht và nhóm 1/2 cao hn nhóm 3/4, nhng khác bit này u có ý ngha thng kê. Tuy nhiên không có khác bit ý ngha gia 2 nhóm 3 và 4. Ta có th trình bày trc quan giá tr marginal effect ca 4 nhóm nh sau: Cho bài toán th hai, ta dng mt mô hình GLM NBI vi công thc: Collected ~ Age + AMH + AFC trên toàn b 1181 n v d liu. Ni dung mô hình nh sau: ## GAMLSS-RS iteration 1: Global Deviance = 6287.472 ## GAMLSS-RS iteration 2: Global Deviance = 6275.722 ## GAMLSS-RS iteration 3: Global Deviance = 6274.446 ## GAMLSS-RS iteration 4: Global Deviance = 6274.216 ## GAMLSS-RS iteration 5: Global Deviance = 6274.171 ## GAMLSS-RS iteration 6: Global Deviance = 6274.16 ## GAMLSS-RS iteration 7: Global Deviance = 6274.159 ## GAMLSS-RS iteration 8: Global Deviance = 6274.158 ## ****************************************************************** ## Family: c(&quot;NBI&quot;, &quot;Negative Binomial type I&quot;) ## ## Call: gamlss(formula = Collected ~ Age + AMH + AFC, sigma.formula = ~Age + ## AMH + AFC, family = NBI(), data = df2) ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: log ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.79387 0.16361 4.852 1.39e-06 *** ## Age 0.01120 0.00401 2.794 0.00529 ** ## AMH 0.07073 0.01012 6.992 4.55e-12 *** ## AFC 0.07145 0.00409 17.469 &lt; 2e-16 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## Sigma link function: log ## Sigma Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 3.63405 0.70022 5.190 2.48e-07 *** ## Age -0.17252 0.02032 -8.491 &lt; 2e-16 *** ## AMH 0.03986 0.03632 1.097 0.273 ## AFC 0.05028 0.01104 4.552 5.86e-06 *** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 1181 ## Degrees of Freedom for the fit: 8 ## Residual Deg. of Freedom: 1173 ## at cycle: 8 ## ## Global Deviance: 6274.158 ## AIC: 6290.158 ## SBC: 6330.751 ## ****************************************************************** (Intercept) trình bày giá tr log(s noãn trung bình)  iu kin tham chiu, khi Age, AFC và AMH  v trí trung bình trong qun th. Các h s hi quy cho Age, AFC và AMH cho bit log(s noãn trung bình) s tng/gim bao nhiêu n v khi Age, AFC và AMH tng thêm 1 n v. Giá tr h s hi quy &gt; 0 biu th cho mi liên h t l thun (thí d cho AMH và AFC: khi AMH và AFC gia tng thì s noãn thu c cng tng), giá tr h s hi quy &lt; 0 biu th cho quan h t l nghch, thí d cho Age: khi tui càng cao thì s noãn càng gim). C 3 mi liên h vi Age, AFC và AMH u có ý ngha thng kê. Vì h s hi quy ang  thang o logarit, nên ta có th dùng cùng cách tính marginal effect vi hàm avg_comparisons  suy lun thng kê d hiu hn  thang o gc: Theo kt qu này, s noãn trung bình s tng 0.724, 0.717 và 0.113 cho mi n v gia tng ca AMH, AFC và Tui, vi gi nh là các bin còn li không i. C 3 giá tr marginal effect cho Age, AFC và AMH u có ý ngha thng kê. Ta có th kho sát mt cách trc quan và riêng bit mi liên h gia Age, AFC và AMH vi s noãn thu c theo quy trình nh sau: u tiên, áp dng hàm predictions trên 1 d liu phn thc t (counterfactual) và iu kin hóa (conditioned) cho mt khong giá tr c th ca mi bin, thí d Age dao ng t 20 n 40, AFC t 1 n 10, AFC t 1 n 30. Dùng biu  tn sut (hàm stat_dotsinterval) và biu  hi quy (stat_lineribbon)  trình bày trc quan v s thay i ca s noãn tùy thuc vào các iu kin ta ã to ra  trên Kt qu cho thy tuy có tn ti liên h gia Age và s noãn, thc ra mi liên h này rt yu và không nh hng nhiu n kt cc v s noãn. Trong khi ó, hiu ng tác ng ca AMH i vi s noãn thu c là tng i áng k; thí d gia AMH=1 và AMH=5, thì s noãn trung bình ã khác bit khong 2.5 n v. Cui cùng, hiu ng ca AFC là mnh nht và có tính cht ly tin (s noãn thu c tng theo quy lut hàm m khi AFC gia tng), có th nói AFC chính là yu t quan trng nht quyt nh s noãn thu c. Ta cng có th kho sát hiu ng ca AFC theo các iu kin khác nhau, thí d nhóm tui nh trong biu  sau: 4.8 Din t kt qu phân tích Kt qu phân tích hi quy cho thy: có s khác bit ý ngha v s lng noãn thu c gia các nhóm POSEIDON. C th là nhóm 2 thu c nhiu noãn nht, nhóm 3 và 4 thu c ít noãn nht, không có s khác bit ý ngha gia kt cc nhóm 3 và 4. S lng noãn thu c t l thun vi Tui, AFC và AMH, trong ó AFC là yu t quan trng nht quyt nh kt qu ca chu kì kích thích bung trng, tip theo là AMH, trong khi Tui ch có vai trò ít quan trng hn. 4.9 Thông ip rút gn làm hành trang Trong nghiên cu h tr sinh sn, kt cc v s lng noãn hoc phôi có bn cht là s m và cn áp dng phng pháp thng kê thích hp.  c lng kt qu s m, ta có th dùng quy lut phân phi Poisson hoc Negative Binomial (NBI), trong ó NBI hp lý và chính xác hn. Mô hình tuyn tính tng quát vi phân phi NBI là gii pháp phù hp  suy din thng kê cho kt qu s m. References "],["phân-tích-mng-li-tng-quan.html", "Chng 5 Phân tích mng li tng quan 5.1 Gii thiu 5.2 Bi cnh thí nghim 5.3 Thm dò d liu 5.4 Ma trn tng quan 5.5 S  mng li tng quan 5.6 Phân tích cu trúc mng li tng quan 5.7 Yu t m thut 5.8 Thông ip rút gn làm hành trang", " Chng 5 Phân tích mng li tng quan Biên son: Lê Ngc Kh Nhi 5.1 Gii thiu ây là s tip ni câu chuyn v phân tích d liu a chiu mà ta ã  cp trong chng 2. Trong chng này ta s kho sát mi liên h gia các thông s nh lng - ây cng là mt bài toán thng kê thng gp trong nghiên cu y hc vi tên gi phân tích tng quan (correlation analysis). Phân tích tng quan có giá tr ng dng trong nhiu hoàn cnh, bao gm mô t v mi liên h gia các yu t trong thc th bnh lý, nhn din các quy lut sinh lý-bnh hc, phát hin nhng thông s xét nghim tim nng cho mc tiêu chn oán hoc tiên lng, xác nh nhng bin s quan trng  xây dng mô hình hi quy vi mc tiêu tiên lng hoc din dch, vv. Thông thng, phân tích tng quan có ý ngha tuyn tính và c áp dng cho mt cp bin s. Các bn ng nghip thng s dng h s tng quan \\(r\\) ca Pearson (thut ng y : Pearsons product moment correlation coefficient). ây là mt tr s thng kê cho phép o lng  mnh và chiu hng ca tng quan tuyn tính gia 2 bin liên tc \\(X\\) và \\(Y\\). Mt cách tng quát, \\(r\\) c xác nh bng t s gia hip phng sai (covariance) ca 2 bin \\(X,Y\\) chia cho tích s ca  lch chun ca chúng: \\[r_{X,Y}=\\frac{Cov(XY)}{\\sigma_X*\\sigma_Y}\\] Ta cng có th hình dung v \\(r\\) nh h s hi quy trong mt mô hình hi quy tuyn tính n bin \\(Y \\sim X\\) khi c X và Y u cùng n v o trên mt thang o chun hóa (z-scores). Giá tr ca \\(r\\) dao ng trong khong -1 n +1 và có th cho bit chiu hng ca mi tng quan: \\(r=0\\) trong trng hp không có liên h nào gia 2 bin, \\(r&gt;0\\) biu th cho mi tng quan thun (X và Y bin thiên cùng hng), \\(r&lt;0\\) biu th cho tng quan nghch (X tng, Y gim và ngc li). Giá tr tuyt i ca \\(r\\) cho bin  mnh ca tng quan: càng gn cc tr +/-1 thì mc  tng quan càng mnh. Giá tr \\(r\\) càng gn 1 cho thy 2 bin t l vi nhau mt cách hoàn ho. Ý ngha thng kê ca h s tng quan \\(r\\) c kim nh thông qua mt suy din thng kê nhm phn nghim gi thuyt H0 là r=0 (không có tng quan), da vào tr s thng kê \\(t\\) c c tính t r và c mu, t theo phân phi Student t vi  t do = (n-2): \\[t = r\\sqrt{\\frac{N-2}{1-r^2}}\\] Mt khác, vi s phát trin ca kin thc sinh lý bnh hc và công ngh xét nghim, nhà khoa hc c cung cp lng thông tin ngày càng nhiu và sâu hn, thm chí n cp  phân t. Lúc này, vic c và din gii kt qu phân tích tng quan tr nên khó khn khi kt qu thu c s là mt bng vi kích thc rt ln, trình bày giá tr h s tng quan ca mi bin bt cp tun t vi tt c nhng bin còn li. Vì vy, chúng ta cn mt gii pháp khác hiu qu hn thay cho bng kt qu. Trong chng này chúng ta s tìm hiu v quy trình phân tích mng li tng quan (correlation network), mt ý tng thú v cho phép trình bày bc tranh toàn cnh v cu trúc liên h phc tp gia rt nhiu bin s trong mt thc th bnh lý. 5.2 Bi cnh thí nghim Ta s phân tích mt d liu có thc vi mc tiêu t ra là kho sát v mi tng quan gia 15 thông s lâm sàng trong 2 nhóm khác nhau: 132 ph n bình thng và 249 trng hp có hi chng bung trng a nang (PCOS) có kèm ri lon kháng insulin (IR). Tp hp 15 thông s cn phân tích bao gm: tui ca bnh nhân (Age), ch s BMI, kt qu nh lng các loi hormones: AMH: (Anti-Müllerian Hormone), E2 (Estrogen), FSH (Follicle-Stimulating Hormone), LH (Luteinizing hormone), P (Progesterone hormone), PRL (prolactin hormone), T (Testosterone hormone), TSH (thyroid stimulating hormone), các ch s: AFC (antral follicle count), OSI (ovarian sensitivity index), kt qu insulin fasting blood test (F_INS), ng huyt (Gluc) và HOMA-IR (Homeostatic Model Assessment for Insulin Resistance). 5.3 Thm dò d liu Trc ht, ta ti d liu vào R và thc hin mt phân tích thng kê mô t n gin v c im phân phi ca 15 bin s k trên gia 2 nhóm Normal và PCOS. Kt qu trình bày trong bng sau: 5.4 Ma trn tng quan Tip theo, ta s thc hin mt phân tích tng quan c in cho 15 bin s này, riêng cho mi nhóm Normal và PCOS, s dng h s tng quan \\(r\\) ca Pearson theo quy trình gm 3 bc sau: Dùng hàm filter ca dplyr  phân lp 2 dataframe riêng cho 2 nhóm Normal và PCOS, Dùng hàm select  loi b bin phân nhóm cho mi dataframe, kt qu ta s có mt matrix ch cha toàn bin kiu s Áp dng hàm cor() trên data matrix 15 bin s, ta s thu c kt qu là mt correlation matrix vi kích thc 15 x 15 S dng th vin corrplot(Wei and Simko 2021)  chuyn ma trn tng quan này thành biu  (có tên gi là correlogram). Lu ý rng biu  này ã gin lc kt qu t ma trn tng quan có kích thc 15x15 bng cách ch ly 1 na di (vì ma trn có cu trúc i xng) và loi b ng chéo (toàn b giá tr r=1 trên ng chéo này, khi 1 bin tng quan vi chính nó). Kt qu ma trn tng quan cho nhóm PCOS Kt qu ma trn tng quan cho nhóm Normal Ta có th gin lc kt qu này nhiu hn na, bng cách ch gi li nhng cp tng quan có ý ngha thng kê (p&lt;0.05), và chuyn nhng con s giá tr \\(r\\) thành các biu tng, cho phép nhn din nhanh hng và  mnh tng quan. ây là kt qu cho nhóm PCOS: Còn ây là kt qu cho nhóm Normal Ta thy rng ngay c khi ã c gin lc ti a và ti u hóa bng màu sc và biu tng, vn khó din gii trc tip kt qu phân tích tng quan cho tp hp quá nhiu bin s. Mt khác, hình thc trình bày kt qu này ch cho phép chúng ta suy din thng kê v  mnh và chiu hng ca mi tng quan gia tng cp bin, nhng không cung cp c bc tranh toàn cnh v quan h phc tp, chng chéo gia tt c các bin. Trong phn tip theo, ta s áp dng phng pháp Network analysis, cho phép i xa hn và khai thác thêm nhiu thông tin hn t ma trn tng quan. 5.5 S  mng li tng quan S  mng li (network, graph) là mt khái nim giao thoa gia nhiu chuyên ngành. Trong ngành khoa hc máy tính, graph là mt cu trúc d liu vi công dng mô phng các h thng tng tác trong xã hi i thc (hi nhóm,mng xã hi), vi kh nng truy xut và tìm kim nhanh chóng mt phn t thông qua liên kt vi nhng phn t khác. Vi thng kê và khoa hc d liu, graph va có ý ngha nh mt công c  ha, va là mt mô hình toán hc chính xác dn n các ng dng nh suy lun nhân qu, phân tích tng quan, thm chí có th c dùng làm d liu u vào cho mô hình  S  mng là mt tp hp gm 2 thành phn: các nút (vertices) và liên kt gia chúng (edges, arcs). Trong y sinh hc, mi nút (vertex) trong mng li biu th cho mt nhân t. Nó có th là mt cu trúc sinh hc phân t (genes, protein, mt loi t bào, thông s xét nghim sinh hóa, mt i lng sinh hc, mt bin nh lng hoc nh tính. Liên kt gia 2 nút (edge) trong mng li có th biu th cho mi hình thc v mi liên h, vi ý ngha thng kê hay hin thc. Thí d: tng quan thng kê gia 2 bin nh lng, liên h gia thông s lâm sàng và xác sut bnh lý, tng tác gia phân t truyn tin và th th gia 2 t bào, t l cùng hin din gia 2 thc th lâm sàng, vv. Trong gii hn ca chng này, ta s dng mt ng dng cá bit ca s  mng ó là mng li tng quan (correlation network) nh mt phng tin cho phép trình bày trc quan v mi liên h gia các phn t trong tp hp nhiu bin s. Ngoài ra, ta có th mô t, so sánh c im ca cu trúc mng li này gia 2 trng thái bình thng và bnh lý. Trong mng li tng quan, mi nút tng ng vi mt bin s, và mi liên kt gia 2 nút X,Y tng ng vi s thit lp mi tng quan tuyn tính gia bin X và bin Y, s hin din ca liên kt c xác lp nh vào giá tr ca r và p_value. Trong R, có 2 nhóm công c khác nhau cho Network analysis, ó là packages statnet(Pavel N. Krivitsky et al. 2017) và igraph(Csardi and Nepusz 2006). Mi nhóm s dng d liu có cu trúc khác nhau (network và graph). Ta có th hoán chuyn gia graph và network bng package intergraph. Mt network hay graph có th c dng t 2 cu trúc d liu c bn là adjacency matrix, hoc edges list. Correlation matrix chính là mt adjacency matrix. ây là mt ma trn i xng (mi hàng \\(i\\) và mi ct \\(j\\) tng ng vi 1 bin, và các ô giao nhau gia chúng lu giá tr h s tng quan \\(r_{i,j}\\)). Khi chuyn thành s  mng, thut toán s to ra các nút tng ng vi tp hp bin, và thit lp liên kt gia 2 nút da vào ngng ct và tiêu chí ta t ra da trên giá tr ca h s tng quan \\(r_{i,j}\\)$. Quy trình phân tích mng li tng quan khi dùng th vin igraph gm các bc sau: u tiên, ta dùng th vin igraph  chuyn correlation matrix thành graph. Ta có th to thêm mt vài thuc tính cho các mi ni liên kt trong mng li nh: Direction = hng quan h, nhn giá tr Proportional nu r&gt;0 (tng quan thun), Inverse nu r&lt;0 (tng quan nghch); và Strength là mt bin nh phân v  mnh tng quan: Strong (tng quan mnh) nu abs(r) &gt;0.5 và Weak (tng quan yu) nu giá tr tuyt i này &lt;0.5. Chuyn mng li thành hình nh Ta th làm nh vy cho nhóm bnh nhân PCOS và thu c kt qu nh sau: Tuy nhiên, ta s không làm vic trên graph mà s chuyn nó thành network. Nguyên nhân vì nh dng d liu network tng thích vi h sinh thái statnet, cho phép chúng ta i xa hn vi nhiu phân tích và mô hình mà h sinh thái này cung cp. Ta dùng intergaph  chuyn graph object thành network object. Kt qu ca mng li tng quan cho nhóm PCOS nh sau: Trên network, ta còn có th gán thêm thuc tính cho các nút, thí d 15 bin s hin thi có th c phân thành 4 loi tùy ý ngha sinh lý ca chúng: A tng ng vi thông s nhân trc (anthropometric) nh tui, BMI, OV tng ng vi các thông s v chc nng bung trng (Ovarian) nh AFC, AMH, OSI, nhóm Glu tng ng vi các xét nghim v chuyn hóa glucose và insuline nh ng huyt, HOMA-IR, và cui cùng là nhóm H gm các hormones sinh dc. Tng t, ta thc hin cùng quy trình trên cho nhóm Normal: 5.6 Phân tích cu trúc mng li tng quan S  mng không ch n gin là mt hình v trình bày ý tng, khái nim v mng li liên h gia các bin, nhng còn là mt mô hình toán hc chính xác v kích thc, cu trúc phân b ca h thng các nút (node, vertex, actor) và mng liên kt gia chúng (edges, arcs). Hàm summary cho phép mô t tóm tt v cu trúc ca mng li. Thí d cho mng tng quan ca nhóm PCOS, ta có kt qu mô t nh sau: ## Network attributes: ## vertices = 14 ## directed = FALSE ## hyper = FALSE ## loops = FALSE ## multiple = FALSE ## bipartite = FALSE ## total edges = 31 ## missing edges = 0 ## non-missing edges = 31 ## density = 0.3406593 ## ## Vertex attributes: ## ## Physio: ## character valued attribute ## attribute summary: ## A Glu H Ov ## 2 3 6 3 ## vertex.names: ## character valued attribute ## 14 valid vertex names ## ## Edge attributes: ## ## Direction: ## character valued attribute ## attribute summary: ## Inv Pro ## 10 21 ## ## r: ## numeric valued attribute ## attribute summary: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -0.2892 -0.1434 0.1467 0.1474 0.3337 0.9928 ## ## sig: ## numeric valued attribute ## attribute summary: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.000e+00 2.800e-07 3.563e-04 1.012e-02 2.074e-02 4.268e-02 ## ## Strength: ## character valued attribute ## attribute summary: ## Strong Weak ## 3 28 Mng tng quan ca nhóm PCOS có 14 nút. Thng kê cho thuc tính ca nút cho thy có 2 bin nhân trc, 3 bin v chuyn hóa Glucose, 6 bin hormones, 3 bin chc nng bung trng trong h thng tng quan. Kt qu thng kê cho các thuc tính ca liên kt (edges) cho thy có tng cng 31 cp tng quan, trong ó 10 cp tng quan nghch và 21 cp tng quan thun, 3 cp tng quan mnh và 28 cp tng quan yu. Giá tr h s r trung bình là 0.147, thp nht là -0.289, cao nht là 0.993 Vi mng tng quan cho nhóm Normal, ta có kt qu nh sau: ## Network attributes: ## vertices = 11 ## directed = FALSE ## hyper = FALSE ## loops = FALSE ## multiple = FALSE ## bipartite = FALSE ## total edges = 21 ## missing edges = 0 ## non-missing edges = 21 ## density = 0.3818182 ## ## Vertex attributes: ## ## Physio: ## character valued attribute ## attribute summary: ## A Glu H Ov ## 1 3 4 3 ## vertex.names: ## character valued attribute ## 11 valid vertex names ## ## Edge attributes: ## ## Direction: ## character valued attribute ## attribute summary: ## Inv Pro ## 7 14 ## ## r: ## numeric valued attribute ## attribute summary: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## -0.3028 -0.1865 0.2177 0.1555 0.3121 0.9802 ## ## sig: ## numeric valued attribute ## attribute summary: ## Min. 1st Qu. Median Mean 3rd Qu. Max. ## 0.0000000 0.0002689 0.0021453 0.0110976 0.0206020 0.0370451 ## ## Strength: ## character valued attribute ## attribute summary: ## Strong Weak ## 2 19 Theo kt qu này, mng li tng quan ca nhóm Normal có kích thc nh hn (ch có 11 nút/bin s) và s cp tng quan cng ít hn (ch 21 cp), trong ó ch yu là tng quan thun (14 cp), có 2 liên kt tng quan mnh và 19 cp tng quan yu. Cng trong kt qu này, ta có mt  ca mng li (density), cho phép hình dung v kh nng liên kt gia các phn t trong tp hp. Ta thy rng tuy mng tng quan  nhóm bình thng có kích thc nh hn (11 so vi 14) nhng mt  cao liên kt cao hn (0.382 so vi 0.340) S khác bit v cu trúc gia 2 mng li tng quan cho thy mt iu thú v, ó là chúng ta vn thng hiu sai v mc tiêu cách din gii kt qu ca phân tích tng quan. Tâm lý chung ca nghiên cu sinh thng trông i phát hin s tn ti mi liên h có ý ngha thng kê gia 2 yu t bt kì, và cho rng ó là kt qu tt. Tuy nhiên, thc t có th phc tp hn nhiu. Khi chuyn t trng thái sinh lý bình thng sang bnh lý, có th ch mt trong 2, hay c 2 bin s b thay i giá tr, s thay i này có th thun chiu hay nghch chiu. Do ó, mt ri lon bnh lý có th biu hin theo nhiu cách: hoc phát sinh mt mi tng quan mà bình thng không có, hoc ngc li: làm t gãy hoc tng cng/gim nh, o chiu mt mi liên h có sn. Mt s thuc tính khác v cu trúc mà ta có th c tính t mng li, bao gm: ng kính ca mng li là con ng ni t u này sang u kia trong mng li.  ây, c 2 nhóm PCOS và Normal u có ng kính mng li là 3. ## [1] 3 ## [1] 3 Ch s Transitivity: t l gia s liên kt b ba khép kín trên tng s liên kt b ba h và kín ## [1] 0.4662162 ## [1] 0.4761905 Mng ca nhóm Normal có t s transitivity cao hn (0.48 so vi 0.47), cho thy nó có nhiu liên kt b ba hn so vi mng tng quan ca nhóm PCOS. Ngoài ra, mng li tng quan còn cho phép nhn din thông s lâm sàng nào có vai trò trung tâm, óng góp quan trng vào vic kin to mng liên kt vi nhng bin còn li, t ó tr li câu hi: i lng nào là quan trng nht trong toàn b các thông s ang c nghiên cu ? Mt phn t có vai trò trung tâm khi nó có nhiu liên h nht vi các phn t khác trong mng li. Có nhiu ch s  c lng tính Trung tâm này, nh: Degree, Betweeness, Closeness, Eigen vector, Bonacich power, Information, Harary graph.  mi trng thái khác nhau: Bnh lý/Bình thng, mi bin có vai trò khác nhau trong vic kin to ra mng li quan h vi các bin còn li. Sau ây là kt qu mô t v vai trò quan trng ca mi loi bin s trong mng li tng quan ca 2 nhóm. Thí d, ta có th phát hin ra phn t then cht cut-point , có ngha là khi loi b phn t này, cu trúc mng li s b phân rã, chia ct thành 2 hay nhiu cm. Thí d cho nhóm PCOS, thông s then cht là BMI. iu này tng t nh khi ta nhn din mt thành viên ch cht trong mt hi nhóm trong i thc. Qua thí d minh ha này, ta có th hình dung rng mc tiêu ca phân tích hin thi ã vt xa hn câu hi n gin ban u rng liu có tn ti hay không mi liên h gia 2 thông s lâm sàng. Mng li tng quan cho phép chúng ta kho sát mt cách nh lng v nhng khái nim tru tng nh: kh nng liên kt ca mt nhân t vi nhng nhân t khác (qua ó vai trò ca nó tr nên quan trng), kích thc ca cm nhân t liên h vi nhau, s thay i v mô thc ca cu trúc liên kt gia các nhân t bên trong h thng trong iu kin bnh lý Nhng thông tin này có th dn n ng dng trong thc hành lâm sàng, thí d n gin nht là nhn din mt nhóm biomarker (thông s xét nghim) có ý ngha i din và hiu qu cho mc tiêu chn oán hoc ánh giá  nng ca bnh lý. 5.7 Yu t m thut Có nhiu hình thc trình bày mng li tng quan, sau ây là 6 kiu thông dng nht áp dng cho mng tng quan ca nhóm PCOS: Ta có th thy rng 3 kiu trình bày: mng li vòng (Circle), Kamadakawai và Fruchterman-Reingold là rõ ràng và p nht. S  mng có th truyn ti nhiu thông tin qua các kênh khác nhau: Kích thc ca nút có th mã hóa cho mt bin nh lng, màu sc ca nút có th biu th bin nh tính (phân loi), kích thc và màu sc ca liên kt có th trình bày v  mnh, chiu hng hoc bn cht ca mi tng quan gia 2 nút. Ta có th tùy chnh kích thc và màu ca nút theo thuc tính ca nó: thí d 3 ch s Degree, Closeness và Betweeness o lng mc  quan trng (kh nng kin to liên kt) ca mi nút. Tng t, ta có th tùy chnh màu sc, dán nhãn cho các liên kt (cp tng quan) tùy theo các thuc tính, thí d  mnh, chiu hng ca tng quan. 5.8 Thông ip rút gn làm hành trang Khi nghiên cu v mt h thng sinh lý hoc thc th bnh lý, ta nên tip cn mt cách toàn din và t mi nhân t vào mng li liên h - tng tác phc tp vi nhng nhân t khác, thay vì ch kho sát tng i tng riêng bit. Có th kt hp gia phân tích tng quan c in và Network analysis  to ra Correlation network, mt công c hu ích cho phép kho sát trc quan và nh lng cu trúc liên h a chiu gia các i lng, nhân t trong h thng và thc th bnh lý. Bt thng và ri lon không ch biu hin qua s thay i giá tr ca mt s i lng sinh hc chuyên bit, mà còn làm thay i cu trúc ca mng li liên h gia chúng và các nhân t khác trong h thng. References "],["kho-sát-kt-cc-là-t-l-hi-quy-binomial.html", "Chng 6 Kho sát kt cc là t l: Hi quy Binomial 6.1 Gii thiu 6.2 Bi cnh ca thí nghim 6.3 Công c cn thit cho quy trình 6.4 Chun b d liu 6.5 K hoch phân tích 6.6 Thng kê mô t 6.7 Dng mô hình hi quy GLM Binomial 6.8 Suy din thng kê 6.9 Thông ip rút gn làm hành trang", " Chng 6 Kho sát kt cc là t l: Hi quy Binomial Biên son: Lê Ngc Kh Nhi, Nguyn Hà Ngc Thiên Thanh, Dng Th Ngc Châu 6.1 Gii thiu Nhng nghiên cu v quy trình th tinh ng nghim t ra yêu cu kho sát nhiu loi kt cc lâm sàng vi bn cht khác nhau. Mt khác, có tính cht k tha trong chui kt qu ca quy trình. Thành phm thu c ca công on sau chính là h qu t vic tin hành mt lot phép th (thí d th tinh, chuyn phôi) trên tp hp kt qu công on trc. Thí d, s lng phôi là h qu t t l th tinh thành công trên tp hp nhiu noãn. Do ó, cùng mt thc th kt cc nhng có th c din t theo nhiu cách; s lng phôi, t l th tinh trên tng s noãn, xác sut th tinh thành công cho mi noãn Nh ã bàn trong chng 3, do gii hn v công c thng kê, hu ht nhng nghiên cu v h tr sinh sn hin nay ch mi dng li  phân tích so sánh và kim nh bng nhng phép kim n gin thô s nh Mann-Whitney, Student t test cho mi kt qu là con s, không phân bit bn cht ca chúng là s m, s liên tc hay t l. Trong chng này, chúng tôi gii thiu mt phng pháp phân tích hp lý và chính xác hn cho kt cc là t l, áp dng lý thuyt xác sut cho bin ri rc và mô hình hi quy tuyn tính tng quát vi phân phi nh thc (Binomial). 6.2 Bi cnh ca thí nghim Kích hot s trng thành ca noãn là mt công on vào cui chu k kích thích bung trng. Hormone hCG thng c dùng  to nh hormone hoàng th (LH)  cui các chu k KTBT nhm khi ng s trng thành noãn và tip tc hoàn chnh tin trình gim phân ã b gián on trc ó. Tuy nhiên vic s dng hCG có th làm tng nguy c quá kích bung trng (OHSS). Mt phng pháp khác là s dng cht ng vn GnRH cho phép gii phóng cp tính LH và hormone kích thích nang noãn (FSH), khi phát tin trình rng trng. Quá trình kích hot to 2 nh LH và FSH này khá tng ng vi các chu k t nhiên, nhng vi nng  thp hn và thi gian bán hu ngn hn, góp phn làm gim nguy c OHSS. Gn ây, ta có thêm la chn khác là phác  kích hot kép (Dual trigger). Phác  này s dng ng thi cht ch vn GnRH và b sung hCG  liu thp hoc tiêu chun  khi phát trng thành noãn và rng trng. Trong thí nghim này, mt nhóm nghiên cu mun kho sát hiu qu to phôi (blastocytes) ca k thut kích thích trng thành noãn kép (Dual trigger), so vi 2 k thut tham chiu dùng ng vn GnRH (GnRHa) và hCG n gin. 6.3 Công c cn thit cho quy trình Th vin dplyr trong h sinh thái tidyverse(Wickham et al. 2019)  thao tác d liu và thng kê mô t Th vin ggplot2, ggrides(Wilke 2022), tidybayes và ggdist  v mt s biu  thng kê; Th vin gamlss(R. A. Rigby and Stasinopoulos 2005)  dng mô hình GLM vi phân phi Binomial Th vin marginaleffects(Vincent Arel-Bundock 2023)  c tính OR, RR và suy din thng kê t kt qu mô hình. 6.4 Chun b d liu u tiên, ta ti d liu t file Dual_trigger.csv vào dataframe df bng hàm read.csv, sau ó áp dng hàm factor  chuyn dng bin Trigger thành s th t : 1 = a (GnRH agonist), 2 = d (Dual trigger), 3 = h (hCG). Ta to ra thêm bin p1 là t l to blastocytes t s noãn ban u, bng cách chia s lng blastocytes (bin blast) cho s noãn (bin oocytes). 6.5 K hoch phân tích Kh nng to blastocyte khi dùng k thut Dual trigger so vi 2 phng pháp tham chiu (ng vn hoc hCG n) s c c lng bng marginal Odds-ratio (OR) và risk-ratio (RR), có hiu chnh cho tui và AFC, da vào mt mô hình hi quy tuyn tính tng quát (GLM) vi phân phi nh thc (Binomial). Suy din thng kê da vào ph nhn gi thuyt vô hiu (OR và RR = 1)  ngng ý ngha p = 0.05. 6.6 Thng kê mô t Ta kt hp hàm group_by và summarize ca th vin dplyr  dng mt bng thng kê mô t n gin, trình bày trung v, SD, phân v th 5 và 95 ca t l to blastocytes (bin p1) trong 3 phân nhóm k thut trigger. Theo kt qu này, mc dù giá tr trung bình ca t l to blastocyte có v cao hn  nhóm d (dual trigger), nhng gii hn phân b ca t l này li không cho thy s khác bit gia 3 nhóm. Tip theo, ta s so sánh trc quan c tính phân phi ca s lng blastocytes (bng biu  tn sut - histogram) và t l blastocyte (bng biu  boxplot). Hình: Phân b ca s lng blastocytes gia 3 nhóm k thut trigger Chú thích: 3 biu  tn sut trong hình trình bày phân b ca s lng blastocytes (trc Y)  3 nhóm k thut trigger (trc X). Hình: Phân b ca t l to blastocytes t s noãn ban u gia 3 nhóm Chú thích: 3 biu  boxplot này trình bày trung v, phân v th 25 và 75 ca t l to blastocytes (trc X).Nhng im tròn tng ng vi các giá tr vt xa khi phân v th 95. 6.7 Dng mô hình hi quy GLM Binomial Hin thi, kt cc mà ta quan tâm là s lng \\(k\\) blastocytes thu c sau quá trình th tinh t tp hp \\(n\\) noãn ban u, và t l \\(p = k/n\\). Ta thy bài toán này tng ng vi nh ngha v quy lut phân phi xác sut Binomial. Thc vy, phân phi Binomial (nh thc) cho phép c lng giá tr ca mt bin ngu nhiên \\(Y\\), vi ý ngha \\(Y\\) là s ln thu c kt qu thành công t \\(n\\) lt th nghim c lp, bit rng mi th nghim có xác sut thành công là \\(p\\). \\[Y \\sim B(n,p)\\] Xác sut \\(Y\\) nhn mt giá tr = k c c tính bi hàm: \\[Pr(Y=k|n,p) = \\binom{n}{k}p^{k}(1-p)^{n-k} = \\frac{n!}{k!(n-k)!}p^{k}(1-p)^{n-k}\\] Vi các tham s có ý ngha nh sau: \\(k\\) là s kt qu thành công ( ây là s lng blastocyte to thành) \\(n\\) ch s lt th nghim ( ây là s noãn c mang i th tinh) \\(n \\in \\left\\{0,1,2...\\right\\}\\) \\(p\\) là xác sut thành công ca mt th nghim (xác sut to c blastocyte cho mi noãn) \\(p \\in \\left [ 0,1\\right ]\\) \\((1-p)\\) là xác sut ca kt qu i nghch (tht bi, không to c blastocyte) Trong th vin gamlss(R. A. Rigby and Stasinopoulos 2005), phân phi Binomial cho mô hình GLM(Robert A. Rigby 2020) c xác nh bi 2 tham s \\(n\\) và \\(\\mu\\), kí hiu \\(BI(n,\\mu)\\), cho phép c lng giá tr ca mt bin ngu nhiên \\(Y\\) có bn cht là s m vi \\(Y \\in \\left [ 0,1,2,3...\\right ]\\) vi hàm xác sut: \\[Pr(Y=y|n,\\mu) = \\frac{n!}{y!(n-y)!}\\mu^{y}(1-p)^{n-y}\\] Trong ó \\(n\\) là mt s nguyên dng ã xác nh (trong trng hp này, \\(n\\) = s noãn cho mi bnh nhân), tham s \\(\\mu = \\frac{k}{n}\\) là xác sut trung bình thu c blastocyte t 1 noãn (\\(0&lt; \\mu &lt; 1\\)). Ta có th c lng giá tr ca \\(\\mu\\) bng mt mô hình tuyn tính tng quát vi hàm liên kt logit: \\[logit(\\mu)=log(\\frac{\\mu}{1-\\mu}) = \\beta_0+_1 _1+_2 _2+  +_ _\\] Ta s dùng mô hình này  suy din thng kê v hiu ng ca k thut dual trigger trên t l to blastocytes.  dng mô hình binomial, ta dùng hàm gamlss ca th vin gamlss, vi mt s lu ý nh sau: Công thc ca mô hình hi quy binomial khác vi các mô hình thông thng, vì  v trí kt qu y, ta cn kt hp 2 bin: s lng thành công (blast) và s lng tht bi (oocytes - blast), bng hàm cbind Tùy chnh family = BI(mu.link = logit) Trong mô hình hin thi, bin c lp là Trigger, ta cho nó tng tác vi 2 hip bin khác là Age và AFC: cbind(blast, oocytes-blast) ~ Trigger * (Age + AFC) Ni dung kt qu thô ca mô hình nh sau ## GAMLSS-RS iteration 1: Global Deviance = 7646.78 ## GAMLSS-RS iteration 2: Global Deviance = 7646.78 ## ****************************************************************** ## Family: c(&quot;BI&quot;, &quot;Binomial&quot;) ## ## Call: gamlss(formula = cbind(blast, oocytes - blast) ~ Trigger * ## (Age + AFC), family = BI(mu.link = &quot;logit&quot;), data = df) ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: logit ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) -1.0593442 0.1152770 -9.190 &lt; 2e-16 *** ## Triggerd 0.3033475 0.3965697 0.765 0.44442 ## Triggerh 0.5956986 0.3634420 1.639 0.10138 ## Age -0.0031340 0.0036684 -0.854 0.39304 ## AFC 0.0017986 0.0009032 1.991 0.04661 * ## Triggerd:Age -0.0008936 0.0113729 -0.079 0.93738 ## Triggerh:Age -0.0091438 0.0106586 -0.858 0.39107 ## Triggerd:AFC -0.0165921 0.0076311 -2.174 0.02981 * ## Triggerh:AFC -0.0218670 0.0076811 -2.847 0.00447 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 1795 ## Degrees of Freedom for the fit: 9 ## Residual Deg. of Freedom: 1786 ## at cycle: 2 ## ## Global Deviance: 7646.78 ## AIC: 7664.78 ## SBC: 7714.215 ## ****************************************************************** Lu ý rng mô hình này c lng giá tr ca \\(\\mu\\) là 1 xác sut (hay t l) và s dng hàm liên kt là logit, vì vy các h s hi quy mà ta thy ang  thang o \\(log(Odds)\\), vi odds là t l gia 2 xác sut \\(\\frac{\\mu}{1-\\mu}\\), ta có th chuyn v thang o odds bng hàm exponential, hoc chuyn hn v xác xut \\(\\mu\\) bng hàm plogis. h s (Intercept) tng ng vi \\(log(\\mu/(1-\\mu))\\) khi k thut trigger là Agonist (nhóm tham chiu), và Age, AFC  v trí trung bình ca qun th. Áp dng hàm plogis cho intercept, ta s có giá tr trung bình ca t l blastocyte  phân nhóm Agonist = 0.257  iu kin Age = 30.55 và AFC = 16.24 ## [1] 0.2574348 Triggerd và Triggerh tng ng vi giá tr log(odds) tng thêm  2 nhóm Dual trigger và hCG so vi nhóm tham chiu Agonist (trong iu kin AFC và Age không i).  ây ta quan tâm n nhóm Dual trigger, h s hi quy ca nó = 0.3033475, giá tr này &gt; 0 nên ta có th c lng là nhóm Dual trigger có kh nng to blastocytes cao hn so vi nhóm tham chiu Agonist; Áp dng hàm plogis ta có th c tính t l to blastocyte trung bình  nhóm Dual trigger = 0.32 ## [1] 0.3195161 Tuy nhiên,  suy din thng kê mt cách d dàng hn, ta s tin hành quy trình c tính marginal effects nh sau ây. 6.8 Suy din thng kê u tiên, áp dng hàm avg_comparisons, ta có th c tính c khác bit v xác sut to blastocytes trung bình gia 2 k thut: A so vi D, A so vi H và D so vi H. Theo kt qu này, c 3 cp so sánh u không có ý ngha thng kê (p value &gt; 0.05 và KTC95% cha giá tr 0). Ta cng có th c tính hiu ng ca D so vi A và H thông qua tr s Odds-ratio bng cách áp dng 2 hàm transform_pre = lnoravg và post = exp. Theo kt qu này, nu chn nhóm Agonist làm tham chiu, OR ca Dual trigger = 1.016, tuy nhiên KTC95% cha giá tr 1 và p value &gt; 0.05, nên không có ý ngha thng kê. Tng t, OR ca nhóm hCG so vi Dual trigger = 0.96 &lt; 1, tuy nhiên cng không có ý ngha thng kê. Ta còn có th c tính hiu ng bng Risk-ratio (RR), ch cn thay hàm transform_pre = lnratioavg. Ta din gii kt qu RR tng t nh trên, không có s khác bit gia Dual trigger và nhóm tham chiu Agonist hoc hCG. Ngoài ra, ta có th i xa hn khi c lng hiu ng (OR hoc RR) ca Dual trigger trong nhng iu kin khác nhau ca hip bin, thí d AFC = 2,5,10 và 20 nh sau: Kt qu này khá thú v, vì nó cho thy rng khi AFC &lt;= 5, OR ca Dual trigger so vi Agonist ln lt là 1.27 và 1.21 và có ý ngha thng kê. Ta có th trình bày trc quan v hiu ng ca k thut trigger i vi t l to blastocyte, da vào mô hình Binomial nh sau: Ta có th trình bày cùng kt qu trên nhng cho riêng 6 iu kin khác nhau v giá tr AFC = 1,5,10,15,20 và 30 Din gii kt qu ca phân tích : Kt qu phân tích hi quy cho thy  cp  qun th, k thut dual trigger có hiu qu tng ng vi 2 ký thut GnRH agonist và hCG v t l to blastocytes. Tuy nhiên,  nhng i tng có AFC &lt;5, hiu qu to blastocyte ca Dual trigger cao hn mt cách có ý ngha so vi GnRH agonist (OR = 1.27, KTC95%: 1.05 - 1.54, p=0.01). 6.9 Thông ip rút gn làm hành trang Chui kt qu trong tin trình th tinh ng nghim có tính cht k tha. Thành qu ca công on sau (thí d s phôi) có th c kho sát nh t l thành công t nhiu ln th nghim trên tp hp các n v noãn. Hin tng này tng ng vi ý ngha ca quy lut phân phi nh thc. Vì vy, mô hình tuyn tính tng quát vi phân phi nh thc có th dùng nh công c trung gian lý tng  thc hin suy din thng kê cho kt qu là t l (nh t l trng thành noãn, t l to phôi) Ta suy din thng kê cho kt cc t l da vào t s OR hoc RR hiu chnh t mô hình GLM Binomial. References "],["thí-nghim-kho-sát-lp-li-mô-hình-gee.html", "Chng 7 Thí nghim kho sát lp li: Mô hình GEE 7.1 Gii thiu 7.2 Bi cnh ca thí nghim 7.3 Công c cho quy trình 7.4 Thng kê mô t 7.5 Phân tích bài toán 7.6 Gii thiu v mô hình GEE 7.7 Dng mô hình GEE 7.8 Din gii kt qu mô hình GEE 7.9 Din t kt qu ca phân tích: 7.10 Thông ip rút gn làm hành trang", " Chng 7 Thí nghim kho sát lp li: Mô hình GEE Biên son: Lê Ngc Kh Nhi, Dng Th Ngc Châu, Thân Trng Thch 7.1 Gii thiu Sn ph khoa là mt chuyên khoa c bit mà các tình hung lâm sàng thng din ra theo mt tin trình dài hn. Vì vy, khi làm nghiên cu ta thng quan tâm v c im din tin ca trng thái sinh lý bnh ca ngi ph n trong mt giai on dài hn là ch kho sát ct ngang ti mt thi im duy nht. Can thip th tinh nhân to là mt trng hp in hình, vì bn thân quy trình này bao gm nhiu công on, tri dài t giai on c bn, n khi khi ng mt chu kì COS, thu hoch noãn, tin hành th tinh, chuyn phôi, theo dõi thai kì n lúc sinh n. Trong trng hp tht bi, ngi ph n có th phi lp li nhiu chu kì khác nhau cho n khi t kt qu mong i. Vì vy, nghiên cu trng din, kho sát lp li là thit k quan trng và ph bin trong nghiên cu h tr sinh sn. Tuy nhiên, ta không th phân tích d liu ca thí nghim kho sát lp li theo cách thc thông thng, bi vì mi n v mu (cá th bnh nhân) to ra mt phân cm d liu (cluster), trong ó các giá tr qua nhiu thi im ly mu khác nhau s liên h vi nhau (vì cùng thuc v bnh nhân ó), ch không còn c lp theo gi nh ca hu ht phng pháp thông thng. Do ó, chúng ta cn dùng mt s phng pháp thng kê c bit có xét n yu t t tng quan trong mi cá th. Mt trong nhng công c thng kê áp ng nhu cu này ó là mô hình Generalized Estimating Equations (GEE) (Mô hình biu thc c lng tng quát) (Yan and Fine 2004). Trong chng này ta s tìm hiu v mô hình GEE và áp dng công c này  phân tích mt d liu t thí nghim kho sát lp li qua nhiu thi im. 7.2 Bi cnh ca thí nghim ây là mt nghiên cu có thc ca Qianwen Xi và cs (Thng Hi, TQ) nm 2020, vi mc tiêu kho sát hiu ng ca 2 loi phác : gonadotrophin-releasing hormone agonist long protocol (GnRHa) và progestin-primed ovarian stimulation (PPOS) i vi din tin ca hormone LH qua 4 thi im: ngày 1, 6, 10 và ngày trigger trong chu kì COS. 7.3 Công c cho quy trình Th vin ggplot2, ggridges  v biu  thng kê, Th vin dplyr t h sinh thái tidyverse  thao tác d liu và thng kê mô t, Th vin geepackYan (2002)  thc hin mô hình GEE, Th vin marginaleffects(Vincent Arel-Bundock 2023) và broom  phân tích, suy lun thng kê t kt qu mô hình GEE u tiên ta ti d liu vào R ây là mt d liu có cu trúc hn hp (panel data) rt in hình cho thí nghim lp li, trong ó mt i lng (LH) c kho sát ti các thi im/iu kin khác nhau cho cùng cá th. Mi phác  PPOS và GnRHa c áp dng riêng bit cho 50 và 84 cá th, LH là bin kt qu chính trong bài toán, mt bin s liên tc, c nh lng 4 ln ti N1, N6, N10 và ngày trigger cho mi cá th. Tng cng có 4 thi im x 134 cá th = 536 n v kho sát. 7.4 Thng kê mô t ây là mt bài toán khá phc tp vì ta s phi kho sát s tng tác gia 2 yu t: nhóm phác  (GnRHa so vi PPOS) và Thi gian (4 thi im D1, D6, D10 và TD). u tiên ta th làm mt phân tích mô t  so sánh c tính phân b (trung v, trung bình, phân v 5 và 95) ca LH ti 4 thi im và gia 2 phác : Kt qu thng kê mô t gi ý mt s thông tin nh sau: Ti mi thi im, giá tr LH có v cao hn  phác  PPOS so vi GnRHa;  phác  GnRHa, mc  LH dao ng không áng k và luôn thp hn 1;  phác  PPOS, mc  LH ban u cao (&gt;2), nhng gim dn (n iu) t N1 n ngày Trigger ây là hình nh trc quan ca khuynh hng din tin và tính cht phân phi ca LH qua 4 thi im, gia 2 phác  Chú thích: Hình trên trình bày c tính phân phi ca LH (trc Y) gia 2 phác  GnRHa (màu xanh) và PPOS (màu hng) và khuynh hng din tin t N1 n ngày Trigger (trc X). Các on thng trình bày khuynh hng tng/gim t thi im trc n ngay tip theo cho mi cá th bnh nhân. 7.5 Phân tích bài toán Trong thng kê c in, bài toán hin thi tng ng vi mt phân tích phng sai hn hp (Mixed ANOVA), hay phân tích phng sai 1 yu t cho phép o lp li (Factorial repeated measure ANOVA). Tuy nhiên ta s dùng trc tip phân tích hi quy bng mô hình (GEE) thay vì theo con ng thit k ANOVA truyn thng. Vic s dng mô hình hi quy linh ng hn, khi cho phép chúng ta vt ra khi gii hn gi nh phân phi chun ca ANOVA c in, nhng có th c lng bin kt qu LH bng mt quy lut phân phi khác phù hp hn ngoài phân phi chun. Theo biu  trên,  mi phân nhóm thi im cng nh phác , phân phi ca LH không chun, không i xng nhng có  lch và phân tán cao. Vì vy, chúng ta s dùng quy lut phân phi Gamma thay vì Gaussian  mô t cho giá tr LH. Tip theo, giá tr c lng ca LH (tham s \\(\\mu\\)) ca mi cá th chu nh hng t mt s yu t có tính cht th bc và phân nhóm nh minh ha trong s  sau: Hiu ng  cp  qun th (population effect) gm 2 bc: Bc hiu ng th nht là g, hay nhóm phác  (GnRHa hay PPOS), trong ó mt phn Intercept (\\(\\beta_0\\)) tng ng vi nhóm GnRH, và \\(\\beta_{g=ppos}\\) tng ng vi phn phng sai LH do PPOS c lp gây ra. Bc hiu ng th 2, tng ng vi thi im (t), t có 4 bc giá tr : D1, D6, D10 và TD; trong ó t=D1 tham gia 1 phn vào giá tr Intercept, còn li ta có 3 h s hi quy \\(\\beta_{D6}, \\beta_{D10}, \\beta{TD}\\) tng ng vi hiu ng c lp ca GnRha ti 3 thi im này. Vì ta xét s tng tác gia phác  g và thi im j, mô hình s có thêm 3 h s hi quy \\(\\beta_{gt}\\) na là \\(\\beta{ppos:D6}, \\beta_{ppos:D10}, \\beta_{ppos::td}\\), tng ng vi hiu ng c lp ca phác  PPOS ti 3 thi im D6,D10 và TD, so vi D1. Nh vy ta có công thc mô hình c lng giá tr LH trung bình \\(\\mu\\) qua hàm liên kt logarit nh sau; \\[log(\\mu) \\sim \\beta_0 + \\beta_{ppos} + \\beta_{D6} + \\beta_{D10} + \\beta_{DT} + \\beta_{ppos:D6} + \\beta_{ppos:D10} + \\beta_{ppos:DT}\\] 7.6 Gii thiu v mô hình GEE GEE là mt loi mô hình c bit mà lý thuyt v c ch ca nó có v phc tp hn so vi mô hình GLM, nhng thc ra không quá khó hiu nu ta phân tích ra thành tng b phn. Nh mi mô hình khác, mc tiêu ca chúng ta là c lng giá tr LH nh mt bin ngu nhiên \\(Y\\),  ây Y là bin s liên tc. Tuy nhiên vi thit k kho sát lp li và trng din, giá tr ca \\(Y\\) cá bit cho tng cá th \\(i\\) và tng thi im \\(t\\). Nu ch xét n n v là bnh nhân, ta có \\(Y_i\\), nu xét n tng thi im cho riêng cá th ó, ta có \\(Y_{i,t}\\). Trong mô hình GEE, các i lng trên thuc v thành phn bt nh (ngu nhiên: stochastic component) và c c lng bng phân phi chung (joint distribution, \\(Y_{i}\\)) và phân phi cn biên (marginal distribution, \\(Y_{i,t}\\)): \\[Y_{i} \\sim f(y_{i} | \\mu_{i})\\] \\[Y_{i,t} \\sim g(y_{i,t} | \\mu_{i,t})\\] Vi \\(f\\) và \\(g\\) là 2 phân phi bt nh có giá tr trung bình là \\(\\mu_{i}\\) và \\(\\mu_{i,t}\\), (tng ng vi: giá tr LH trung bình  cp  cá th hoc cá th/thi gian). Khác vi mô hình tuyn tính GLM, mô hình GEE không t ra gi nh v quy lut phân phi ca bin kt qu \\(Y\\), nó cng không c lng giá tr \\(Y_{i,t}\\) t mt quy lut phân phi. Thay vào ó, giá tr ca \\(Y_{i,t}\\) s c c lng t 3 biu thc (equations) bên trong mô hình, gm: hàm c tính giá tr trung bình (mean function), kí hiu là \\(G(\\mu_{i,t})\\) Hàm này còn gi là thành phn h thng (systematic component), nó cho phép c tính giá tr trung bình \\(\\mu_{i,t}\\) vi công thc tng quát: \\[G(\\mu_{i,t}) = x_{i,t}^{\\top}\\beta\\] \\(G\\) là hàm liên kt cho mt phân phi mà ta chn cho bin kt qu \\(Y\\). Ta thng làm vic vi 4 h phân phi chính trong R, bao gm gaussian và Gamma cho bin s liên tc, binomial cho bin nh giá (0,1) và poisson cho bin s m. Các hàm liên kt mc nh cho 4 loi phân phi này trong R c trình bày trong bng sau: Trong trng hp này, ta s áp dng phân phi Gamma, vi hàm liên kt mc nh là nghch o (inverse): \\(\\frac{1}{\\mu_{i,t}}\\). Ta cng có th dng mô hình cho phân phi Gamma vi 2 hàm liên kt khác là logarit và identity. \\(x_{i,t}\\) tng ng vi vector ca tp hp bin c lp (yu t d báo) cho cá th \\(i\\) ti thi im \\(t\\); còn \\(\\beta\\) là vector các h s hi quy trong mô hình. Hàm c tính phng sai (variance function), kí hiu là \\(V_{i,t}\\) Sau khi có giá tr \\(\\mu_{i,t}\\), kt qu này i tip vào hàm c tính phng sai (hay  phân tán). Hàm này cho phép c tính phng sai (variance) ca \\(Y\\) theo giá tr trung bình \\(\\mu_{i,t}\\). Tng t nh hàm trung bình, các h phân phi khác nhau có hàm phng sai khác nhau. Ni dung hàm phng sai cho 4 phân phi thng gp c trình bày trong bng sau: Trong trng hp hin thi, bin kt qu c mô hình hóa theo phân phi gamma, nên hàm phng sai s là \\(\\mu^{2}\\) Cu trúc tng quan (correlation structure), kí hiu là \\(V_{i}\\) Cui cùng, giá tr ca trung bình và phng sai s c phân b vào cu trúc tng quan. Cu trúc này c xác nh bng mt ma trn tng quan ng (working correlation matrix) có kích thc \\(T \\times T\\), vi \\(T\\) là kích thc cm d liu ln nht c ghi nhn trong d liu. \\[V_{i} = \\phi \\, A_{i}^{\\frac{1}{2}} R_{i}(\\alpha) A_{i}^{\\frac{1}{2}}\\] vi \\(A_{i}\\) là diagonal matrix kích thc \\(T \\times T\\), nhn giá tr ca hàm phng sai \\(V_{it}\\) cho mi v trí \\(t\\) trên ng chéo, \\(R_{i}(\\alpha)\\) là ma trn tng quan ng, \\(\\phi\\) là mt tham s t l. Th vin geepack cho phép ngi dùng tùy chn 4 kiu ma trn tng quan, tng ng vi 4 tên gi mà ta có th tùy chnh cho tham s corstr, vi ý ngha nh sau: constr = independence: khi ta chc chn rng không th tn ti mi tng quan gia các giá tr ti nhng thi im t khác nhau cho cùng mt cá th (n v mu) (các giá tr \\(Y_{i,t}\\) c lp vi nhau), thí d trong trng hp kt qu Y sinh ra hoàn toàn ngu nhiên ti mi thi im, không theo quy lut nào c trong quá trình kho sát lp li, dù vn thuc v cm quan sát cho riêng cá th ó. Khi chn gi thuyt này, ta cng bc toàn b giá tr trong ma trn tng quan luôn = 0. Vi kiu ma trn tng quan này, ta ang dng mô hình cho các quan sát c lp, và mô hình GEE tng ng vi mt mô hình GLM thông thng. constr = exchangeable: khi mc  tng quan là hng nh cho bt kì cp thi im nào (nói cách khác, các thi im có kh nng hoán chuyn v trí cho nhau) cho cùng mt cá th. Thí d: nhng chu kì th tinh nhân to khác nhau thc hin ti cùng mt trung tâm h tr sinh sn bi cùng i ng chuyên viên, dù theo trình t thi gian trc sau nhng c xem nh hoán chuyn c cho nhau). constr = ar1: ây là cu trúc tng quan có tính cht t thoái trin (autoregressive), vi 2 giá tr ti 2 thi im gn nhau (thí d ngày 1 và ngày 6) s tng quan vi nhau mnh hn thí d \\(\\rho^1\\) so vi gia 2 thi im cách xa nhau (thí d ngày 1 và ngày 10, h s tng quan gim còn \\(\\rho^2\\)). Mt s kt cc lâm sàng có th có tính cht này, thí d nh mt biomarker chu tác ng ca mt can thip tr liu mà tác dng yu dn theo thi gian. constr = unstructured: khi chn cu trúc này, ta hình dung rng có th tn ti mi tng quan gia các thi im bt kì, nhng hoàn toàn ngu nhiên, và ta cho phép tng quan gia các thi im khác nhau t do dao ng mt cách ngu nhiên. ây là cu trúc kh d nht khi ta không có mt gi thuyt c th nào. Thc ra, ngay c khi ta chn nhm kiu cu trúc tng quan, thì kt qu ca mô hình vn khá chính xác (theo Agresti, 2002) (d nhiên không có mô hình nào hoàn ho). Agresti gi ý nên bt u bng kiu exchangeable, sau ó kim tra kt qu và  chính xác ca mô hình, so vi các kiu còn li. Nu khác bit này quá nh, có th chn cu trúc tng quan n gin hn. 7.7 Dng mô hình GEE Ta có th dng mt mô hình GEE rt d dàng bng hàm geeglm ca th vin geepack. Ta s bt u bng mô hình gee1 có cu trúc tng quan corstr = exchangeable, sau ó cng s th 2 kiu cu trúc khác là independence và ar1, và so sánh sai s gia các mô hình. công thc mô hình là LH ~ Method * Timepoint  xét hiu ng tng tác gia phác  (Method) và Thi im (Timepoint). id = ID: khai báo bin mã s nh danh cho cá th. Ta chn family = Gamma(link = log)  mô t kt qu bng phân phi Gamma vi hàm liên kt là logarit ## Str Residual ## 1 exchangeable -2.32329e-14 ## 2 independence -2.32329e-14 ## 3 ar1 -2.32329e-14 Kt qu so sánh sai s cho thy c 3 cu trúc ma trn tng quan u có th áp dng cho d liu hin thi. Ta chn s dng mô hình vi cu trúc exchangeable  din gii. 7.8 Din gii kt qu mô hình GEE Ni dung mô hình GEE sau khi khp vi d liu nh sau: Vì mô hình c lng \\(\\mu\\) qua hàm liên kt log, nên các h s hi quy trong bng kt qu s cho ra giá tr log(LH), nu mun hoán chuyn v thang o nguyên thy, ta phi dùng hàm exponential. Intercept tng ng vi giá tr log(LH)  nhóm GnRHa, thi im D1; Intercept + MethodPPOS tng ng vi giá tr log(LH)  nhóm PPOS, thi im D1; Intercept + TimepointD6 tng ng log(LH)  D6 nhóm GnRHa; Intercept + PPOS + MethodPPOS:TimepointD6 tng ng log(LH)  D6 nhóm PPOS   ây, ta quan tâm n s thay i tun t ca LH, gia D1 và D6, D6 và D10, và D10 và TD. ta có th suy din thng kê cho hiu ng ca riêng thi im, không phân bit phác  nào nh sau: Nu không phân bit loi phác  mà ch kho sát khuynh hng din tin ca LH qua 4 thi im, thì kt qu cho thy LH gim dn t Ngày 1 n Trigger day, và s thay i bt u rõ nét t ngày 6, c th: t D1 n D6 gim -0.1121642 n v nhng không có ý ngha thng kê; t D6 n D10 gim -0.2940299, t D10 n TD gim -0.1959701 n v, u có ý ngha thng kê. Tuy nhiên, iu ta thc s quan tâm là din tin thay i ca LH theo thi gian và riêng cho mi loi phác , kt qu ca phân tích này nh sau: Vi phác  PPOS, LH gim dn t ngày 1 n ngày trigger, c th là t ngày 1 n ngày 6 gim trung bình -0.681 n v (p=0.01), t ngày 6 n ngày 10 tip tc gim trung bình -0.816 n v (p=0.002), tuy nhiên không có thay i ý ngha t ngày 10 n ngày Trigger. Trái li,  phác  GnRH antagonist, giá tr LH gn nh không thay i t ngày 1 n ngày 10, nó ch gim trung bình -0.14 n v t ngày 10 n ngày trigger (p=0.015). Mt suy din thng kê khác mà ta có th thc hin, là so sánh giá tr LH trung bình gia 2 phác  ti cùng thi im. Kt qu ca phân tích này nh sau: Kt qu này chng thc cm nhn trc quan ca chúng ta khi nhìn biu  mô t, ó là ti bt kì thi im nào, mc LH trung bình luôn cao hn mt cách có ý ngha  nhóm PPOS so vi GnRH_ant, tuy nhiên khong cách khác bit thu hp dn t Ngày 1 n ngày Trigger (t 2.8 xung còn 0.92 n v). Ta có th trình bày trc quan kt qu ca mô hình trong biu  sau: 7.9 Din t kt qu ca phân tích: Phân tích bng mô hình GEE cho thy s khác bit rõ nét v din bin ca LH gia 2 loi phác . So vi phác  GnRHant, phác  PPOS không t mc tiêu kim soát mc  LH thp liên tc kéo dài, tuy nhiên PPOS tác ng làm gim LH trong mt giai on ngn t ngày 1 n ngày 10 trong chu kì kích thích bung trng, vi mc thp nht trc ngày Trigger. 7.10 Thông ip rút gn làm hành trang Kho sát din bin ca mt i lng qua nhiu thi im khác nhau là mt bài toán thng kê c thù và ph bin trong Sn khoa và chuyên ngành h tr sinh sn. Mô hình GEE là mt gii pháp thích hp cho thí nghim kho sát lp li. Ngoài phân phi Gamma cho kt qu nh lng hormone, ta còn có th áp dng mô hình GEE vi phân phi nh thc  kho sát kt cc thai kì qua nhiu chu k th tinh nhân to liên tip. References "],["kho-sát-kt-cc-nh-phân-hi-quy-logistic.html", "Chng 8 Kho sát kt cc nh phân: Hi quy logistic 8.1 Gii thiu 8.2 Bi cnh ca thí nghim 8.3 K hoch phân tích 8.4 Công c cn thit cho quy trình 8.5 Chun b d liu 8.6 Phân tích mô t 8.7 Lý thuyt v mô hình hi quy logistic 8.8 Mô hình hi quy Logistic cho bin kt qu nh giá 8.9 Mô hình hi quy Binomial cho t l OP/tng s phôi 8.10 Din gii kt qu ca phân tích 8.11 Thông ip rút gn làm hành trang", " Chng 8 Kho sát kt cc nh phân: Hi quy logistic Biên son: Lê Ngc Kh Nhi, Thân Trng Thch, Dng Th Ngc Châu 8.1 Gii thiu  chng này, chúng ta s kho sát thành qu c quan tâm nht trong nghiên cu v h tr sinh sn, ó là s th thai (thai sinh hóa, lâm sàng), s tip din thành công ca thai kì (thai din tin) và s sinh n. Trong y vn, nhng kt cc này thng c kho sát nh mt giá tr mang tính nh phân (Có hoc không), hoc t l thành công trên tng s cá th bnh nhân. Tuy nhiên, bn cht ca loi kt cc này có th c nhìn nhn nh mt xác sut hay kh nng thành công và cng có tính k tha nh mt phn trong chui kt qu ca tin trình th tinh nhân to. Vì vy, ta có th áp dng quy lut phân phi nh thc (binomial)  kho sát chúng. Thí d, kt qu thai din tin thng c ghi nhn bng 2 giá tr 0 (không) hoc 1 (có) trong d liu, nhng bn cht ca thai din tin có th xem nh xác sut thành công \\(p\\) ca 1 th nghim chuyn phôi. Chính vì trên thc t, s lng phôi c chuyn rt thp, ch gii hn  1 n 2 phôi cho mi chu kì, nên kt qu quan sát c mi biu hin thành giá tr 0 hoc 1. Ta s tìm hiu v phân tích hi quy logistic và trng hp tng quát ca nó - mt mô hình hi quy GLM vi phân phi Binomial, cho phép suy din thng kê cho kt qu nh phân hoc xác sut thành công ca th nghim. 8.2 Bi cnh ca thí nghim Tình hung minh ha là mt th nghim lâm sàng vi mc tiêu so sánh hiu qu ca phác  PPOS so vi phác  tham chiu là GnRH_ant i vi kh nng t c thai din tin (ongoing pregnancy). Trong thí nghim này, phác  GnRH_ant c áp dng cho nhóm i chng gm 107 ph n him mun, và phác  PPOS áp dng cho nhóm can thip gm 99 trng hp. Sau khi thu hoch noãn, th tinh và tr phôi, ngi ta thc hin t 1 n 3 ln chuyn phôi, mi ln 1-2 phôi và ghi nhn kt qu thai din tin cng dn (nu mt trng hp không thành công  ln chuyn phôi u tiên, ta s lp li quy trình chuyn phôi ln 2, hoc ln 3). Th nghim kt thúc  ln th 3. Kt cc s c kho sát di 3 hình thc: Giá tr nh phân: thành công hay tht bi tuyt i : có t c thai din tin hay không (cho ti a 3 ln): 0 = Không, 1 = Có (bt k song thai, n thai) Tn sut: s lng thai din tin cho mi cá th (giá tr = 0 (không t c), 1 = n thai din tin, 2 = song thai din tin). T l t thai din tin = s thai din tin chia cho tng s phôi c chuyn. Thí d: Ln 1 chuyn 2 phôi, kt qu không t, ln 2 chuyn 2 phôi và t n thai, thì t l thành công = \\(1/(2+2) = 0.25\\) Lu ý rng các trng hp: sy thai, thai ngoài t cung xem nh tht bi. 8.3 K hoch phân tích Xác sut t thai din tin cng dn khi áp dng phác  PPOS, so vi phng pháp tham chiu là GnRH_ant s c c lng bng marginal Odds-ratio (OR) và risk-ratio (RR), có hiu chnh cho Tui, AFC và  dày ni mc trung bình ngày chuyn phôi, da vào mt mô hình hi quy logistic. Suy din thng kê da vào ph nhn gi thuyt vô hiu (OR và RR = 1)  ngng ý ngha p = 0.05. 8.4 Công c cn thit cho quy trình Th vin dplyr trong h sinh thái tidyverse  thao tác d liu và thng kê mô t Th vin ggplot2, ggrides, tidybayes và ggdist  v mt s biu  thng kê; Th vin patchwork  ghép nhiu biu  ggplot2 vi nhau. Th vin gamlss  dng mô hình GLM vi phân phi Binomial Th vin marginaleffects  c tính OR, RR và suy din thng kê t kt qu mô hình. 8.5 Chun b d liu u tiên, ta ti d liu t file PPOS_OP.csv vào dataframe df, sau ó ta Trong d liu này: Age = Tui bnh nhân, AFC = D tr bung trng c bn; Thickness =  dày ni mc t cung; n_ET: tng s phôi ã chuyn trong tin trình nghiên cu; OP_cum = tn sut thai din tin cng dn (giá tr cao nht = 2, thp nht = 0); OP_bin = kt qu thành công/tht bi tuyt i (2 giá tr 0,1) OP_rate = t l thai din tin = OP_cum / n_ET 8.6 Phân tích mô t Ta kt hp hàm group_by và summarize ca th vin dplyr  thc hin thng kê mô t cho nhng hình thc khác nhau ca kt cc thai din tin cng dn: a) Kho sát tn sut thai din tin (bin OP_cum) ây là mt bin s ri rc và ch có th có 3 giá tr: 0, 1 hoc 2. Kt qu mô t nh sau: Theo kt qu này, nu xét v s lng tuyt i, thì dng nh gia 2 phác  PPOS và GnRH không có s khác bit nào c: Mode = 1 cho thy kt qu thng gp nht cho c 2 phác  là t ít nht 1 thai din tin. Xét bình quân thì nhóm PPOS có v u th hn: s thai din tin trung bình là 1.03 so vi 0.81; c 2 u có  phân tán cao tng ng (SD khong 0.7). b) Nu xét v t l thai din tin trên tng s phôi chuyn: Kt qu này cho thy t l thai din tin trung bình có v u th hn  nhóm PPOS so vi GnRHant: 0.46 so vi 0.37 (nói cách khác, xác sut th thai thành công cho mi phôi chuyn có v cao hn  phác  PPOS); Ta có th c tính Risk ratio (RR) gia 2 phác : \\(RR = 0.457/0.37 = 1.235\\). Tuy nhiên giá tr trung v li tng ng (0.5). Nói cách khác, nu c chuyn phôi 2 ln thì d kin ít nht s có 1 ln t thành công. c) T s xác sut thành công/tht bi (Odds) Ta có th c lng kt qu thai din tin theo mt cách khác, bng t s Odds \\[Odds = \\frac{p_1}{p_0} = \\frac{p_1}{(1 - p_1)}\\] Vi \\(p_1\\) là xác sut thành công, \\(p_0\\) là xác sut tht bi. Theo kt qu này, Odds ca nhóm PPOS cao hn Odds ca nhóm GnRHant (0.556 so vi 0.462), nói cách khác Odds ratio gia PPOS và GnRHa : \\(OR = 0.556/0.462 = 1.203\\) d) Nu xét giá tr thành công hay tht bi tuyt i (bin nh giá OP_bin) Khi thc hin phân tích này, n v quan sát là cá th bnh nhân thay vì n v phôi. Cách kho sát này s cho ra mt kt qu khác Da vào kt qu này, t s xác sut thành công gia 2 phác  : \\(RR = 0.798/0.645 = 1.237\\) và Odds-ratio gia chúng \\(OR = 3.95/1.815 = 2.176\\).  ây ta thy mt im thú v là khi chn n v kho sát là bnh nhân, kt qu OR và RR có khuynh hng cao hn so vi khi xét n v kho sát là phôi. Ta ln lt kho sát trc quan 3 hình thc kho sát kt qu thai din tin trong 3 biu  sau Chú thích: Hình bên trái là biu  ct chng trình bày phân b t l Thành công/Tht bi (trc Y) gia 2 phác  (trc X), hình bên phi gm 2 biu : góc trên là biu  tán x so sánh tn sut thai din tin (trc Y) gia 2 phác  (trc X), góc di là biu  tn sut mô t t l thai din tin cng dn (trc Y) gia 2 phác  (trc X). Ngoài 2 phác , trong d liu còn có mt s hip bin khác nh Tui, AFC và  dày ni mc có bn cht là bin s liên tc. Ta mun kho sát trc quan mi liên h gia nhng hip bin này và xác sut t thai din tin; ta có th thc hin theo 3 cách: Liên h bin X và giá tr 0,1 ca bin OP_bin, thông qua  th ca mô hình GLM vi phân phi binomial ( th hàm logistic) Liên h bin X và giá tr t l OP_rate, thông qua 1 mô hình hi quy GLM vi phân phi quasibinomial; Liên h bin X và Odds, thông qua mt mô hình hi quy tuyn tính Chú thích: Hình trên gm 3 ct, t trái sang phi ln lt trình bày: (1) Liên h gia giá tr AFC, Age, Thickness (3 hàng, trc X) và kh nng t thai din tin (trc Y); (2) Liên h gia giá tr AFC, Age, Thickness (3 hàng, trc X) và Odds (t s gia xác sut thành công/tht bi); và (3) Liên h gia giá tr AFC, Age, Thickness (3 hàng, trc X) và t l thai din tin trên tng s phôi chuyn (trc Y). D liu c phân thành 2 nhóm: phác  PPOS (màu hng) và GnRha (màu xanh). Hình nh này gi ý mt s gi thuyt nh sau: AFC có hiu ng tng tác gia AFC và loi phác , vì 2  th các hàm tuyn tính/logistic ca 2 nhóm ct nhau, vi hiu ng AFC khác bit  mi nhóm. Tui có hiu ng c lp và ng nht  2 phác , kh nng thai din tin tng quan nghch vi tui (gim dn  ph n ln tui);  dày ni mc t cung có hiu ng c lp vi phác , và ng nht gia 2 nhóm phác , hiu ng này rt yu và có khuynh hng tng quan thun vi kh nng thai din tin. 8.7 Lý thuyt v mô hình hi quy logistic Cho bài toán thng kê hin thi, ta cn mt phng tin cho phép liên kt giá tr ca mt bin c lp (yu t tiên lng) \\(X\\) và mt xác sut \\(Y = p \\in [0,1]\\). Công c ó là mô hình logistic. Mô hình hi quy logistic có mt lch s lâu i (khong 78 nm), trc c s ra i ca lý thuyt v mô hình tuyn tính tng quát GLM. Câu chuyn này khá dài, và s khi u ca nó không liên quan gì n xác sut và thng kê. Chúng ta s khi hành xa hn t ch nhn ra trong th gii t nhiên luôn hin din mt quy lut tin trin c bit gm 3 giai on: 1) Giai on sm vi s tng trng ly tin, xp x hàm m (exponential); 2) Tip theo là giai on bão hòa: tc  phát trin chm li, tuyn tính; 3) Cui cùng là giai on n nh và trng thành: s phát trin ngng li. Khi biu din tin trình này theo thi gian, s to ra mt ng cong hình ch S (sigmoid curve). Ta có th quan sát thy quy lut này  mi lnh vc: tng trng dân s/kinh t, chu trình chuyn hóa sinh hc, phn ng hóa hc. Trong Sn Ph khoa, ta có th nhìn thy nó trong din tin các hormone sinh dc, s tng trng ca bào thai trong t cung ngi m, liên h liu / áp ng trong dc lc hc T th k 18-19, nhng nhà toán hc ã kho sát quy lut này và lp ra các hàm toán hc cho phép tái hin ng cong hình ch S, gi là các hàm sigmoid, thí d hàm hyperbolic tangent ca Jean Saurry nm 1774. Trong s các hàm sigmoid, ta có hàm logistic là nhân vt chính trong câu chuyn này. Hàm logistic do nhà toán hc ngi Pháp Pierre François Verhulst thit lp vào nm 1845, vi công dng nguyên thy nhm kho sát quy lut tng trng dân s trong mt qun th. Công thc ca hàm logistic c trình bày nh sau. \\[y = \\frac{e^{x}}{1 + e^{x}} = \\frac{1}{1 + e^{-x}} = \\frac{1}{2} + \\frac{1}{2} tanh(\\frac{x}{2})\\] Hình:  th hàm logistic. T giá tr u vào là s thc \\(x\\) bt kì, hàm logistic xut kt qu là mt giá tr trong khong (0,1). Mt cách tình c, c tính này ca hàm logistic dn n mt ng dng quan trng trong lnh vc thng kê: nó gii quyt nhu cu liên kt giá tr mt tp bin \\(X\\) và xác sut quan sát c giá tr \\(Y=1\\) (Y là mt bin nh giá). Mô hình logistic c in c nh ngha trc tip da vào hàm logistic, bng cách thay i s \\(x\\) bng mt i lng \\(g\\) nh sau: \\[Pr(Y=1|X) \\sim logistic(X) = \\frac{1}{1 + e^{-g}}\\] Vi \\(g\\) là mt biu thc (hàm) tuyn tính c mô hình hóa theo tp bin \\(X\\) \\[g = \\beta_0 + \\beta_1X_1 + \\beta_2X_2 + ... + \\beta_jX_j\\] Tuy nhiên, phiên bn thc dng ca mô hình hi quy logistic ch c nh hình vào nm 1944, khi nhà thng kê Joseph Berkson thit lp mt khái nim quan trng là Log odds và dùng nó làm thang o cho bài toán c lng bin nh giá. Nh ta bit, Odds là t s gia 2 xác sut. Vi \\(p\\) là xác sut thành công (\\(Y=1\\)) và \\(1-p\\) là xác sut tht bi (\\(Y=0\\)), ta có: \\[Odds = \\frac{p}{1-p}\\] T ó, ta có hàm logit là mt công c khác cho phép liên kt trc tip tp bin \\(X\\) và giá tr xác sut \\(Y=p\\). Hàm logit chính là s áp dng hàm logarit t nhiên cho Odds: \\[logit(p) = log(\\frac{p}{1-p})\\] Ta d dàng nhn thy mi liên h nghch o gia 2 hàm logit và hàm logistic c in: T ó, Berkson ã chun hóa hi quy logistic thành mt phng pháp thng kê quy c, s dng hàm logit thay vì logistic, và dùng log(odds) làm thang o, n v cho bin kt qu \\(Y\\) trong mô hình. Sau ó, David Cox (1958) hoàn thin k thut c lng tham s trong mô hình logistic. Sau cùng, vào nm 1972 Nelder và Wedderburn ã hp nht mô hình logistic vào h thng mô hình hi quy tuyn tính tng quát (GLM), mô hình logistic là mt th c bit ca mô hình GLM, c lng giá tr ca \\(\\mu\\) là trung bình ca bin kt qu \\(Y\\) theo quy lut phân phi Binomial và 2 tham s \\(BI(n,\\mu)\\) \\[Pr(Y=y|n,\\mu) = \\frac{n!}{y!(n-y)!}\\mu^{y}(1-p)^{n-y}\\] Ta c lng giá tr ca \\(\\mu\\) bng mt mô hình tuyn tính vi hàm liên kt logit: \\[logit(\\mu) = log(\\frac{\\mu}{1-\\mu}) \\sim \\beta_0 + \\beta_1X_1 + \\beta_2X_2 + ... + \\beta_jX_j \\] Ta thy, nh ngha mô hình hi quy logistic theo lý thuyt GLM và hàm logit d hiu và n gin hn nhiu so vi nh ngha nguyên thy da vào hàm logistic. Nhng vì lý do lch s, ta vn dùng tên gi logistic regression cho loi mô hình này, nhng ta hiu bn cht ca nó ch n gin là mt mô hình GLM vi phân phi Binomial hoc Bernoulli (trng hp c bit khi \\(n=1\\)) 8.8 Mô hình hi quy Logistic cho bin kt qu nh giá Ta s ln lt phân tích 2 mô hình logistic khác nhau cho 2 bin kt qu: 1) kt qu nh giá (thành công hoc tht bi tuyt i v thai din tin trong thí nghim, bin OP_bin) và 2) t l thai din tin trên tng s phôi chuyn (bin OP_rate). Cho kt qu th nht, mô hình áp dng mt trng hp c bit ca phân phi Binomial vi \\(n=1\\), vi n v quan sát là cá th bnh nhân. Mc tiêu ca mô hình là c lng xác sut quan sát c giá tr \\(OP\\_bin = 1\\) cho mi cá th. Mô hình có công thc: OP_bin ~ Protocol*AFC + Thickness + Age; family = binomial (hàm liên kt mc nh là logit). Ni dung ca mô hình nh sau: ## ## Call: ## glm(formula = OP_bin ~ Protocol * AFC + Thickness + Age, family = &quot;binomial&quot;, ## data = df) ## ## Deviance Residuals: ## Min 1Q Median 3Q Max ## -2.2355 -0.9405 0.5561 0.7987 1.6910 ## ## Coefficients: ## Estimate Std. Error z value Pr(&gt;|z|) ## (Intercept) 2.28220 1.61373 1.414 0.157292 ## ProtocolPPOS 3.56952 1.02745 3.474 0.000512 *** ## AFC 0.14222 0.05030 2.828 0.004690 ** ## Thickness 0.10929 0.07437 1.470 0.141679 ## Age -0.14522 0.04414 -3.290 0.001001 ** ## ProtocolPPOS:AFC -0.22953 0.07846 -2.925 0.003439 ** ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## (Dispersion parameter for binomial family taken to be 1) ## ## Null deviance: 244.90 on 205 degrees of freedom ## Residual deviance: 215.36 on 200 degrees of freedom ## AIC: 227.36 ## ## Number of Fisher Scoring iterations: 4 Din gii ni dung kt qu thô ca mô hình: Do s dng hàm liên kt là logit, giá tr c lng ca mô hình hin thi là \\(logit(\\mu)\\) hay \\(log(\\frac{\\mu}{1-\\mu})\\) hay \\(log(Odds)\\), vi \\(\\mu\\) là xác sut t thai din tin trung bình (cho mi cá th). Tt c h s hi quy ang  thang o log(odds). Ta có th chuyn v thang o xác sut bng hàm plogis, hoc v thang o Odds bng hàm exponential. \\(Intercept = 2.28220\\) tng ng vi log(odd) ca xác sut thai din tin  phác  tham chiu (GnRH_ant), trong iu kin giá tr Age, AFC và Thickness gi c nh  mc trung bình ca qun th. \\(ProtocolPPOS = 3.56952\\) tng ng vi s thay i log(odd) ca xác sut thai din tin  phác  PPOS so vi nhóm i chng (GnRH_ant), trong iu kin giá tr Age, AFC và Thickness không i. Các h s hi quy cho AFC,Age và Thickness ln lt ng vi s thay i ca log(odd) xác sut thai din tin khi AFC, Age hoc Thickness tng 1 n v. Vì mô hình có xét hiu ng tng tác gia phác  PPOS và AFC, ta có thêm h s hi quy ProtocolPPOS:AFC; vi ý ngha o lng s thay i ca log(odd) ca xác sut thai din tin khi AFC tng 1 n v và khi s dng phác  PPOS. Mt cách n gin, ta có th xét du ca các h s hi quy này  hình dung v hiu ng mà các bin gây ra cho xác sut ca thai din tin. Mt h s hi quy &gt; 0 cho thy mi tng quan thun (làm tng), ngc li mt h s hi quy &lt;0 cho thy tng quan nghch (làm gim). Pr(&gt;|z|) trình bày giá tr p ca kim nh Wald, nhm ph nhn gi thuyt vô hiu là mt bin không gây ra hiu ng nào c (không có liên h) i vi xac sut OP (h s hi quy = 0). Tuy nhiên, rt khó  thc hin suy din thng kê theo cách này, nên ta s theo con ng c tính marginal effects (hiu ng cn biên) cho các yu t. Gi nh ta mun kho sát hiu ng ca mt bin nh tính có 2 bc giá tr (phác  PPOS hoc GnRH), mô hình s c lng c 2 giá tr xác sut thai din tin trung bình cho 2 nhóm này là \\(\\mu_{PPOS}\\) và \\(\\mu_{GnRH}\\) T ây, ta có th c tính 3 loi marginal effects gm: 1) Marginal risk difference (RD) Tr s RD o lng trc tip s thay i/khác bit/tng phn v xác sut gia PPOS và phác  tham chiu \\[RD = \\mu_{PPOS} - \\mu_{GnRHant}\\] RD cho bit khi dùng phác  PPOS, xác sut t thay din tin s thay i bao nhiêu so vi phác  tham chiu. Vì bn cht ca RD là hiu s gia 2 xác sut, nó ch có th dao ng trong khong \\([-1,1]\\), RD = 0 cho thy không có khác bit (tính tng ng), RD &lt; 0 hoc &gt; 0 cho phép xác nh hiu ng ca phác  nào cao hn/thp hn. Kt qu cho thy: theo c tính trung bình, nhóm bnh nhân dùng phác  PPOS có xác sut thai din tin tng 0.148 (nói cách khác; t l thai din tin tng 14.8%) so vi phác  GnRH_ant, s gia tng này có ý ngha thng kê (khong tin cy không cha giá tr 0, p = 0.036). 2) Marginal Odds ratio (OR) Trong phn trên, ta ã hiu v bn cht ca Odds là mt t s gia 2 xác sut thành công/tht bi. Odds ratio là mt cách  o lng s tng phn gia 2 giá tr Odds tng ng vi 2 bc giá tr ca bin X (2 phác ), theo công thc sau: \\[OR = \\frac{Odds_{PPOS}}{Odds_{GnRHa}} = \\frac{\\mu_{PPOS}/(1-\\mu_{PPOS})}{\\mu_{GnRHa}/(1-\\mu_{GnRHa})}\\] Vì là 1 t s, OR có th &gt;1, và dao ng t 0 n \\(+\\infty\\). Giá tr OR &lt; 1 cho thy hiu ng ca phác  PPOS thp hn so vi nhóm tham chiu, ngc li OR &gt; 1 và càng ln càng cho thy phác  PPOS có hiu qu cao hn. OR = 1 cho thy 2 phác  có hiu ng tng ng nhau. 3) Marginal risk ratio (RR) Risk  ây tng ng vi ý ngha xác sut, kh nng, t l thành công (giá tr \\(\\mu\\) cho mi phác ), risk ratio n gin là t s gia 2 risks. \\[RR = \\frac{\\mu_{PPOS}}{\\mu_{GnRHa}} \\] RR c din gii tng t nh OR, giá tr RR=1 cho thy 2 phác  là tng ng nhau, giá tr RR &gt; 1 cho thy phác  PPOS có hiu qu cao hn, và ngc li RR &lt; 1 cho thy phác  GnRha có hiu qu cao hn. Kt qu OR và RR c trình bày trong bng sau: Theo kt qu này, c giá tr OR và RR u cho thy mt hiu qu u th hn ca phác  PPOS so vi GnRHa i vi kh nng t c thai din tin. S chênh lch v Odds và xác sut thành công gia 2 phác  là có ý ngha thng kê. Ta cng có th tính RD, OR và RR cho các bin nh lng, lúc này 2 bc so sánh là \\(X-1\\) và \\(X+1\\), kt qu cho bit hiu ng khi X gia tng 1 n v. Bng sau ây trình bày giá tr RD, OR và RR cho Age, AFC, Thickness và cho riêng mi nhóm phác . Theo kt qu này, ta thy AFC có tng quan thun (OR &gt; 1 và RR &gt; 1) vi xác sut thai din tin, nhng ch có ý ngha trong nhóm phác  GnRHa; Age có tng quan nghch ý ngha vi kh nng t thai din tin cho c 2 phác  (OR &lt; 1 và RR &lt; 1), trong khi không có liên h ý ngha nào gia Thickness và kh nng t thai din tin. Thc ra, nhng tr s mà ta va c lng bao gm RD, OR hoc RR ch có ý ngha tóm tt (abstraction) và cho bit thông tin v hiu ng  mc  qun th. Hin nay, có mt s tác gi khuyn cáo v nhc im ca vic ch báo cáo hiu ng cho bin nh phân bng mt tr s duy nht, và li ích ca vic cung cp thông tin chi tit hn v toàn th c tính phân phi ca hiu ng trong mu kho sát. Biu  sau ây cho phép i chiu phân phi toàn th ca xác sut t thai din tin cng dn trong 107 cá th dùng phác  GnRHa và 99 cá th dùng phác  PPOS. Chú thích: Hình trên trình bày 2 biu  mt  phân phi cho phép so sánh c im phân phi ca xác sut thai din tin (Trc X) gia 2 phác : GnRHa (màu xanh) và PPOS (màu hng). 2 ng thng không liên tc tng ng vi giá tr trung v ca xác sut này  mi nhóm. Hình nh cho thy có s tng phn rõ nét gia 2 phác , vi u th nghiêng v phác  PPOS. Mt biu  khác cho phép hình dung v cán cân chênh lch ca hiu qu gia 2 phác , n cp  tng cá th. Chú thích: ây là mt biu  tán x cho phép kim tra mc  tng phn / chênh lch gia 2 phác  v xác sut thai din tin. Trc X và Y trình bày 2 thang o xác sut t 0-1 cho mi phác . Mi chm tròn biu th cho mt n v kho sát (cá th bnh nhân), ng phân giác ca biu  biu th cho gi thuyt là hai phác  tng ng hoàn toàn vi nhau. Nhng im tròn nm bên di ng phân giác này có hiu qu GnRH_ant u th hn, trái li vi nhng im nm bên trên ng này, phác  PPOS có hiu ng u th hn. Nhng im nm rt gn và dc theo ng này có hiu qu tng ng gia 2 phác . Các biu  tip theo trình bày v mi liên h gia Tui, AFC và Thickness vi xác sut thai din tin, riêng cho mi nhóm phác : 8.9 Mô hình hi quy Binomial cho t l OP/tng s phôi Trong phn tip theo, ta s phân tích loi kt qu th hai: t l thai din tin trên tng s phôi ã chuyn (bin OP_cum). Mô hình c dng bng th vin gamlss vi cú pháp ging nh mô hình GLM Binomial trong chng trc. Công thc ca mô hình nh sau: cbind(OP_cum, n_ET-OP_cum) ~ Protocol * AFC + Thickness + Age (Nhc li: mô hình GLM Binomial tng quát cn 2 bin  v trí kt qu: s kt qu thành công là bin OP_cum, và s kt qu tht bi, là hiu s gia s phôi chuyn và s thai) tùy chnh family = BI(mu.link = logit) tng ng vi phân phi Binomial vi hàm liên kt logit cho tham s \\(\\mu\\) Ni dung ca mô hình này nh sau: ## GAMLSS-RS iteration 1: Global Deviance = 462.3237 ## GAMLSS-RS iteration 2: Global Deviance = 462.3237 ## ****************************************************************** ## Family: c(&quot;BI&quot;, &quot;Binomial&quot;) ## ## Call: gamlss(formula = cbind(OP_cum, n_ET - OP_cum) ~ Protocol * ## AFC + Thickness + Age, family = BI(mu.link = &quot;logit&quot;), data = df) ## ## Fitting method: RS() ## ## ------------------------------------------------------------------ ## Mu link function: logit ## Mu Coefficients: ## Estimate Std. Error t value Pr(&gt;|t|) ## (Intercept) 0.16961 0.90175 0.188 0.8510 ## ProtocolPPOS 1.39994 0.54026 2.591 0.0103 * ## AFC 0.02922 0.02724 1.073 0.2846 ## Thickness 0.04225 0.03605 1.172 0.2426 ## Age -0.05824 0.02403 -2.423 0.0163 * ## ProtocolPPOS:AFC -0.08438 0.04027 -2.096 0.0374 * ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 ## ## ------------------------------------------------------------------ ## No. of observations in the fit: 206 ## Degrees of Freedom for the fit: 6 ## Residual Deg. of Freedom: 200 ## at cycle: 2 ## ## Global Deviance: 462.3237 ## AIC: 474.3237 ## SBC: 494.2909 ## ****************************************************************** Cách thc din gii mô hình này hoàn toàn ging nh mô hình logistic  trên nên ta không cn nhc li  ây. Ta s i thng n công on c tính 3 tr s marginal effects cho phác  PPOS t mô hình này: Theo kt qu này, có liên h ý ngha gia phác  PPOS và s gia tng ca t l thai din tin cng dn. C th nhóm phác  PPOS có t l thai din tin cao hn trung bình 8.37% (DR = 0.0837, KTC95%: 0.002 - 0.165, p=0.04). T s Odds (OR) và t s nguy c (RR) ln lt là 1.44 và 1.27 u cao hn 1 cho thy hiu qu u th hn ca phác  PPOS, c hai u có ý ngha thng kê. Ta thc hin mô t phân phi toàn th ca hiu ng này qua hai biu  sau: Hình nh này cho thy mc dù phn trùng lp gia phân phi ca xác sut thai din tin  2 phác  là khá cao, vn có mt b phn cá th cho thy hiu qu u th hn ca phác  PPOS, và giá tr trung v ca 2 phân phi cách nhau mt khong gn bng 0.1. Tng t, trên biu  tng hp v xác sut thai din tin  2 phác , phn ln cá th nm  v trí phía trên ng phân giác, cho thy s chênh lch v u th nghiêng v phía phác  PPOS. Cui cùng, ta cng kho sát v liên h gia Tui, AFC và Thickness vi t l thai din tin cng dn tùy theo phác . 8.10 Din gii kt qu ca phân tích Phân tích d liu này cho phép rút ra mt s kt lun nh sau: Kh nng t c thai din tin có th c kho sát di nhiu hình thc: xác sut quan sát c mt kt qu thành công (bin nh giá 0,1) trên cá th bnh nhân, xác sut thành công cho mi n v noãn - hay t l thành công trên tng s phôi c chuyn. Cách thc kho sát có th nh hng n kt qu phân tích thng kê (trong trng hp hin thi, c 2 cách kho sát u cho ra thông ip tng ng, tuy nhiên có s khác bit v giá tr OR, RR hoc RD). Dù kho sát di hình thc nào, thì u dn v công c chung là mô hình GLM vi phân phi Binomial vi 2 tham s \\(n\\),\\(\\mu\\). Mô hình logistic c in là trng hp c bit khi \\(n=1\\). Cách din gii và suy lun thng kê là nh nhau cho c 2 mô hình. Mô hình logistic (hay GLM Binomial) cho phép suy lun thng kê v mi liên h gia 1 bin c lp và mt kt qu xác sut. Ta có th áp dng mô hình này cho nhng kt cc lâm sàng nh phân, hoc t l. 8.11 Thông ip rút gn làm hành trang Trong quy trình th tinh nhân to, tuy có nhiu loi kt cc lâm sàng khác nhau nhng chui kt cc này u có th quy v cùng mt khái nim ó là kh nng (xác sut) thành công tng ng vi mi công on. Khi ã nhn ra bn cht này, ta s thy mô hình tuyn tính tng quát vi phân phi nh thc (và dng c bit ca nó là hi quy logistic) là công c thng kê quan trng nht trong nghiên cu h tr sinh sn, nó cho phép suy lun thng kê cho toàn b chui kt cc k t sau công on ly noãn, bao gm kh nng th tinh, to phôi, th thai, và sinh n thành công. "],["ng-dng-s--mng-nh-hng-không-tun-hoàn-dag.html", "Chng 9 ng dng s  mng nh hng không tun hoàn (DAG) 9.1 t vn  9.2 Bi cnh ca thí nghim 9.3 K hoch phân tích 9.4 Mô t n gin 9.5 S  nhân qu và mô hình DAG 9.6 Xác nh tp hp bin cn hiu chnh 9.7 c lng bng mô hình hi quy logistic 9.8 Thông ip rút gn làm hành trang:", " Chng 9 ng dng s  mng nh hng không tun hoàn (DAG) Biên son: Lê Ngc Kh Nhi, Dng Th Ngc Châu 9.1 t vn  Trong nhng th nghim lâm sàng không phi thit k RCT, nghiên cu sinh thng c khuyn khích hiu chnh các yu t gây nhiu và hip bin thông qua mt phân tích hi quy a bin, nhm c lng chính xác hn hiu ng ca mt can thip i vi kt cc. Vi chuyên ngành h tr sinh sn, hu ht thí nghim c thc hin theo thit k hi cu nên vic loi b tác ng ca các yu t gây nhiu là mt yêu cu quan trng. Tuy nhiên, các nghiên cu v th tinh nhân to t ra mt bài toán khó khn hn rt nhiu cho các nhà thng kê. Ngoài nhng yu t nn nh tui ca ngi ph n, c im xã hi hc, nhng ri lon sinh lý có liên h n tình trng him mun nh mc d tr bung trng, ni tit t, ri lon chuyn hóa glucose thì ti mi công on trong tin trình thí nghim còn phát sinh ra nhiu yu t khác có tính cht k thut - nh liu lng các hot cht và hormone c s dng. Hn na, nh ta ã bit - kt qu ca mi công on có tính k tha và ph thuc vào iu kin trong các công on trc nó. Vì vy, ngay c khi tin hành c thit k th nghim lâm sàng i chng ngu nhiên (RCT), thì s phân nhóm ngu nhiên  thi im khi u quy trình vn không m bo loi tr c hoàn toàn nhng yu t gây nhiu phát sinh trong tin trình can thip. Mc  phc tp ca vn  dn n mt cách làm sai lm và nguy him rt thng thy trong nhiu nghiên cu, ó là ngi ta hiu chnh cho tt c hip bin mt cách mù quáng (thà sai lm hn b sót), iu này hoàn toàn vô ích, thm chí là có hi khi chính vic hiu chnh li làm nhiu hay sai lch hiu ng cn kho sát. ây là mt chng rt ngn nhng có ng dng quan trng, chúng tôi s gii thiu v mt quy trình cho phép xác nh úng nhng yu t cn hiu chnh, bng cách dùng Directed acyclic graph (DAG) (Textor et al. 2016):  th có hng, không tun hoàn. DAG là mt  th có cha liên kt nh hng, nhng không to ra bt c vòng tun hoàn/chu trình (cycle, loop) nào bên trong nó. DAG c s dng  mô hình hóa mi quan h gia các nhân t trong mt h thng hoc tin trình. DAG có lch s phát trin t thp niên 1920-1930, trong ó nn tng là công trình nghiên cu ca Sewall Wright, ngi ã t ra khái nim v phân tích l trình (path analysis)  mô hình hóa quan h gia các bin trong các mô hình thng kê. Ý tng v path analysis ca Wright có ý ngha nn tng cho s phát trin ca phng pháp suy lun nhân qu ngày nay. Sau ó, vào cui thp niên 1970 và trong thp niên 1980, nhà thng kê Judea Pearl ã phát trin lý thuyt ca DAG và ng dng nó trong lnh vc suy lun nhân qu. DAG có vai trò quan trng trong suy lun nhân qu cho nghiên cu y hc. ây là công c giúp cho nhà nghiên cu có th biu din mi quan h gia các bin trong mt h thng phc tp, nhn din vai trò ca tng yu t, xác nh nhng yu t quan trng nht, các yu t có vai trò trung gian, yu t gây nhiu cn hiu chnh. Tp hp các liên kt nh hng ni gia mt yu t và kt cc c gi là l trình nhân qu (Causal path); nhng chui liên kt khác không dn n Y gi là Non Causal path (thí d t 1 hip bin n 1 hip bin khác). T ó, ta có th xác nh chính xác l trình và tác ng ca nguyên nhân gc lên kt qu, ng thi loi b các tác ng gián tip ca các bin trung gian. 9.2 Bi cnh ca thí nghim Mt nhóm nghiên cu mun kho sát hiu qu ca quy trình chun b ni mc t cung bng Letrozole i vi kt cc sinh n thành công (Livebirth), so vi phác  estradiol valerate và progesterone. Mc tiêu cn kho sát trong thí nghim này là quy trình chun b ni mc t cung. Phng pháp th nht là kích thích nh bung trng vi Letrozole ng ung 5mg/ngày t ngày th 3 chu kì t nhiên trong 5 ngày liên tip, sau ó b sung HMG. Phng pháp th hai c gi là chu kì nhân to, bng cách s dng tun t viên nén estradiol valerate và progesterone. Các bnh nhân c áp dng mt trong hai loi phác  COH: phác  i vn hormone gii phóng gonadotropin (GnRH-ant) hoc phác  ng vn GnRH kéo dài tiêu chun (long GnRH-a). Tip theo, bnh nhân c kích hot trng thành noãn bng hCG hoc choriogonadotropin alfa. Chu kì COH kt thúc bng công on thu hoch noãn sau 34-36 gi, sau ó tùy theo ch nh lâm sàng, noãn c th tinh bng mt trong 2 phng pháp ICSI hoc IVF. Cui cùng, quy trình chuyn phôi ti hoc phôi óng bng (FET) c thc hin. Kt cc lâm sàng chính ca nghiên cu là t l sinh sng (Live birth rate) 9.3 K hoch phân tích u tiên ta s xây dng mt s  nhân qu (Causal diagram) di hình thc s  mng nh hng không tun hoàn (directed acyclic graphs: DAG), trình bày mng li liên h, tng tác gia các nhân t khác nhau trong quy trình IVF, dn n kt cc LiveBirth. Da vào mô hình DAG, chúng ta s xác nh yu t can thip, kt cc, và tp hp các yu t gây nhiu cn c hiu chnh (adjusting). Tip theo, ta thc hin mt phân tích hi quy logistic a bin  c lng hiu ng ca phác  Letrozole i vi xác sut LiveBirth, có hiu chnh cho tp hp bin ã c xác nh  trên. Hiu qu cùa Letrozole s c c lng bng average marginal effect thông qua 2 tr s: adjusted Risk difference (RD) và adjusted Odds-ratio (OR). ây là cu trúc d liu cho bài toán: 9.4 Mô t n gin Trong d liu này, bin kt qu là LiveBirth, là mt bin nh phân vi giá tr 1=Thành công và 0=Tht bi. Bng mt c lng n gin, ta thy nhóm chun b ni mc bng Letrozole (mSTC) có t l sinh sng cao hn mt chút (8.7%) so vi nhóm chu kì nhân to (AC), tng ng vi t s OR = 1.42 và RR = 1.21; Tuy nhiên, kt qu này có th b sai lch do nh hng bi nhiu yu t gây nhiu và hip bin trong d liu; do ó chúng ta cn hiu chnh cho nhng yu t gây nhiu này  c lng c chính xác hiu qu c lp ca Letrozole. 9.5 S  nhân qu và mô hình DAG Da vào suy lun và kin thc sinh lý, y hc lâm sàng, ta có th t ra h thng gi thuyt nh sau: Loi can thip chun b ni mc (Letrozole hay chu kì nhân to) là kt qu quyt nh ch quan ca bnh nhân và bác s iu tr, ta gi nh rng nó có th chu nh hng bi Tui bnh nhân, thi gian him mun, loi phác  COS c chn. Trong quá trình can thip, liu dc cht còn da vào BMI và tui bnh nhân. Kt cc sinh n (Birth) thành công hay tht bi (sy thai) là h qu trc tip ca vic th thai thành công (Preg) và thai kì din tin, nó cng ph thuc vào tui ca ngi m (Age), và nhng nguy c bnh lý sn khoa có liên h n tui và BMI. Trc ó, ta có kt cc th thai lâm sàng/thai din tin (Preg), là h qu trc tip ca yu t phôi (Embryo), bao gm phôi có c to thành hay không ? tui phôi ? phm cht ca phôi, tha tiêu chí có th chuyn c, phng pháp chuyn phôi và s phôi chuyn. Ngoài ra, kh nng th thai còn ph thuc vào Tui ngi m, hiu qu ca phác  chun b ni mc t cung,  dày ni mc. Yu t phôi là h qu trc tip ca s noãn thu c (Ooc), kt qu th tinh Fert, loi phác  COS, ngoài ra còn ph thuc vào hormone LH; Kh nng trng thành noãn, biu hin qua s noãn MII là h qu trc tip ca s noãn thu c, liên h vi phác  COS, các hormone s dng trong phác  chun b ni mc, Kh nng th tinh ph thuc vào s noãn MII, loi phng pháp th tinh (Insermination: IVF hay ICSI) S noãn thu c (Ooc) là h qu ca phác  COS, phng pháp chun b ni mc, tui ca bnh nhân, d tr bung trng, nng  FSH và LH  dày ni mc ph thuc vào phng pháp chun b ni mc (Letrozole), có liên h vi BMI, tui bnh nhân. LH và FSH có liên h vi tui và BMI, Phng pháp th tinh (Inserm) và phác  COS c xem là yu t can thip c lp. Ta có th dng s  DAG bng th vin daggity trong R và hin th nó nh di ây 9.6 Xác nh tp hp bin cn hiu chnh Mc tiêu ca chúng ta là c lng hiu ng ca Letrozole i vi PPOS, nh vy ta cn xác nh con ng kt ni gia PPOS là im xut phát và OP là ích n. Trên s  DAG, có rt nhiu l trình có kh nng ni kt Letrozole và kt cc Birth, ta có th ch ra 10 con ng ngn nht trong danh sách này: ## [1] &quot;Letroz -&gt; EndThck -&gt; Preg -&gt; Birth&quot; ## [2] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; BMI -&gt; Birth&quot; ## [3] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; Birth&quot; ## [4] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc -&gt; MII -&gt; Fert -&gt; Embryo &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [5] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc -&gt; MII -&gt; Fert &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [6] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc -&gt; MII &lt;- Stim -&gt; Embryo &lt;- Fert &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [7] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc -&gt; MII &lt;- Stim -&gt; Embryo &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [8] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [9] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc &lt;- Stim -&gt; Embryo &lt;- Fert &lt;- LH &lt;- BMI -&gt; Birth&quot; ## [10] &quot;Letroz -&gt; EndThck -&gt; Preg &lt;- Age -&gt; FSH -&gt; Ooc &lt;- Stim -&gt; Embryo &lt;- LH &lt;- BMI -&gt; Birth&quot; S  DAG cho phép chúng ta xác nh tp hp nhng hip bin nào cn phi c hiu chnh (vic hiu chnh này s ct t liên kt gia Letrozole và/hoc kt cc Birth vi nhng yu t gây nhiu, cho phép c lng hiu ng c lp ca Letrozole). Theo kt qu tìm c, ta có th hiu chnh cho tp hp 3 bin : Age, BMI và phác  COS (Stim) ## { Age, BMI, Stim } 9.7 c lng bng mô hình hi quy logistic Sau ây, ta s ln lt thc hin phân tích thng kê bng mô hình logistic trong 3 trng hp: Trng hp hiu chnh máy móc và quá áng Trong thc hành thng kê, có mt quan nim rt sai lm và nguy him khi cho rng ngoài can thip và kt cc, tt c nhng yu t còn li u cn phi c hiu chnh trong phân tích hi quy logistic a bin. Vic hiu chnh máy móc và quá áng cho toàn b bin s trong h thng có th dn n hu qu có hi khi trit tiêu chính hiu qu mà ta ang cn c lng. Trong thí d hin thi, nu ta hiu chnh cho tt c bin s, kt qu thu c là nh sau: Ta có th thy ây là mt kt qu negative, nó cho thy Letrozole không có hiu qu nào c i vi kt cc LiveBirth. Khi không hiu chnh gì c Ngc li, nu ta không hiu chnh cho bt c yu t nào c (tng ng vi mt mô hình logistic n bin ch xét yu t can thip), ây cng không phi là gii pháp úng n. Nh ta thy sau ây: Da theo kt qu này, Letrozole có mt hiu qu tích cc i vi kt cc LiveBirth, tuy nhiên kích thc hiu ng rt nh và gn nh không có ý ngha thng kê (p rt gn vi 0.05). Khi hiu chnh va  và chính xác Cui cùng, ta s hiu chnh cho úng tp hp yu t gây nhiu mà ta ã phân lp c t s  DAG, ó là Age, BMI và loi phác  COS. Kt qu này cho thy Letrozole có hiu qu tích cc và có ý ngha thng kê i vi kh nng sinh sng, vi khác bit v t l Live Birth so vi chu kì nhân to = 8.96% (p=0.04) và OR = 1.437 (p = 0.04). 9.8 Thông ip rút gn làm hành trang: Vic xác nh chính xác nhng yu t nào cn c hiu chnh có vai trò rt quan trng i vi tính chính xác ca phân tích thng kê trong nghiên cu lâm sàng. C hai thái cc: không hiu chnh gì c hoc hiu chnh máy móc quá áng u sai lm và có th dn n sai lch trong kt lun v hiu qu can thip. S  mng li nh hng không tun hoàn (DAG) cho phép ngi bác s ch ng dùng kin thc y hc  nh hng cho phân tích thng kê, xác nh tp hp yu t cn hiu chnh mt cách chính xác, hp lý và va , m bo kt qu suy din thng kê chính xác t mt mô hình úng và có c s khoa hc. References "],["mô-hình-machine-learning-kh-din.html", "Chng 10 Mô hình Machine learning kh din 10.1 Gii thiu 10.2 Bi cnh ca thí nghim 10.3 K hoch phân tích: 10.4 Chun b và thm dò d liu 10.5 Phân chia d liu 10.6 Thit lp mô hình phân loi 10.7 Các tiêu chí hiu nng mô hình phân loi nh phân 10.8 Hun luyn mô hình trên toàn th d liu tp Train 10.9 Kim nh c lp hiu nng mô hình 10.10 Phân tích hu kim bng k thut SHAP 10.11 Vai trò ca các thông s óng góp vào kt qu tiên lng 10.12 Bàn lun: 10.13 Kt lun 10.14 Thông ip rút gn làm hành trang", " Chng 10 Mô hình Machine learning kh din Biên son: Lê Ngc Kh Nhi 10.1 Gii thiu Trong công vic hng ngày, ngi bác s Sn Ph khoa thng phi a ra nhng quyt nh lâm sàng. Hu ht nhng quyt nh này mang tính cht nh phân, nh xác nh chn oán, tiên lng nguy c i vi thai kì, d báo kh nng thành công ca mt can thip iu tr.., da vào các thông tin thu nhn c ti thi im ó. Công vic h tr sinh sn cho bnh nhân him mun t ngi bác s vào mt tin trình phc tp hn, vi din tin kéo dài qua nhiu bc và nhiu quyt nh phi a ra hn ti mi bc, gm ánh giá c bn, chn la hình thc can thip, iu chnh yu t k thut  mi công on trong chu kì, t kích thích bung trng, chun b ni mc, trng thành noãn, thu hoch noãn, th tinh nhân to, ánh giá phm cht phôi, lu tr phôi, n chuyn phôi - theo dõi thai kì n khi sinh n. Không ch ngi bác s nhng chính bnh nhân cng có nhu cu d báo v kh nng thành công  tng giai on, liu có nên áp dng mt k thut can thip c th hay không ? Nhng quyt nh này có th nh hng tích cc hay tiêu cc i vi chi phí và hiu qu iu tr cng nh tâm lý ca bnh nhân và uy tín ca dch v y t.  có th a ra quyt nh chính xác, trong tâm trí ngi bác s phi thc hin nhiu phân tích và kim nh. Quy trình này là th công nhng cn nhanh chóng và kp thi. Các t chc chuyên môn thng a ra gii pháp nhm h tr ngi bác s, n gin hóa phân tích, suy lun bng nhng h thng quy tc, bng kim, khuyn cáo, lu  chn oán, phác  can thip/iu tr, nhng công c lng giá nhanh nh quy tc phân loi, thang im, b câu hi, mo nh Bn thân ngi bác s cng t tích ly kinh nghim  hình thành các quy tc ch quan vi  nhy và chính xác nht nh. Mt cách tip cn khác là bng khoa hc thng kê, da vào d liu  thit lp các mô hình tiên lng. Trong thi i s hóa, ã xut hin thêm nhiu phng tin mi nh bnh án in t, công ngh chn oán và xét nghim mi, thit b liên lc và tra cu cá nhân nh máy tính cá nhân, smartphone và tablet PC c kt ni mng Internet Vi h thng hin i này, ngi bác s tr thành mt i tng giao tip trong mng li thông tin và tip nhn thêm mt hình thc h tr mi do máy tính thc hin - ó là nhng quy lut quyt nh da vào k thut Machine learning (máy hc). Khác vi nhng quy lut c xây dng t kinh nghim ch quan và phân tích th công trc kia, quy lut tiên lng Machine learning c to ra t d liu thc nghim, c ti u hóa, t ng hóa và có kh nng phân tích lng thông tin ln và a chiu, vt khi kh nng phân tích th công ca con ngi. Vi nhu cu và ng dng tân tin này, Machine learning (Zumel and Mount 2014) c du nhp vào h thng phng pháp nghiên cu y hc trong tt c chuyên khoa và tr thành trào lu ni bt trong mt thp k va qua. Các thut toán Machine learning hin i nh Random Forest, XGboost, Deep neural network ã chng t hiu qu vt tri so vi các mô hình thng kê c in, và dn c công nhn nh mt gii pháp chính thng, thay th cho mô hình hi quy tuyn tính và hi quy logistic trong nhng nghiên cu v mô hình tiên lng và thit lp quy lut chn oán. Tuy hiu qu hn v  chính xác, các mô hình Machine learning li t ra mt tr ngi, ó là gii hn v tính tng minh và kh nng din gii. Mô hình càng chính xác thì li càng phc tp v cu trúc và c ch vn hành, n mc chúng tr thành nhng hp en (blackbox models). Ngi dùng không th ánh giá v  tin cy và hp lý ca kt qu tiên lng mà các mô hình này sinh ra. Ngành khoa hc d liu ã n lc gii quyt vn  này và gn ây ã t nhiu thành tu áng k khi xây dng c mt s k thut din gii mô hình ph quát và hiu qu, nh LIME (Local Interpretable Model-Agnostic Explanations ca Ribeiro nm 2016) hoc SHAP (SHapley Additive exPlanations ca Lundberg và Lee nm 2017) (Lundberg et al. 2020). T ây sinh ra mt nhánh chuyên  mi là Machine learning kh din (explainable machine learning) (Molnar 2022). K thut Machine learning kh din cho phép tr li nhiu câu hi quan trng khi vn dng mô hình Machine learning vào thc tin,  c cp  qun th và cá th: C ch vn hành ca mô hình nh th nào ? (Da trên c s nào mô hình a ra kt qu hin thi ?), vai trò ca mi thông s d liu ã óng góp nh th nào vào kt qu d báo ? c ch này có phù hp không vi quy lut sinh lý bnh ? Không ch có li cho bnh nhân và bác s lâm sàng, k thut Machine learning kh din còn m ra mt c hi mi cho nghiên cu y hc, vì nó cho phép nhà khoa hc s dng bt c mô hình Machine learning nào, ngay c nhng mô hình phc tp nht - nh mt công c suy din thng kê mi, thay th cho nhng công c truyn thng nh mô hình hi quy tuyn tính hoc hi quy logistic, nhm kho sát vai trò ca mi thông s lâm sàng i vi kt qu. Trong chng này, chúng ta s cùng nhau tìm hiu v phng pháp suy din thng kê hin i s dng mô hình Machine learning kh din thông qua mt nghiên cu có thc. 10.2 Bi cnh ca thí nghim Ta s áp dng phng pháp Machine learning kh din  gii quyt mt nghiên cu vi mc tiêu kép: Tiên lng và Din dch. Ta s xây dng mt mô hình Machine learning  d báo kh nng th thai lâm sàng thành công (clinical pregnancy), da vào các thông s v phm cht và hình thái hc ca phôi, sau ó dùng k thut din gii mô hình SHAP  kho sát vai trò óng góp ca mi bin s trong mô hình i vi kt qu tiên lng. Thí nghim c tin hành trên mt b d liu có thc t nghiên cu ca Kemal Ozgur và cng s ti Th Nh K (J Assist Reprod Genet. 2021 May;38(5):1077-1087. doi: 10.1007/s10815-021-02110-7.). Nghiên cu này có mc tiêu kho sát vai trò ca mt s c tính ca blastocyte nh t l to phôi, tui phôi, expansion, hình thái trophectoderm cho phép tiên lng kh nng th thai lâm sàng thành công trong quy trình chuyn phôi ông lnh. D liu này t ra mt bài toán phân loi 2 nhãn (nh phân) vi mc tiêu d báo kh nng th thai lâm sàng thành công ti thi im ngay sau công on th tinh nhân to và trc công on chuyn phôi. Ngoài 5 thông s nn là Tui ca ngi ph n, mc  d tr bung trng (AFC), loi vô sinh nguyên phát hay th phát (Prim_Inf), loi k thut kích hot trng thành noãn (Trigger: h=hCG, a = agonist hay d=dual trigger) và t l to phôi (blasturation rate), d liu u vào ca mô hình còn xét thêm 8 thông s v hình thái và s phát trin ca phôi, bao gm: Day_BVitrif = day of blastocyst vitrification (tui ca phôi), hay thi im vic ánh giá mc  phát trin ca blastocyte c tin hành: vào ngày th 4 (±100 gi), ngày th 5 (±116 gi) hoc ngày th 6 (±140 gi). Blast_size = kh nng tng trng v kích thc ca blastocyte, mt bin s ri rc theo thang im t 1 n 5: blastocyst rt sm vi blastocoel chim không quá mt na phôi; blastocyst sm vi blastocoel chim hn mt na phôi; blastocyst y  vi blastocoel hoàn toàn lp y phôi; blastocyst m rng vi blastocoel tng kích thc phôi và gim  dày ca v; và (5) blastocyst n vi các t bào trophoblast bt u phình lên qua v (Giá tr tham chiu = 3). dSize: s thay i ca kích thc này, bin gi nh lng, ri rc gm 3 bc giá tr : -1 = co rút, 0 = không i và 1 = tng kích thc (giá tr tham chiu = 0) Blast_ICM = phm cht v hình thái (inner cell mass quality) c ánh giá theo các tiêu chí sau: nhiu t bào cht ch; vài t bào c nhóm li thoáng hn; và (c) rt ít t bào. Blast_TE: phân loi phm cht trophectoderm, c ánh giá theo các tiêu chí sau: nhiu t bào to thành mt mô liên kt cht ch; vài t bào to thành mt mô liên kt thoáng hn; và (c) rt ít t bào ln. Hai bin này thuc loi nh tính ri rc gm 3 bc giá tr a,b,c. dICM và dTE: s thay i v hình thái, mt bin gi nh lng gm 3 bc giá tr ri rc: -1 = gim, 1= tng và 0 = không thay i (giá tr tham chiu = 0). Sau ây là tên vit tt ca các bin trên trong d liu gc: ## [1] &quot;ClinPreg&quot; &quot;Age&quot; &quot;Day_BVitrif&quot; &quot;Blast_size&quot; &quot;Blast_ICM&quot; ## [6] &quot;Blast_TE&quot; &quot;dSize&quot; &quot;dICM&quot; &quot;dTE&quot; &quot;BMI&quot; ## [11] &quot;Prim_Inf&quot; &quot;AFC&quot; &quot;Trigger&quot; &quot;Blasturation&quot; 10.3 K hoch phân tích: Thí nghim này cn dùng các th vin sau ây: Nh thng l, h sinh thái tidyverse là nn tng cho vic thao tác trên d liu (các th vin tidyr, dplyr) và  ha thng kê (ggplot2). Cho phân tích Machine learning, ta s dùng thut toán Extreme gradient boosting nên cn th vin xgboost, ngoài ra quy trình hun luyn và kim nh mô hình Machine learning s c thi hành theo mt pipeline (chui công on lin mch), c h tr bng th vin tidymodels. Ta dùng th vin SHAPforxgboost và shapviz  thc hin din gii mô hình bng k thut SHAP. Ngoài ra, ta s dùng th vin lvplot  v mt phiên bn ca biu  boxplot Quy trình phân tích gm 6 bc c tóm tt trong s  sau: Bc 1: Trc khi to mô hình Machine learning, ta cn thm dò d liu. Mc tiêu ca công on này nhm hình thành mt khái nim ban u v cu trúc và ni dung ca d liu, bao gm: c tính phân b ca các bin, và quan h tim n gia chúng vi kt qu mà ta cn tiên lng/phân loi. Bc 2: Theo quy c, thí nghim mô hình Machine learning luôn gm 2 công on: thit lp mô hình và kim nh hiu nng ca mô hình này.  m bo tính khách quan và  tin cy ca kt qu, mô hình phi c kim nh mt cách c lp trên d liu mi mà nó cha tng thy qua trong quá trình hun luyn. Do ó, công on hun luyn và kim nh mô hình s dùng 2 tp d liu riêng bit (train set và test set), c phân chia ngu nhiên t tp d liu gc. Bc 3: Mt quy trình kim chng chéo lp li (repeated k folds cross-validation) cn c thc hin nhm chng minh trng thái ti u và n nh ca mt thit k mô hình (thut toán và các tham s k thut), trc khi áp dng thit k này  to ra mô hình thc s. Quy trình này c tin hành trên tp d liu hun luyn (train set). Bc 4: ây là công on xây dng mô hình thc s. u tiên mt mô hình s c khi to, sau ó s c khp vi toàn b d liu trong tp train set, tin trình hun luyn dng li khi mô hình t hiu nng ti u. Bc 5: Mô hình cui cùng s c kim nh mt cách c lp trên d liu tp kim nh (test set). Bc 6: Áp dng k thut SHAP  din gii c ch ca mô hình, ánh giá mc  quan trng ca các bin s trong mô hình,  cp  qun th hoc cá th. 10.4 Chun b và thm dò d liu D liu gc sau khi ti vào R, s c biên tp li nh sau: Chuyn 2 bin nh tính Blast_ICM và Blast_TE (vn có 3 bc giá tr a,b,c) thành nh dng factor. Chuyn nh dng bin Prim_Inf (loi him mun) thành factor, sau ó áp dng hàm recode_factor  c mã hóa li giá tr 0 = Primary và 1 = Secondary Làm tng t cho bin Trigger, ta mã hóa li tên y  ca phng pháp trigger: a = Agonist, h = hCG và d = Dual. Vic chuyn dng các bin s có bn cht nh tính thành factor cho phép thc hin chính xác và ng b các quy trình s ch d liu trong th vin recipes, ví d to dummy variable cho toàn b bin nh tính. Cui cùng ta thay i nh dng d liu cho bin ClinPreg (chính là bin kt qu trong mô hình) t int (0,1) thành factor. Lu ý rng cho mô hình phân loi (classification) XGboost yêu cu bin kt qu phi có nh dng factor. ây là cu trúc ca d liu gc sau khi biên tp: ## &#39;data.frame&#39;: 1136 obs. of 14 variables: ## $ ClinPreg : Factor w/ 2 levels &quot;0&quot;,&quot;1&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ Age : num 37 35 33.6 30.7 24.4 ... ## $ Day_BVitrif : int 4 4 4 4 4 4 5 4 4 4 ... ## $ Blast_size : int 3 3 3 3 3 3 3 3 3 3 ... ## $ Blast_ICM : Factor w/ 3 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ Blast_TE : Factor w/ 3 levels &quot;a&quot;,&quot;b&quot;,&quot;c&quot;: 1 1 1 1 1 1 1 1 1 1 ... ## $ dSize : int 1 1 1 1 1 1 0 1 1 1 ... ## $ dICM : int 1 1 1 1 1 1 1 0 1 1 ... ## $ dTE : int 1 1 1 1 1 1 1 1 1 1 ... ## $ BMI : int 30 22 32 21 23 27 35 27 42 20 ... ## $ Prim_Inf : Factor w/ 2 levels &quot;Primary&quot;,&quot;Secondary&quot;: 1 1 1 1 2 1 1 1 1 1 ... ## $ AFC : int 1 3 6 7 7 10 10 11 11 11 ... ## $ Trigger : Factor w/ 3 levels &quot;Agonist&quot;,&quot;hCG&quot;,..: 3 1 1 1 3 3 3 1 1 2 ... ## $ Blasturation: num 1 0.333 0.667 1 0.2 ... Tip theo, ta s thm dò d liu mt cách trc quan s dng các biu  thng kê phù hp riêng cho nhóm bin liên tc và bin nh tính. Các biu  này giúp chúng ta hình dung v (1) c tính phân b ca bin, và (2) mi liên h gia các bin này và bin kt qu (thai lâm sàng). 10.4.1 Các thông s nh tính, ri rc  kho sát phân b (tn sut) và liên h gia các bin nh tính, ta v biu  stacked bar bng hàm geom_bar vi tham s stat=count, position=fill. Chú thích: Các biu  ct chng (stacked bar plots) trình bày phân phi ca 9 bin nh tính/ri rc, và liên h gia các bin này vi kt cc thai lâm sàng (thành công: màu xanh, tht bi: màu ). Hình nh này cho cm nhn rng mt s c tính v hình thái ca phôi nh Tui phôi (Day), ICM, TE có th liên h vi kt qu thai lâm sàng (vì có s tng phn rõ v t l thai lâm sàng  mi phân nhóm), ngc li các yu t nh phng pháp trigger, kích thc phôi thì có v không nh hng n kt qu v thai lâm sàng. 10.4.2 Các bin s liên tc Cho các bin liên tc, ta có th dùng biu  mt  phân phi (hàm geom_density)  so sánh c tính phân phi ca bin ó gia 2 phân nhóm kt cc thai lâm sàng: Kt qu cho thy mc  tng phn rt thp v phân phi ca Age, AFC, BMI và l to phôi gia 2 nhóm kt cc, iu này gi ý rng vic tiên lng kt qu có thai t các bin này s là mt tác v khó khn. Mi liên h gia các bin s liên tc vi kh nng t c thai lâm sàng còn có th c kho sát bng  th ca hàm logistic (hay mt mô hình GLM vi phân phi nh thc).  làm vic này, u tiên ta to mt hàm binomial_smooth da trên hàm geom_smooth vi mô hình logistic c lng kt qu y=xác sut thai lâm sàng, theo giá tr mt bin liên tc x và có s dng hàm b-spline bc 3  tái hin c quy lut phi tuyn tính gia y và x nu có. Kt qu cho thy : bin AFC tng quan thun tng i rõ nét vi xác sut thai lâm sàng, bin Age có tng quan nghch áng k; t l to phôi cng có liên h vi xác sut kt cc nhng theo mt quy lut phc tp hn và hiu ng yu. Giá tr BMI không có liên h áng k vi xác sut kt cc thai lâm sàng. Cui cùng, ta có th dùng mt s dng biu  2 chiu (tán x, hi quy và mt  phân phi)  kho sát hiu ng ca quan h tng tác gia 2 bin liên tc i vi bin kt qu. Ta có th dùng th vin GGally  dng h thng biu  này. Kt qu phân tích trc quan cho thy s kt hp/tng tác vi nhau gia mt s bin, ví d Tui ngi m và tui phôi, tui và BMI, tui và AFC, vv có th to hiu ng phân lp v kt cc thai lâm sàng (trong không gian d liu 2 chiu). Ngoài ra, ta cng nhn ra rng hin tng t tng quan ln nhau gia các bin s là rt him, ngoi tr mt s cp bin có tng quan thun hin nhiên nh Age và BMI, kích thc và tui phôi, hoc tng quan nghch nh AFC và Age (nhng hiu ng tng quan này cng khá yu). 10.5 Phân chia d liu K t lúc này, ta s áp dng nguyên tc v chui công on lin mch và theo trình t (tidying) cho mô hình thng kê mà tác gi Max Kuhn t ra, thông qua h thng th vin tidymodels (Kuhn and Silge 2022). Công on u tiên là phân chia d liu. T d liu gc gm 1136 n v cá th (instances), chúng ta s phân chia ngu nhiên thành 2 tp d liu c lp: tp hun luyn (train subset) có t l kích thc ln hn (70%, n=795) dùng  dng mô hình và tp d liu kim nh (test subset) có kích thc nh hn dùng  kim nh mô hình (30%, n=341). Vic phân chia này c thc hin bng hàm initial_split(prop = 0.7)  to ra danh sách chn mu, sau ó áp dng 2 hàm training và testing lên danh sách  to ra 2 dataframe train_data và test_data. 10.6 Thit lp mô hình phân loi 10.6.1 Bc 3a) Công on s ch d liu Công on tip theo ca quy trình là s ch d liu, mc tiêu là to ra cu trúc d liu u vào cho mô hình Machine learning. Công on s ch d liu c thc hin bng hàm recipe() ca th vin recipes (thuc v h thng tidymodels). Ta cn cung cp cho hàm recipe() hai thông tin: dataframe d liu gc, và công thc ca mô hình theo cú pháp: Tên bin kt qu ~ tên các bin c lp. Hàm này s to ra mt cu trúc có ý ngha nh bn phác tho k hoch/công thc nu n c bn cho thí nghim. T công thc mô hình, recipe nhn din c vai trò ca các bin trong d liu, thí d trong trng hp này, khi dùng công thc: ClinPreg ~ ., hàm recipe s nhn ra ClinPreg là bin kt qu (response), và tt c nhng bin còn li có vai trò yu t d báo (predictors), và thí nghim s c tin hành trên train_data. Sau ó, ta có th tùy chnh, thêm vào nhng công on hoán chuyn d liu khác, thông qua các hàm step_xxx. Nh trong trng hp hin thi, ta mun chuyn mi bc giá tr ca toàn b bin nh tính thành bin nh phân bng hàm step_dummy(all_nominal_predictors()). K thut này gi là nh phân hóa bin nh tính. Thí d bin Blast_ICM s c chuyn thành 3 bin nh phân Blast_ICM_a, Blast_ICM_b và Blast_ICM_c. 10.6.2 Khi to mô hình XGBoost Thc ra, thí nghim machine learning u có nguyên lý rt n gin. Mc tiêu t ra là thit lp và ti u hóa mt hàm cho phép liên kt gia mt tp d liu u vào (các bin s hay còn gi là thuc tính - features) và mt kt qu (outcome). Cho bài toán phân loi 2 nhãn (binary classification task) hin thi, kt qu là mt giá tr xác sut cho nhãn positive (xác sut th thai lâm sàng thành công). Hàm thng kê này s c khp (fit) vi d liu, trong tin trình hun luyn thut toán ca mô hình s hc thông tin t d liu u vào và t ti u hóa hiu nng ca nó bng cách gim thiu giá tr ca hàm mt mát (loss function), cho n khi t trng thái ti u, n nh. Quy trình phân tích hi quy logistic trong thng kê c in là mt trng hp c bit, hàm thng kê là mô hình tuyn tính. Phng pháp Machine learning có nhiu loi thut toán mô hình cho chúng ta la chn và XGboost ch là mt trong các công c mô hình này. Trong phm vi gii hn ca tài liu dành cho bác s lâm sàng, chúng tôi s không trình bày quá sâu v lý thuyt ca mô hình XGboost, nhng ch mô t khái quát cho phép bn c hình dung v c ch hot ng và nhng u im ca loi mô hình này. Extreme Gradient Boosting (XGBoost) (T. Chen 2014) là mt thut toán Machine learning c phát trin bi tác gi Chen và ng nghip ti hãng d liu DMLC vào nm 2014. ây là mt mô hình tp hp vi cu trúc gm nhiu n v cây quyt nh (decision tree). Cây quyt nh là mt h thng quy lut phân chia d liu c biu din thành s  hình cây phân nhánh. Mi nút phân nhánh t ra mt câu hi có tính nh phân liên quan n 1 bin s X: Giá tr bin s X cao hn hay thp hn 1 ngng t. Nu X &lt; t, ta r nhánh sang trái, nu X &gt; t ta r sang phi. Mi nhánh có th dn n mt câu hi khác, hoc mt nhãn phân loi. Bên trong mô hình XGboost gm rt nhiu cây quyt nh, mi cây c xây dng tun t và liên kt vi nhau nhm khc phc sai lm ca cây trc ó, t ó tng cng liên tc hiu qu tiên lng và gim thiu li d báo (thut toán gradient boosting).  mi lt hun luyn, thut toán XGboost s chn ngu nhiên mt tp con t d liu hun luyn, và to ra mt cây quyt nh, cây này có th có  sâu khác nhau tùy thuc vào thông s c thit lp nhng vn là mt quy lut yu. Mi cây quyt nh s c ánh giá bng cách tính toán hàm mt mát trên tp d liu hun luyn. Hàm mt mát này c tính bng cách so sánh giá tr d oán ca cây quyt nh vi giá tr thc t ca nhãn kt qu ích. XGBoost s dng phng pháp gradient boosting  ti u hóa hàm mt mát. Phng pháp này cp nht cây quyt nh mi bng cách tính toán gradient ca hàm mt mát và cp nht các trng s ca cây  gim thiu giá tr ca hàm này. XGBoost còn s dng các k thut iu chnh (regularization) nh L1, L2 và gin lc cây quyt nh (pruning), cùng mt s gii hn khác do ngi dùng t ra nh tc  hun luyn (learning rate), kt thúc hun luyn sm, gii hn s cây ti a và  sâu ca cây  ngn nga hin tng mô hình quá khp vi d liu. Tin trình hun luyn dng li khi hiu nng mô hình t trng thái ti u và không còn kh nng gia tng hn na. Khi vn hành  tiên lng kt qu, mô hình XGboost tp hp tt c nhng cây quyt nh bên trong nó, nh sc mnh ca s ông nên dù mi cây quyt nh có hiu nng yu nhng khi kt hp vi nhau s to ra kt qu tiên lng chính xác. Trong quy trình tidying model, mô hình là mt b phn c lp, c khi to riêng và ráp ni vào quy trình khi vn hành. Ta khi to mô hình XGBoost bng hàm boost_tree ca th vin tidymodels. Ta có th thay mô hình XGboost bng 1 mô hình khác nh Random Forest. Các tham s k thut (hyper parameters) khác s c mô t trong hàm này. Cho mô hình xgboost hin ti, ta t các tham s k thut gm: engine = xgboost: Th vin tidymodel cho phép tùy chn nhiu thut toán khác nhau ca mi loi mô hình qua tham s engine, thí d vi mô hình cây tp hp ta có th chn dùng thut toán Random Forest, xgboost hoc LightGBM, mode = classification: xác nh mc tiêu ca bài toán là phân loi trees = s lng cây quyt nh, ta chn giá tr 500 tree_depth =  sâu ti a ca mi cây quyt nh, ta chn giá tr = 10. Lu ý rng giá tr quá cao có th cn thit cho  chính xác cao nhng d gây hin tng overfitting. learn_rate = tc  hun luyn. Tc  cao y nhanh tin trình hun luyn (mô hình sm i n trng thái ti u), nhng hiu nng có th kém, tc  thp cho phép ci thin hiu nng sau mi lt mt cách tinh t hn nhng làm chm tin trình hun luyn. 10.6.3 To workflow Sau khi ã có recipe (bn k hoch cho quy trình) và model (mô hình), ta s kt hp 2 b phn này li  to ra quy trình (workflow) nh sau: Dùng hàm workflow()  khi to mt quy trình rng dùng hàm add_recipe()  a recipe vào quy trình dùng hàm add_model()  a model vào quy trình n ây, ta tm dng mt chút  tìm hiu v công on kim nh chéo, trc khi dng mô hình thc s. 10.6.4 Thc hin kim nh chéo lp li 10x10 Kim nh chéo (cross-validation) là mt k thut cho phép ánh giá khách quan, ph quát và chính xác hiu nng ca mt thit k mô hình. B d liu ban u s c chia ngu nhiên thành k khi (block) riêng bit, mt bn thit k mô hình xác nh s c khp vi d liu ca (k-1) khi, và kim nh trên 1 khi còn li, quy trình này c lp li k ln, và ta c tính hiu nng trung bình ca k phiên bn mô hình khác nhau. Ví d trong trng hp này ta lp li 10 ln quy trình kim nh chéo 10 khi (10x10 CV)  to ra 100 phiên bn mô hình khác nhau, mi phiên bn u c kim nh c lp. Nh vy  mi lt, u m bo rng mô hình c kim tra trên d liu mi mà nó cha tng thy qua trong quá trình hun luyn (tính khách quan và ph quát). Vic phân chia ngu nhiên và lp li nhiu lt m bo toàn b d liu u c dùng cho c 2 công on, và ta có th chc chn v kt qu kim nh (tính ph quát và chính xác). 10.7 Các tiêu chí hiu nng mô hình phân loi nh phân Trc khi tin hành quy trình này, ta s tìm hiu v nhng tiêu chí nào s c dùng  ánh giá hiu nng ca mô hình phân loi nh phân. u tiên, ta có th dùng Confusion matrix (tm dch: ma trn tng hp/nhm ln): bn cht ca nó là 1 bng chéo 2x2, trình bày t l tng hp và bt xng gia quan sát thc t và kt qu phân loi ca quy lut cn kim tra, hay nói cách khác, t l phân b ca 4 t hp: TP (True Positive: phát hin úng), TN (True Negative: loi tr úng), FP (False positive: phát hin nhm) và FN (False negative: loi tr nhm). ây là mt hình thc trình bày kt qu n gin nhng li cung cp lng thông tin rt ln. Thc vy, ng chéo ca confusion matrix cho ta thy ngay lp tc giá tr ca  nhy (Sensitivity, góc di phi), và  c hiu (Specificity: góc trên trái). Hn na, TP,TN,FP,FN là 4 ch s c bn, t ó cho phép suy ra kt qu ca hu ht nhng ch s khác. Do ó ch cn trình bày confusion matrix, ta cung cp cho ngi c tt c thông tin cn thit  tính tt c nhng ch s quy c nhm ánh giá hiu nng phân loi. Lu ý rng  ây tác gi s dng thut ng Phát hin/Loi tr thay vì dch sát ngha Dng tính/Âm tính Tht và Gi nh mt s tài liu thng kê hay dùng, vì cách dch ó không rõ ngha: Positive hay Negative ch là tên gi ca 2 nhãn giá tr, mang tính quy c (trong ng cnh v mt xét nghim chn oán) và có ý ngha tng i tùy theo mc tiêu ca ngi dùng. Chính mc ích hành ng phân loi mi có ý ngha thc s. Nh vy, Positive dùng cho iu ta quan tâm tìm kim/cn phát hin, và Negative cho hành ng loi tr (th còn li). Ta nên din t TP là chn oán/phát hin úng/trúng, TN là loi tr úng, FP là chn oán/phát hin nhm/sai, FN là b sót, loi tr nhm/sai. Trong thc hành, ngi ta quan tâm n tính hu dng ca mô hình, hai ch s o lng tính hu dng là  nhy và  c hiu. nhy (sensitivity) o lng kh nng phát hin úng cá th Positive khi áp dng quy lut cho mt qun th cha toàn i tng Positive. Nh vy, Sensitivity chính là True positive rate (TPR): \\[TPR = Sensitivity = \\frac{TP}{TP+FN} = \\frac{TP}{\\sum Positive}\\]  c hiu (Specificity) o lng kh nng loi tr úng cá th Negative, khi áp dng quy lut cho mt tp hp toàn b u thuc loi Negative; nh vy Specificity chính là True negative rate (TNR). \\[TNR = Specificity = \\frac{TN}{TN+FP} = \\frac{TN}{\\sum Negative}\\] Ta có nhn xét thú v nh sau v 2 ch s trên: Sensitivity và Specificity có tính cht giao hoán. Chúng ch mang ý ngha tng i vì c quy c bi mc tiêu ca hành ng phân loi (iu ta mun xác nhn/loi tr). Sensitivity và Specificity luôn phi i cp vi nhau, vì chúng b sung cho nhau. Cho mc tiêu chn oán, ngi bác s thng mun phát hin bt thng/bnh lý (và loi tr trng thái bình thng), tuy nhiên s thay i bt thng ca mt im s tiên lng có th biu hin theo 2 chiu (tng hoc gim so vi 1 ngng ct), tùy c ch sinh lý bnh hc. Thí d:trong bnh lý Tin Sn git, giá tr bt thng ca Placental protein 13 là gia tng, trong khi bt thng ca placental growth factor (PIGF) li là gim. Cho mô hình phân loi, vn  khá n gin, im s tiên lng là xác sut \\(p_1\\) ca nhãn Positive ( ây: xác sut th thai lâm sàng thành công), ch có th dao ng trong khong 0-1, và ngng ct quyt nh thng là 0.5; nhãn Positive c gán cho phn bên phi ngng ct (\\(p_1 &gt; 0.5\\)). Tuy nhiên ngi bác s có th quan tâm hn n vic tiên lng kt cc tht bi, lúc này 2 nhãn positive và negative s hoán i v trí cho nhau, sensitivity và specificity s hoán i cho nhau. Nói cách khác, giá tr Specificity cho nhãn Positive tng ng vi giá tr Sensitivity cho nhãn Negative và ngc li. Vì c nh ngha và áp dng riêng bit cho nhóm Positive hoc Negative, 2 ch s Sensitivity và Specificity không b chi phi bi t l phân b ca 2 loi này trong qun th tng quát; nói cách khác, ây thc s là nhng ch s c trng cho quy lut phân loi ( nhy và c hiu ca mt mô hình chn oán/tiên lng s không thay i dù áp dng cho bt c qun th ích nào, nó không b nh hng bi t sut hin din ca kt cc trong qun th ó). Ngoài ra, ta còn quan tâm n  chính xác ca tiên lng: Acuracy, hay  chính xác tng quát là tiêu chí ph bin (thng c báo cáo) khi kim nh hiu nng ca quy lut phân loi, tuy nhiên ý ngha thc dng ca nó kém vì nó không c hiu cho mt mc tiêu nào c. Accuracy n gin là t l ca tt c trng hp phân loi úng (không phân bit negative/positive) trên toàn b mu kim nh. \\[Accuracy = \\frac{TP+TN}{TP+TN+FP+FN}\\] Accuracy có th b sai lch nu có bt xng v t l gia 2 nhãn Positive/Negative, do ó ta có mt ch s khác chính xác hn, là Balanced accuracy (BAC) hay  chính xác cân bng: \\[BAC = \\frac{TPR+TNR}{2}\\] Giá tr thc tin trên lâm sàng là mt tiêu chí khác cn quan tâm, vi hai ch s Positive predictive value (PPV) và Negative predictive value (NPV): Nu nh sensitivity và specificity mang ý ngha kho thí mt quy lut/mô hình bng cách a ra 1  bài/mu kim nh cha toàn nhãn positive hoc negative, thì 2 ch s PPV và NPV li mang ý ngha thc tin hn. PPV o lng kh nng phân loi Positive chính xác, vi câu hi: trong s nhng trng hp c phân loi là positive, bao nhiêu trng hp là chính xác (thc s là positive). \\[PPV = \\frac{TP}{TP+FP}\\] PPV o lng tính chun xác, Sensitivity o lng tính hu dng. Mo  nh là Dám quyt nh (Sensitivity cao) và quyt nh úng (PPV cao) Tng t: NPV o lng kh nng loi tr chính xác: trong s nhng i tng c dán nhãn negative, bao nhiêu trng hp thc s là negative ? \\[NPV = \\frac{TN}{TN+FN}\\] Nhc im ca PPV so vi Sensitivity (và NPV so vi Specificity), ó là PPV và NPV b nh hng bi t sut phân b ca 2 nhãn/kt cc trong qun th ích. PPV không kho sát mô hình tiên lng môt cách c lp, mà t mô hình này vào mt bi cnh (d liu). Do ó ta không nói chung chung: quy lut này chính xác, mà ch có th kt lun là: quy lut này chính xác i vi mu/d liu hin thi. F1 score hay còn gi là F-measure: Ch s F1 cho phép ánh giá s cân bng gia Sensitivity và PPV. c nh ngha nh trung bình iu hòa (harmonic mean) gia PPV và Sensitivity: \\[F1 = \\frac{2\\times TP}{2\\times TP+FP+FN}\\] \\[F1 = 2\\times \\frac{1}{\\frac{1}{Sens}+\\frac{1}{PPV}}\\] \\[F1 = 2\\times \\frac{PPV \\times Sens}{PPV + Sens}\\] F1 c dùng khi ta quan tâm ng u vai trò ca c PPV và Sensitivity, nói cách khác ta mun quy lut tiên lng va nhy, va chính xác. Vic la chn gia Sensitivity và PPV tùy thuc vào mc tiêu ng dng ca quy lut: ngi bác s mun Tm soát, phát hin tht nhiu, tht sm mt kt cc (thm chí chp nhn nguy c phát hin này có th sai), hay mun xác nh chc chn kt cc ó ? Nu xem c 2 u quan trng nh nhau thì F1 là tiêu chí thích hp nht khi kim nh vì  F1 t ti u thì c PPV và Sens u phi ti u, ngc li ch cn mt trong 2 có giá tr thp thì F1 s thp. Din tích di ng cong ROC: ROC-AUC cho phép ánh giá hiu nng phân loi/tiên lng tng quát cho toàn th thang im tiên lng mà mô hình to ra: ng cong ROC là hình nh to bi tt c cp giá tr TPR (t l phát hin úng) và FPR (t l phát hin nhm/sai) ca tt c nhng ngng ct có th trên toàn thang im xác sut d báo cho mt nhãn kt qu. Quy trình kim nh chéo lp li 10x10 trong h thng tidymodels c tin hành nh sau: Dùng hàm vfold_cv() vi tham s v=10 và repeats = 10  to ra b phn tái chn mu Kt ni workflow ã to ra  trên (bên trong bao gm recipe, mô hình, d liu gc) và hàm fit_resamples, trong ó khai báo b phn tái chn mu, và lit kê nhng ch s dùng  ánh giá hiu nng mô hình. Trong thí d này ta s c tính 5 ch s gm: sensitivity (sens), specificity (spec),  chính xác cân bng (bal_accuracy), F1 score (f_meas) và ROC AUC (roc_auc). Sau khi quy trình thc hin xong, ta lu li kt qu vào i tng cv_res và trích xut d liu kt qu bng hàm bind_rows() cho danh sách cv_res$.metrics. Sau ó dùng hàm group_by và summarize  mô t tóm tt kt qu này: Kt qu kim nh chéo cng có th trình bày trc quan bng biu  hp: Chú thích: Biu  hp mô t c tính phân phi ca giá tr 5 ch s hiu nng ca 100 phiên bn mô hình XGboost (trc x). Din gii kt qu kim nh chéo: Trc ht, nhng ch s ta va c tính u có thang o trong khong 0-1, mt giá tr càng gn 1 càng có ý ngha tích cc và ngc li.  t hiu qu chp nhn c v mt lâm sàng, ta kì vng v mt giá tr cao (khong 0.8 hoc hn, ti thiu cng không nên thp hn 0.7), và cân bng gia các tiêu chí. Kt qu hin thi không t c mc kì vng này. Ta có mt mô hình c hiu (specificity trung bình = 0.74) nhng  nhy thp (sensitivity trung bình ch có 0.44). Hiu nng tng quát ca mô hình ch  mc trung bình (ROC AUC = 0.62), và ch cho phép phân loi chính xác khong 59.3% (theo giá tr BAC), ngoài ra F1 score trung bình ch  mc 0.50 cho thy cha có s cân bng tt gia  chính xác và  nhy. Kt qu này khng nh cm nhn ban u ca chúng ta trong giai on thm dò trc quan, rng tác v phân loi hin thi là mt bài toán khó, ngay c khi áp dng mt thut toán Machine learning rt mnh là XGboost. Có th nói rng mc tiêu tiên lng là không kh quan vi thit k mô hình và ni dung thông tin u vào hin thi. Mt kt qu cha hoàn ho còn là du hiu cho thy hn ch v thit k mô hình và/hoc c mu. Qua nghiên cu thc t này, cng là c hi giúp các bn nhn ra rng không phi lúc nào mc tiêu ch quan cng kh thi, Machine learning và d liu ln không phi là công c vn nng luôn cho ra kt qu hoàn ho. Tuy mc tiêu tiên lng có th không kh quan, nhng iu này không ngn cn chúng ta thc hin tip mc tiêu din dch. Trong phn tip theo ta thy ngoài công dng d báo và phân loi, mô hình XGboost vn còn mt công dng khác na là làm phng tin trung gian  ánh giá v vai trò các thông s hình thái ca phôi i vi kh nng th thai thành công. Mun vy, ta cn to ra mô hình chính thc. 10.8 Hun luyn mô hình trên toàn th d liu tp Train ây là công on thc s to ra mô hình chính thc, bng cách thi hành workflow trên toàn b d liu ca tm hun luyn (train_data), vi hàm fit(). Sau khi quá trình hun luyn hoàn tt, ta dùng hàm extract_fit_engine  ly mô hình Din tin ca quá trình hun luyn c lu li trong object kt qu quy trình, ta có th chuyn thông tin này thành biu  nh sau: Chú thích: Biu  này có tên gi là training curve, nó trình bày din tin hun luyn mt mô hình Machine learning. Theo kt qu hin thi, mô hình chính thc ã tri qua 300 lt hun luyn, và giá tr hàm mt mát (loss function c gim dn t 0.7 xung còn 0.5.  ây thut toán xgboost dùng hàm binary logloss - o lng  li ca kt qu d báo so vi giá tr thc t (0,1)  thang o logarit. 10.9 Kim nh c lp hiu nng mô hình Sau khi có mô hình chính thc, ta s ánh giá hiu nng ca nó trên tp d liu kim nh (test subset). u tiên ta dùng hàm predict cho mô hình Xgboost, trên d liu mi (new_data) là test_data. Có th tùy chnh tham s type = prob  ly kt qu là xác sut cho mi nhãn positive, negative thay vì kt qu phân loi tuyt i 0 hoc 1. Áp dng hàm conf_mat cho cp giá tr d báo (estimate) và quan sát thc t (truth) ta s to ra c confusion matrix. Các hàm f_meas, bal_accuracy, sens, spec, npv, ppv cng áp dng cho cp giá tr thc/d báo và ln lt c tính các tr s hiu nng F1 score,  chính xác cân bng,  nhy,  c hiu, giá tr tiên oán positive và negative. Cui cùng hàm roc_auc áp dng cho 1 xác sut d báo và kt qu thc t s c tính din tích di ng cong ROC. ## Truth ## Prediction 0 1 ## 0 66 66 ## 1 72 137 Kt qu thu c xác nhn kt qu kim nh chéo  trên, cho thy ây là mt mô hình phân loi có hiu nng  mc trung bình. ng cong ROC có th c biu din bng hàm roc_curve và autoplot: Chú thích: ng cong ROC cho phép ánh giá hiu nng phân loi tng quát ca mô hình nh phân. Trc x trình bày 1-specificity hay t l phát hin nhm (false positive), trc y trình bày sensitivity hay t l phát hin chính xác (true positive rate) cho tt c nhng ngng ct có th cho xác sut d báo ca nhãn positive. Kt qu cho thy mô hình hin thi có hiu nng tt hn mt s oán nh ngu nhiên (AUC tham chiu = 0.5), tuy nhiên ch  mc trung bình (AUC = 0.631). 10.10 Phân tích hu kim bng k thut SHAP Trong phn tip theo, chúng ta s tìm hiu và thc hin phân tích hu kim (post-hoc analysis) bng k thut din gii mô hình Machine learnning SHAP. 10.10.1 Gii thiu v phng pháp din gii mô hình SHAP Khi thc hin din gii mô hình, câu hi t ra là mi bin s có vai trò ra sao và óng góp nhiu hay ít vào kt qu ca mô hình ? i vi mt mô hình tuyn tính nh hi quy logistic, câu tr li cho câu hi này rt n gin, vì hiu ng óng góp ca mi bin s trong mô hình là cng tính và c th hin tng minh trong chính h s hi quy. Trong thí d này, nu ta s dng mô hình logistic làm công c suy din thng kê thì s thu c kt qu nh sau: Trong trng hp ca mô hình XGBoost, c ch và cu to phc tp ca nó khin cho mô hình tr nên không th gii thích c và tr thành mt hp en (blackbox), ta ch nhn c kt qu  u ra nhng không có kh nng hiu c c ch nào sinh ra kt qu này và mc  mà nhng bin s ã tham gia bên trong mô hình. Tr ngi này c khc phc nh s kt hp vi mt thut toán din gii ph tr, mà  ây là k thut SHAP. K thut din gii ni dung mô hình cng tính bng im s Shapley (SHAP) c xem là phng pháp hiu qu nht hin nay cho nhu cu gii thích c ch vn hành ca mô hình machine learning, trong phn di ây chúng ta s hiu ti sao.  hiu rõ v bn cht và c ch ca phng pháp này, trc ht chúng ta cn mt chút tng tng. Ý tng v im Shapley (1953) phát sinh t hc thuyt trò chi (game theory), theo ó vic tiên lng c xem nh mt trò chi có tính hip ng mà mc tiêu là c lng kt qu chính xác nht có th. Mt mô hình tiên lng c xem nh mt i nhóm và mi bin s trong mô hình c xem nh mt ngi chi (thành viên trong i) tham gia vào trò chi này. Mi ngi chi s nhn c im thng tùy theo mc  óng góp ca h vào thành qu (tiên lng chính xác). Trong tình hung hin thi, mc tiêu ca mô hình machine learning nhm d oán kh nng th thai thành công (mt giá tr xác sut t 0 n 1, giá tr &gt; 0.5 c phân loi là thành công (positive), ngc li giá tr &lt; 0.5 s cho kt qu phân loi negative (tht bi)). Trên thc t, kt cc lâm sàng c quan sát là tuyt i (thành công = 1 hay tht bi = 0). Mô hình có 16 bin s (features, predictors)  u vào. Nh vy trò chi ca chúng ta có mc tiêu là to ra kt qu d báo (predicted score) chính xác : gn vi 0 nht có th cho trng hp tht bi, hoc gn 1 nht có th i vi trng hp thành công. Mt cách t nhiên, mi bin s có vai trò và kh nng óng góp khác nhau vào kt qu tiên lng này, mt vài bin có khuynh hng làm gim im tiên lng (nói cách khác, chúng tng quan thun vi nguy c tht bi và tng quan nghch vi kh nng thành công), trong khi mt vài bin khác có khuynh hng gia tng xác sut th thai thành công (thí d AFC, t l to phôi, phm cht phôi tt ). Cho mi bnh nhân, mc  óng góp ca mi giá tr bin s có th cao hoc thp, tùy vào vai trò ca chúng, và tính tng i so vi giá tr nhng bin khác. Phng pháp din gii bng im s Shapley c tin hành theo c ch nh sau : mt hip ca trò chi c din ra cho mi cá th trong d liu (bnh nhân), mc tiêu ca trò chi là tiên lng xác sut th thai thành công cho cá th ó mt cách chính xác nht có th. Trò chi din ra trong mt không gian d liu (cn phòng, sân chi), mi giá tr bin s u vào s ln lt c a vào sân chi theo th t ngu nhiên, và gia nhp vào i nhóm các giá tr bin s khác ang hin din, chúng hp tác vi nhau  to ra kt qu tiên lng. Mi lt nh vy, im tiên lng tng kt mà i nhóm (tp giá tr bin s) to ra s c so sánh vi kt qu trc khi giá tr bin s (ngi chi) mi gia nhp, khác bit này s c tính nh im thng cho ngi chi (bin s) ó, giá tr im thng có th &lt;0 (giá tr bin s làm gim kt qu tiên lng), &lt;0 (làm tng) hoc =0 (không có vai trò óng góp nào c). Sau cùng, im s Shapley cho mt bin s X là giá tr trung bình im thng mà bin s này nhn c t t hp tt c nhng i nhóm mà nó ã tham gia. Cho mt tp bin \\(S\\) gm \\(p\\) thành viên (bin s u vào), im Shapley cho mt giá tr ca bin \\(x_j\\) ti n v quan sát (cá th) \\(j\\) là trung bình cng có trng s ca im thng mà giá tr \\(x_j\\) này nhn c trong tt c nhng i nhóm có th mà nó ã tham gia, c xác nh bi hàm val: \\[\\phi_j(val)=\\sum_{S\\subseteq\\{1,\\ldots,p\\} \\backslash \\{j\\}}\\frac{|S|!\\left(p-|S|-1\\right)!}{p!}\\left(val\\left(S\\cup\\{j\\}\\right)-val(S)\\right)\\] Vi \\(val_x(S)\\) là kt qu tiên lng (prediction score) cho giá tr bin s \\(x\\) trong tp hp \\(S\\), c iu kin hóa cho vic loi tr nhng bin còn li cha tham gia vào tp \\(S\\) \\[val_{x}(S)=\\int\\hat{f}(x_{1},\\ldots,x_{p})d\\mathbb{P}_{x\\notin{}S}-E_X(\\hat{f}(X))\\] Thí d cho mt mô hình machine learning gm 3 bin s: \\(x_1, x_2, x_3\\), và ta ang xét trng hp ch có 2 bin \\(x_1\\) và \\(x_3\\) hp tác vi nhau, giá tr im Shapley c tính nh sau : \\[val_{x}(S)=val_{x}(\\{1,3\\})=\\int_{\\mathbb{R}}\\int_{\\mathbb{R}}\\hat{f}(X_{1},x_{2},x_{3})d\\mathbb{P}_{X_2}-E_X(\\hat{f}(X))\\] Da trên lý thuyt v Shapley score, nm 2017 Lundberg và Lee ã xây dng tp hp các công c din gii mô hình di tên gi tng quát là SHAP (SHapley Additive exPlanations). K thut SHAP có cùng nguyên lý nh ca Shapley và kt qu ca nó, SHAP score chính là mt phiên bn ca Shapley score, vi cùng ý ngha. S khác bit gia 2 phng pháp ó là trong quy trình SHAP, im Shapley c c lng thông qua mt mô hình tuyn tính: \\[g(z&#39;)=\\phi_0+\\sum_{j=1}^M\\phi_jz_j&#39;\\] vi \\(g\\) là mô hình tuyn tính có ý ngha i din, \\(z&#39;\\in\\{0,1\\}^M\\) là vector i nhóm to ra t tp hp bin s, M là kích thc ln nht ca tp hp này, và \\(\\phi_j\\in\\mathbb{R}\\) là phn óng góp ca bin s j hay cng chính là giá tr Shapley score. Trong vector \\(z\\), nhng bin s có mt/tham d vào i nhóm s nhn giá tr =1, ngc li giá tr s =0 cho các bin không tham gia/vng mt. Cho mt cá th x hin hành, công thc c gin lc thành: \\[g(x&#39;)=\\phi_0+\\sum_{j=1}^M\\phi_j\\] Trong bài toán hin thi, ta s áp dng TreeSHAP, là mt bin th ca SHAP dành cho các mô hình machine learning da trên cây quyt nh nh Decision tree, Random Forest hoc XGboost. 10.11 Vai trò ca các thông s óng góp vào kt qu tiên lng Mt ng dng quan trng ca Shapley score là cho phép xp hng th t quan trng v vai trò óng góp gia các bin. Mc  quan trng (feature importance) ca mi bin s c c tính n gin nh trung bình cng ca giá tr tuyt i ca tt c SHAP sores cho mi cá th. \\[I_j=\\frac{1}{n}\\sum_{i=1}^n{}|\\phi_j^{(i)}|\\] Quy trình thc hin din gii mô hình bng phng pháp SHAP nh sau: u tiên ta dùng hàm bake trong th vin recipes cho train_data và test_data  to ra 2 ma trn d liu X_train (kích thc 795x16) và X_test (341x16). ây chính là cu trúc d liu mà c mô hình XGboost và SHAP nhn  u vào. Mi hàng trong ma trn là 1 cá th bnh nhân, và mi ct là mt bin s. Hàm prep() ca th vin shap s c tính giá tr ca SHAP scores cho d liu u vào, thí d X_train và lu li di nh dng d liu tidy (bng dc) tng thích vi các hàm  ha bng ggplot2  trình bày trc quan kt qu din gii. ## ID variable value rfvalue stdfvalue mean_value ## 1: 1 Blasturation -0.1060184 0.5000000 0.4705882 0.2384846 ## 2: 2 Blasturation 0.6007323 1.0000000 1.0000000 0.2384846 ## 3: 3 Blasturation -0.5748687 0.4210526 0.3869969 0.2384846 ## 4: 4 Blasturation -0.5128484 0.9000000 0.8941176 0.2384846 ## 5: 5 Blasturation -0.3281469 0.5000000 0.4705882 0.2384846 ## 6: 6 Blasturation -0.3070892 0.5000000 0.4705882 0.2384846 Lu ý rng im s Shapley c tính  mc  cá th (mi giá tr quan sát \\(x_j\\) ca mt bin s \\(x\\) cho mt bnh nhân \\(j\\)). Khi áp dng quy trình din gii SHAP, kt qu thu c s là mt bng vi kích thc bng vi d liu u vào. Kt qu này có th c kho sát trc quan  mc  qun th, phân nhóm, thm chí cá th. Giá tr im Shapley có th &lt;0, &gt;0 hoc = 0. Trong bng này, ta quan tâm n ct variable ch tên bin s trong mô hình, và value là giá tr SHAP score cho mi giá tr cá th ca bin s. Kt qu này c trình bày hiu qu nht bng hình thc trc quan. Hàm plot.summary s to ra biu  tóm tt kt qu din gii. ây là biu  quan trng c báo cáo nh kt qu chính trong các bài báo khoa hc. Ni dung ca biu  này nh sau: Trc x trình bày thang o ca giá tr SHAP score, o lng vai trò óng góp ca mi giá tr cá th ca mt bin s vào kt qu tiên lng ca mô hình cho cá th ó. Trc y trình bày danh sách các bin, c xp th t theo mc  quan trng ca chúng (variable importance) - tính bng trung bình ca giá tr tuyt i ca tt c SHAP score cá th cho bin s c xét. Tp hp các chm tròn trình bày c tính phân b ca SHAP score cho tng bin. Mi chm tròn tng ng vi 1 cá th bnh nhân. Màu sc ca chm tròn tùy theo giá tr chun hóa ca bin s ang c xét, màu  tng ng vi giá tr cao hn, màu xanh lam tng ng vi giá tr thp hn. Nu ó là bin nh phân, màu  tng ng vi giá tr Có (=1), màu xanh là giá tr Không (=0). ng thng ng vuông góc vi mc giá tr SHAP score = 0 trên trc x cho phép phân nh 2 hng tác ng ca mt bin vào kt qu d báo ca mô hình. Nhng chm SHAP score có giá tr âm và nm trong phn bên trái cho bit  nhng cá th ó, bin s c xét có khuynh hng làm gim xác sut d báo (ng h cho kt qu negative - th thai tht bi). Ngc li, các im SHAP score nm bên phi thang o tng ng vi các trng hp mà giá tr bin s ang c xét có vai trò ng h cho kt qu tiên lng positive (th thai lâm sàng thành công). Khi kt hp màu sc và v trí ca các chm tròn, ta có th hình dung v vai trò ca mi bin, thí d bin Age nm  v trí th 3, nó có vai trò quan trng hn bin tui phôi (Day_BVitrif) nhng kém quan trng hn bin AFC; Bin Age cng có s phân nh khá rõ nét: các cá th tui cao (chm màu ) cng tng ng vi SHAP score &gt; 0 (v phía bên phi) và ngc li, gi ý rng Tui là yu t có tng quan nghch chiu vi kh nng th thai thành công. Mc  giãn cách ca các chm tròn cng cho phép hình dung v hiu ng mà bin s ó gây ra cho kt qu tiên lng, khong cách càng rng, thì vai trò óng góp càng cao, s m rng v c 2 phía cho thy bin s có vai trò ng u c ng h và loi tr phân loi positive (nh bin AFC, Age), s m rng nghiêng v mt phía cho bit bin ó có vai trò chuyên bit  loi tr hoc phát hin nhãn positive (thí d bin dTE thiên v phát hin, bin dSize thiên v loi tr) ngc li hình nh co cm v v trí trung tâm cho thy mc  óng góp rt nh hoc gn nh = 0 (bin Blast_TE_c và Blast_ICM_c). S pha trn màu sc (không tng phn rõ nét) gia các chm tròn cng là du hiu cho thy vai trò không rõ ràng, hoc không quan trng ca bin c xét). Tóm li, nhng bin có vai trò óng góp quan trng có nhng c tính nh sau: nm  v trí cao hn trên trc y, khong giãn cách các im SHAP score rng, v 1 hoc c 2 phía, màu sc các im phân cc rõ ràng. Khi quan sát tng th biu  này, ta có th rút ra mt s nhn nh nh sau: 3 yu t quan trng nht nh hng n kh nng th thai lâm sàng là t l to phôi (ng nhiên), Tui và AFC. Tui có tng quan nghch và AFC tng quan thun, tuy nhiên liên h gia t l to phôi không có quy lut rõ ràng. Tip theo, Tui phôi (Day_BVitrif), loi B hình thái TE và kích thc phôi (Size) là 3 thông s v hình thái quan trng nht quyt nh kh nng th thai. Các thông s v s thay i ca hình thái v kích thc ch có vai trò ít quan trng và ch yu là cng c thêm xác xut th thai thành công. Nhng yu t gm k thut Trigger, loi C ca hình thái TE và ICM không có vai trò nào c i vi kt cc th thai thành công hay tht bi. Ngoài biu  này, ta còn có th trình bày kt qu bng nhiu hình thc khác, thí d biu  boxplot hoc barplot. Biu  boxplot ch tóm lc thông tin  cp  qun th nhng không cho phép din gii sâu n tng cá th, nó cng không cho phép din gii v quy lut tng quan thun hay nghch. Biu  barplot ch trình bày c th t quan trng ca các bin: ta dùng biu  này khi ch cn a ra thông ip n gin, xác nh nhng bin nào quan trng nht Kho sát hiu ng c lp ca mi thông s i vi kt qu tiên lng xác sut th thai lâm sàng: Mt hình thc din gii trc quan khác, ó là biu  tng quan gia giá tr bin s c xét và giá tr SHAP score tng ng. Biu  này cho phép din gii chính xác hn v quy lut liên h gia s thay i ca mt bin s và hiu ng i vi kt qu tiên lng ca mô hình. u tiên, ta dùng hàm shap.values cho mô hình và ma trn d liu u vào  to ra cu trúc d liu shap_values cho phân tích này. Sau ó, dùng hàm shap.plot.dependence() cho shap_values  v biu  Sau ây là thí d minh ha khi phân tích 4 bin trong mô hình. Nhng thí d này bao quát cho 3 loi bin: liên tc (t l to phôi,BMI), ri rc (Kích thc phôi) và nh phân (Trigger = HCG) và các quy lut óng góp khác nhau. ## [[1]] ## ## [[2]] ## ## [[3]] ## ## [[4]] Trong mi biu , trc x trình bày thang o ca bin s ang kho sát, trc y trình bày thang o ca SHAP score tng ng. Biu  có dng tán x và có th kt hp vi  th ca hàm s ca mô hình hi quy (nu là bin liên tc). Mi chm trên biu  biu th cho mt cá th bnh nhân (ta ã bit rng ng vi mi giá tr cá th ca mt bin thì s tính c 1 SHAP score). Hình nh phân b ca các im giá tr và  th hàm hi quy s mô t quy lut liên h gia s thay i giá tr ca bin ó và giá tr SHAP score tng ng. u im ca hình thc din gii này, ó là nó cho phép mô t c trung thành và tinh t tt c nhng quy lut liên h phi tuyn tính, phc tp gia bin c lp và óng góp vào kt qu tiên lng, mà các biu  marginal effect cho mô hình tuyn tính/logistic thông thng không làm c. Biu  dependence plot còn cho phép kho sát hiu ng tng tác gia 2 bin, thí d Tui và AFC. Nh trong biu  sau, trc X vn din t thang o ca AFC, nhng trc Y trình bày SHAP score khi Age tng tác vi AFC: Tuy nhiên, cn tránh ng nhn khi din gii kt qu này.  ây, giá tr SHAP score là im s ri rc cho cá th, và ch là s o lng gián tip tác ng lên kt qu tiên lng. SHAP score không th t ra mt quy lut hoc mô hình gin lc, vì vy nó không cho phép suy lun theo hng can thip nhân qu nh mô hình tuyn tính, thí d ta không th suy din rng nu AFC tng thêm k n v s làm tng kh nng th thai thành công thêm y% Ta có th khc phc hn ch này bng cách to ra mt cá th gi nh và thay th giá tr \\(x=j\\) bng mt giá tr \\(x = k\\) khác, ri so sánh kt qu tiên lng gia 2 cá th (d liu phn thc t). Ngoài ra, cn tránh s ng nhn khi din gii im Shapley theo cách ta hay làm cho h s hi quy ca mô hình hi quy tuyn tính. im s Shapley không nên c din gii cho toàn b qun th theo kiu: nu loi b bin \\(X\\) khi mô hình thì giá tr tiên lng s thay i trung bình \\(y\\) n v. Thc ra, ý ngha úng ca im Shapley là cho mt trng hp cá th \\(j\\), vi tp hp các giá tr bin s u vào hin thi, Shapley score biu th cho mc  óng góp ca giá tr bin s \\(x_j\\) làm thay i (tng hoc gim) kt qu tiên lng \\(y_j\\) cho cá th j này, so vi kt qu tiên lng trung bình. 10.11.1 SHAP score có th dùng  phân cm d liu Ta có th xem SHAP score nh mt thuc tính (vi thang o chun hóa v cùng n v) ca d liu, i din cho kh nng óng góp ca mi bin vào mt mc tiêu tiên lng nào ó. Nh vy, ta có th phân cm d liu da vào SHAP score. Vic phân cm này cho phép din gii bài toán tiên lng trong mt không gian 2 chiu: trong mu d liu hin hành có nhng mô thc phân b nào v vai trò ca các bin ? Sau ây là kt qu khi phân d liu train_set thành 4 cm, ta nhn thy mi cm có mô thc phân b khác nhau ca SHAP score. Chú thích: 4 biu  trên trình bày mô thc phân b ca SHAP score trong 4 cm. Trc x tng ng cho cá th bnh nhân, trc y là giá tr SHAP score, các bin khác nhau c tô màu riêng, và  ây ch kho sát 7 bin quan trng nht. 10.12 Bàn lun: 10.12.1 u im và nhc im ca mô hình XGboost Mô hình XGboost có nhiu u im áng quan tâm bao gm tính linh hot cao vi các dng d liu khác nhau, kh nng x lý các tp d liu ln,  chính xác cao và tc  tính toán nhanh. u tiên, nó có tính linh ng và ph quát rt cao. Mô hình XGboost có kh nng tip nhn d liu u vào có cu trúc phc tp, kích thc ln: không hn ch s lng bin (thm chí cho các bài toán trên d liu genomics vi hàng trm, hàng ngàn bin s), x lý c d liu hn hp (gm c bin nh lng, nh tính nh phân hay ri rc). Vì da trên mô hình cây, thut toán XGboost cng dung hp d dàng vi mi vn  v d liu - mà mô hình tuyn tính bình thng không có kh nng x lý - nh nhng giá tr cc  (outliers, extreme values), hin tng các bin tng quan ln nhau (co-linearity). Ta cng không cn phi chun hóa thang o và n v o nhng có th gi nguyên nh dng ban u ca d liu. Ngoài ra, XGBoost cng có kh nng x lý các tình hung vi nhiu thuc tính và giá tr b thiu (missing values) mt cách hiu qu. u im th hai là  chính xác và tính n nh. XGboost có hiu nng rt mnh m và iu này ã c chng thc qua nhng cuc thi u mà mc tiêu là tìm ra mô hình tiên lng chính xác nht trong nhiu bài toán bao gm y hc lâm sàng. XGboost luôn chin thng và là mô hình mnh vô ch cho dng d liu có cu trúc (bng tính). Cui cùng, thut toán XGboost c ti u v hiu sut tính toán, nên có tc  hun luyn và thi hành rt nhanh. iu này khá quan trng khi bn làm vic vi d liu ln. Tuy nhiên, XGBoost cng có mt s hn ch, bao gm cu trúc phc tp và òi hi nhiu kinh nghim trong vic tinh chnh các tham s. Mô hình cng có nguy c cao b overfitting (quá khp vi d liu hin thi dn n hot ng kém hiu qu trên d liu mi) nu không c tinh chnh úng cách. 10.12.2 u im và nhc im ca k thut SHAP Phng pháp din gii mô hình dùng Shapley score có nhiu u im. Nó gn nh tha mãn tt c nhng tiêu chí v kh nng din gii mô hình: Tiêu chí v tính hiu qu: im s Shapley cho phép o lng chính xác mc  óng góp ca mi bin X, mc óng góp này tng ng vi sai bit gia 2 kt qu tiên lng khi có X tham gia so vi giá tr tiên lng c bn (trung bình) ca mô hình khi không có X tham gia. Tính i xng : 2 giá tr \\(x=j\\) và \\(x=k\\) s nhn im Shapley nh nhau nu chúng óng góp bng nhau qua tt c nhng t hp i nhóm có th Tính vô hiu: Mt giá tr bin \\(x=j\\) không có óng góp nào c vào kt qu tiên lng s nhn giá tr Shapley = 0 Tiêu chí cng tính: cho trng hp mô hình là tp hp ca nhiu n v mô hình nh hn (thí d mô hình XGBoost nh hin thi), ta có mt trò chi mà im thng c tng kt t nhiu trò chi nh hn (mi n vi mô hình cây quyt nh), khi ó im Shapley tng kt cho mô hình ln là trung bình t tng s im t các n v mô hình nh hn. So vi nhng phng pháp din gii mô hình khác ch din gii cc b ti mt vùng trong không gian d liu, k thut SHAP u th hn khi m bo s phân b ng nht ca sai bit gia mt giá tr tiên lng bt kì và giá tr tiên lng trung bình, nói cách khác, cho phép chúng ta din gii mt cách áng tin cy và ph quát cho mi trng hp khi áp dng mô hình trên thc t. Tính cht này có th quan trng v mt pháp lý hoc y c, khi mô hình tiên lng trong y hc c yêu cu phi có kh nng din gii c và kt qu din gii phi áng tin cy. Phng pháp SHAP còn có kh nng din gii linh ng, khi không ch so sánh 1 giá tr tiên lng cá th vi giá tr tiên lng trung bình cho toàn b tp d liu, mà còn cho phép so sánh vi kt qu mt phân nhóm nh hn, thm chí vi mt cá th khác. Giá tr ca SHAP score cng nht quán gia các phiên bn mô hình khác nhau, thí d nu s thay i ni dung ca mô hình B t mô hình A dn n thay i v vai trò ca bin X trong mô hình B (tng hoc gim), thì SHAP score cho bin X cng s tng hoc gim tng ng.  c lng im Shapley cho mt bin s, ta phi có d liu gm toàn b bin s còn li. Tuy nhiên phng pháp SHAP c ci tin cho phép din gii c mô hình khi thiu sót d liu, cho mt cá th bt kì, nhng bin s b thiu d liu n gin s c xem là không tham gia vào trò chi tiên lng và nhn giá tr = 0 trong vector i nhóm. Khi trình bày kt qu, SHAP cho phép la chn báo cáo mt s ít nhng bin quan trng nht và có th gp các bin còn li thành mt nhóm riêng. 10.12.3 Din gii c ch hot ng ca mô hình  cp  cá th: Vì SHAP score c tính n cp  cá th, nó m ra mt c hi cha tng có trong thng kê c in, ó là kh nng din gii c vai trò óng góp ca mi thông s sinh lý bnh vào kt cc lâm sàng cho riêng tng cá th. Bng cách này ta ang tin rt gn n ng dng Y hc cá th. Thc vy, trong thng kê c in, din gii mt mô hình thc cht ch có ý ngha tng quát ( cp  qun th) nhng không th áp dng c cho tng cá th riêng bit. Thí d, da vào mô hình logistic, ta thng din gii vai trò ca mt yu t nguy c theo kiu : S hin din ca yu t X này làm tng nguy c mc bnh Y gp 2-3 ln so vi nhng ngi không có X, hoc : mi n v gia tng ca biomarker X s làm tng nguy c hin din bnh lý Y t 2 n 3 ln.S din gii mang tính cht chung chung này tuy cng hu ích (nó cho phép xác nh c yu t nguy c, nh lng c nguy c) t ó a ra quy tc v phòng nga, tr liu, chn oán ), tuy nhiên cách làm này có nhng gii hn vì mi bin s c din gii c lp vi nhng bin s còn li, vi gi nh là giá tr ca chúng gi nguyên. Gi nh này phi lý, vì nu các bin thc s là nhng bin c lp, và ngu nhiên, mi cá th có th là mt t hp ngu nhiên t bt c giá tr nào cho tng bin, cng nh rt khó c lng hiu qu can thip tr liu lên tng yu t riêng l. Trong thí d minh ha sau ây, ta có th trình bày giá tr SHAP score  gii thích ti sao mô hình cho ra kt qu tiên lng positive cho mt trng hp có kt qu tiên lng th thai thành công: Biu  này tái hin li tin trình trò chi din ra vi s gia nhp và hip ng ln lt gia các ngi chi (bin s) và im s chúng ghi c. Cho trng hp này, ban u khi không có thông tin nào c, SHAP score c bn = -0.133, sau khi có thông tin ca 7 bin s u tiên SHAP score tng thêm 0.116, kích thc blastocyte = 3 làm tng SHAP score thêm 0.23, tui phôi ngày 5 ghi im 0.249, cui cùng AFC = 7 ghi thêm 0.324 im. im tng cng ca toàn i là 1.13 Tng t, ta gii thích c s óng góp ca tng thông s cho mt trng hp có kt qu tiên lng th thai tht bi: Kh nng din gii mt mô hình tiên lng cho tng cá th, c bit là trên cá th hoàn toàn mi (cha tng có trong d liu gc dùng  dng mô hình) cho phép gii quyt nhiu câu hi thú v v thc hành lâm sàng, thí d : Quy lut chn oán trong y vn liu có chính xác/phù hp cho bnh nhân mi này không ? Nu có, tôi mun bit vai trò/nh hng ca tng yu t nguy c/bnh cnh ca cá th này ã làm nh hng chn oán/tiên lng kt cc ? Bnh nhân mun bit da vào chng c nào mô hình ã tiên lng ra kt cc nh vy ? Ngi bác s cn a ra bng chng nh lng  bin lun v quyt nh chn oán/tr liu vi trng khoa và ng nghip Ngi bác s mun bit nên u tiên can thip vn  nào cho bnh nhân này  o ngc nguy c tht bi ?, da theo mô hình ã c s dng ? Nu mô hình phm sai lm cho bnh nhân này, ta mun bit lý do vì sao ? B phn (bin s) nào trong mô hình ã gây ra sai lm này ? Hiu ng ca mi bin có phù hp vi quy lut sinh lý/sinh lý bnh hay không ? Khi gp mt trng hp c bit khó chn oán/tiên lng, và mô hình trong y vn u cho ra kt qu  ranh gii nghi ng. Tng t, khi gp mt trng hp kì l mà mô hình cho ra kt qu tiên lng positive trong khi bnh cnh lâm sàng không in hình, ngi bác s mun kim tra vì sao và báo cáo iu này thành case report. (Cn lu ý rng cho n nay, mc nh là case study và case report không có phân tích thng kê nào c làm c). 10.13 Kt lun Thông qua thí nghim trong chng này, tuy không thành công cho mc tiêu lp ra mt quy lut tiên lng, nhng ta có c hi khám phá phng pháp Machine learning kh din, là cách tip cn mi và lý thú cho bài toán din gii v mi liên h gia các thông s và kt cc lâm sàng. Ta nhn ra rng phng pháp machine learning kh din cho phép s dng bt c loi mô hình nào làm công c suy din thng kê, thay th hiu qu cho các công c thng kê truyn thng. 10.14 Thông ip rút gn làm hành trang Machine learning kh din là mt gii pháp hiu qu cho c hai mc tiêu nghiên cu tiên lng và din dch, có th thay th cho cách tip cn truyn thng bng mô hình hi quy tuyn tính. K thut SHAP có nhiu u im v kh nng din gii, nht là vic din gii  cp  cá th là bc tin quan trng hng n ng dng y hc cá th và y hc chính xác. "],["404.html", "Page not found", " Page not found The page you requested cannot be found (perhaps it was moved or renamed). You may want to try searching to find the page's new location, or use the table of contents to find the page you are looking for. "]]
